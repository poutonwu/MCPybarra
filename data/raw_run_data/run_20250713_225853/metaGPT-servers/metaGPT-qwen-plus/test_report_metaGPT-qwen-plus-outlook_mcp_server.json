{
  "server_name": "outlook_mcp_server",
  "parent_dir": "metaGPT-qwen-plus",
  "report_name": "metaGPT-qwen-plus-outlook_mcp_server",
  "server_path": "workspace\\metaGPT-servers\\metaGPT-qwen-plus\\outlook_mcp_server.py",
  "timestamp": "2025-07-13T23:00:13.743648",
  "tools": [
    {
      "name": "list_folders",
      "description": "\n    列出所有可用的Outlook邮件文件夹。\n\n    Returns:\n        包含文件夹名称和路径的字典列表。\n    ",
      "args_schema": {
        "properties": {},
        "title": "list_foldersArguments",
        "type": "object"
      }
    },
    {
      "name": "list_recent_emails",
      "description": "\n    获取指定天数内最近的邮件标题列表。\n\n    Args:\n        days: 需要检索的过去天数，默认为7天。\n        folder_name: 指定的邮件文件夹名称，如果为空则使用默认收件箱。\n\n    Returns:\n        包含邮件主题、发件人和接收时间的字典列表。\n    ",
      "args_schema": {
        "properties": {
          "days": {
            "default": 7,
            "title": "Days",
            "type": "integer"
          },
          "folder_name": {
            "default": null,
            "title": "Folder Name",
            "type": "string"
          }
        },
        "title": "list_recent_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_emails",
      "description": "\n    在指定时间段和文件夹内按联系人或关键词搜索邮件。\n\n    Args:\n        query: 搜索查询字符串，可以是联系人或关键词。\n        folder_name: 指定的邮件文件夹名称，如果为空则使用默认收件箱。\n        start_date: 搜索的起始日期（格式：YYYY-MM-DD HH:MM）。\n        end_date: 搜索的结束日期（格式：YYYY-MM-DD HH:MM）。\n\n    Returns:\n        包含匹配邮件主题、发件人和接收时间的字典列表。\n    ",
      "args_schema": {
        "properties": {
          "query": {
            "title": "Query",
            "type": "string"
          },
          "folder_name": {
            "default": null,
            "title": "Folder Name",
            "type": "string"
          },
          "start_date": {
            "default": null,
            "title": "Start Date",
            "type": "string"
          },
          "end_date": {
            "default": null,
            "title": "End Date",
            "type": "string"
          }
        },
        "required": [
          "query"
        ],
        "title": "search_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_email_by_number",
      "description": "\n    获取指定编号的邮件详细信息。\n\n    Args:\n        email_id: 邮件的唯一标识符。\n\n    Returns:\n        包含邮件正文和附件信息的字典。\n    ",
      "args_schema": {
        "properties": {
          "email_id": {
            "title": "Email Id",
            "type": "integer"
          }
        },
        "required": [
          "email_id"
        ],
        "title": "get_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "reply_to_email_by_number",
      "description": "\n    对指定编号的邮件进行回复。\n\n    Args:\n        email_id: 邮件的唯一标识符。\n        reply_text: 回复邮件的内容。\n\n    Returns:\n        包含回复结果的状态消息。\n    ",
      "args_schema": {
        "properties": {
          "email_id": {
            "title": "Email Id",
            "type": "integer"
          },
          "reply_text": {
            "title": "Reply Text",
            "type": "string"
          }
        },
        "required": [
          "email_id",
          "reply_text"
        ],
        "title": "reply_to_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "compose_email",
      "description": "\n    新建并发送一封新邮件。\n\n    Args:\n        subject: 邮件的主题。\n        body: 邮件正文内容。\n        to: 收件人邮箱地址。\n        cc: 抄送邮箱地址（可选）。\n\n    Returns:\n        包含发送结果的状态消息。\n    ",
      "args_schema": {
        "properties": {
          "subject": {
            "title": "Subject",
            "type": "string"
          },
          "body": {
            "title": "Body",
            "type": "string"
          },
          "to": {
            "title": "To",
            "type": "string"
          },
          "cc": {
            "default": null,
            "title": "Cc",
            "type": "string"
          }
        },
        "required": [
          "subject",
          "body",
          "to"
        ],
        "title": "compose_emailArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "list_folders": [
      {
        "case_name": "基本功能测试 - 列出所有可用Outlook文件夹",
        "purpose": "验证list_folders工具在无参数情况下能正确列出所有可用的Outlook邮件文件夹。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.014403343200683594,
        "is_functional_test": true
      },
      {
        "case_name": "安全性测试 - 非授权访问尝试",
        "purpose": "验证list_folders是否在非授权或无效会话上下文下安全拒绝请求。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.017000436782836914,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - Outlook未连接",
        "purpose": "验证当Outlook未连接或账户未配置时，list_folders能否优雅地处理并返回错误信息。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.012002944946289062,
        "is_functional_test": false
      },
      {
        "case_name": "边界条件测试 - 空文件夹列表",
        "purpose": "验证当Outlook中没有可用文件夹时，list_folders是否返回空列表或合理响应。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.012999534606933594,
        "is_functional_test": false
      },
      {
        "case_name": "功能性异常字符测试 - 文件夹名含特殊字符",
        "purpose": "验证list_folders是否能正确处理包含特殊字符（如@、#、$）的文件夹名称。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.013053178787231445,
        "is_functional_test": true
      },
      {
        "case_name": "性能边界测试 - 大量文件夹存在时的响应",
        "purpose": "验证list_folders在大量文件夹存在时仍能保持稳定和响应性。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.013998746871948242,
        "is_functional_test": true
      },
      {
        "case_name": "功能性嵌套文件夹测试",
        "purpose": "验证list_folders是否能正确列出嵌套层级结构的Outlook文件夹路径。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.013999700546264648,
        "is_functional_test": true
      },
      {
        "case_name": "参数验证失败测试 - 提供非法参数",
        "purpose": "验证list_folders是否能正确拒绝非法参数输入并返回清晰的错误信息。",
        "args": {
          "invalid_param": "test"
        },
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.013999700546264648,
        "is_functional_test": false
      }
    ],
    "list_recent_emails": [
      {
        "case_name": "基本功能测试 - 获取默认7天内收件箱邮件",
        "purpose": "验证list_recent_emails工具在不指定参数时，默认获取最近7天内收件箱中的邮件列表。",
        "args": {},
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.011998653411865234,
        "is_functional_test": true
      },
      {
        "case_name": "基本功能测试 - 指定天数获取收件箱邮件",
        "purpose": "验证list_recent_emails工具能根据指定天数正确获取收件箱中对应时间范围的邮件列表。",
        "args": {
          "days": 3
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.013010263442993164,
        "is_functional_test": true
      },
      {
        "case_name": "基本功能测试 - 获取指定文件夹下的邮件",
        "purpose": "验证list_recent_emails工具能正确读取非默认文件夹（如已存在）中的邮件标题、发件人和接收时间。",
        "args": {
          "folder_name": "outformcptest@outlook.com"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.017507553100585938,
        "is_functional_test": true
      },
      {
        "case_name": "安全性测试 - 非授权访问尝试",
        "purpose": "验证list_recent_emails工具在无效或未认证会话下是否拒绝访问并返回安全错误信息。",
        "args": {
          "days": 5,
          "folder_name": "zhihutangjiang@126.com"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.014998674392700195,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 参数验证失败",
        "purpose": "验证list_recent_emails工具是否对非法参数（如负数天数）进行正确校验并返回清晰错误信息。",
        "args": {
          "days": -1
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.011999130249023438,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 文件夹不存在",
        "purpose": "验证当指定的folder_name不存在时，list_recent_emails是否能优雅地处理异常并返回合理错误。",
        "args": {
          "folder_name": "nonexistent_folder"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.016999483108520508,
        "is_functional_test": false
      },
      {
        "case_name": "边界条件测试 - 天数为0",
        "purpose": "验证list_recent_emails工具是否能正确处理days=0的情况（即当天邮件）。",
        "args": {
          "days": 0
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.01300048828125,
        "is_functional_test": true
      },
      {
        "case_name": "边界条件测试 - 文件夹名含特殊字符",
        "purpose": "验证list_recent_emails是否能正确处理包含特殊字符的文件夹名称。",
        "args": {
          "folder_name": "test@#$.folder"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.016999483108520508,
        "is_functional_test": true
      }
    ],
    "search_emails": [
      {
        "case_name": "基本功能测试 - 按关键词搜索默认收件箱邮件",
        "purpose": "验证search_emails工具在仅提供查询关键词的情况下，能正确搜索默认收件箱中匹配的邮件。",
        "args": {
          "query": "meeting"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.008997917175292969,
        "is_functional_test": true
      },
      {
        "case_name": "基本功能测试 - 按联系人搜索指定文件夹邮件",
        "purpose": "验证search_emails工具能根据发件人名称在指定文件夹中搜索到相关邮件。",
        "args": {
          "query": "john.doe@example.com",
          "folder_name": "zhihutangjiang@126.com"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.017510414123535156,
        "is_functional_test": true
      },
      {
        "case_name": "基本功能测试 - 按时间段和关键词搜索邮件",
        "purpose": "验证search_emails工具能正确使用时间范围和关键词组合进行邮件搜索。",
        "args": {
          "query": "report",
          "start_date": "2024-03-01 08:00",
          "end_date": "2024-03-10 18:00"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.01700282096862793,
        "is_functional_test": true
      },
      {
        "case_name": "安全性测试 - 非授权访问尝试",
        "purpose": "验证search_emails是否在无效或未认证会话上下文中拒绝请求并返回安全错误信息。",
        "args": {
          "query": "confidential",
          "folder_name": "outformcptest@outlook.com"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.02071356773376465,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 参数验证失败",
        "purpose": "验证search_emails工具对非法参数（如空查询）进行正确校验并返回清晰错误信息。",
        "args": {
          "query": ""
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.015511274337768555,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 文件夹不存在",
        "purpose": "验证当指定的folder_name不存在时，search_emails能否优雅地处理异常并返回合理错误。",
        "args": {
          "query": "project",
          "folder_name": "nonexistent_folder"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.017516613006591797,
        "is_functional_test": false
      },
      {
        "case_name": "边界条件测试 - 时间范围为同一天",
        "purpose": "验证search_emails工具能否正确处理起始时间和结束时间为同一天的情况。",
        "args": {
          "query": "update",
          "start_date": "2024-03-05 10:00",
          "end_date": "2024-03-05 12:00"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.015275955200195312,
        "is_functional_test": true
      },
      {
        "case_name": "边界条件测试 - 文件夹名含特殊字符",
        "purpose": "验证search_emails是否能正确处理包含特殊字符的文件夹名称。",
        "args": {
          "query": "urgent",
          "folder_name": "test@#$.folder"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.017999887466430664,
        "is_functional_test": true
      }
    ],
    "get_email_by_number": [
      {
        "case_name": "基本功能测试 - 获取有效邮件编号的详细信息",
        "purpose": "验证get_email_by_number工具能正确获取指定邮件ID的正文和附件信息。",
        "args": {
          "email_id": 1001
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 1001"
        },
        "execution_time": 0.0039975643157958984,
        "is_functional_test": true
      },
      {
        "case_name": "安全性测试 - 非授权访问尝试获取邮件详情",
        "purpose": "验证在无效或未认证会话下，get_email_by_number是否拒绝请求并返回安全错误信息。",
        "args": {
          "email_id": 1002
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 1002"
        },
        "execution_time": 0.003512859344482422,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 提供无效邮件编号",
        "purpose": "验证当提供的邮件编号不存在时，get_email_by_number能否优雅地处理异常并返回合理错误信息。",
        "args": {
          "email_id": -1
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: -1"
        },
        "execution_time": 0.00499725341796875,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 邮件编号为非整数类型",
        "purpose": "验证当提供的邮件编号不是整数时，工具是否能正确校验参数并返回清晰的错误信息。",
        "args": {
          "email_id": "abc"
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 1 validation error for get_email_by_numberArguments\nemail_id\n  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value='abc', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing"
        },
        "execution_time": 0.0060045719146728516,
        "is_functional_test": false
      },
      {
        "case_name": "边界条件测试 - 最小合法邮件编号",
        "purpose": "验证get_email_by_number能否正确处理最小合法邮件编号（如0）。",
        "args": {
          "email_id": 0
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 0"
        },
        "execution_time": 0.0069942474365234375,
        "is_functional_test": true
      },
      {
        "case_name": "边界条件测试 - 极大邮件编号",
        "purpose": "验证工具是否能正确处理极大邮件编号（如9999999）。",
        "args": {
          "email_id": 9999999
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 9999999"
        },
        "execution_time": 0.005995988845825195,
        "is_functional_test": true
      },
      {
        "case_name": "功能性测试 - 多次调用相同邮件编号",
        "purpose": "验证多次调用get_email_by_number获取同一邮件编号时结果是否一致且稳定。",
        "args": {
          "email_id": 1003
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 1003"
        },
        "execution_time": 0.006001472473144531,
        "is_functional_test": true
      },
      {
        "case_name": "性能边界测试 - 高频连续调用",
        "purpose": "验证get_email_by_number在短时间内被高频调用时是否仍能保持响应性和稳定性。",
        "args": {
          "email_id": 1004
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 1004"
        },
        "execution_time": 0.004000425338745117,
        "is_functional_test": true
      }
    ],
    "reply_to_email_by_number": [
      {
        "case_name": "基本功能测试 - 回复存在的邮件",
        "purpose": "验证reply_to_email_by_number工具能够正确对指定编号的邮件进行回复。",
        "args": {
          "email_id": 1001,
          "reply_text": "这是一个标准的邮件回复内容。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 1001"
        },
        "execution_time": 0.003346681594848633,
        "is_functional_test": true
      },
      {
        "case_name": "安全性测试 - 非授权尝试回复邮件",
        "purpose": "验证在非授权或无效会话上下文中，reply_to_email_by_number是否拒绝执行邮件回复操作。",
        "args": {
          "email_id": 999,
          "reply_text": "非法会话下的测试回复。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 999"
        },
        "execution_time": 0.00901174545288086,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 邮件ID不存在",
        "purpose": "验证当提供的email_id不存在时，reply_to_email_by_number是否能优雅地处理并返回错误信息。",
        "args": {
          "email_id": 999999,
          "reply_text": "该邮件不存在，应返回错误。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 999999"
        },
        "execution_time": 0.003998756408691406,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 缺少必要参数",
        "purpose": "验证当缺少必要参数（如email_id或reply_text）时，工具是否返回清晰的错误信息。",
        "args": {
          "email_id": 1002
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 1 validation error for reply_to_email_by_numberArguments\nreply_text\n  Field required [type=missing, input_value={'email_id': 1002}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.007002830505371094,
        "is_functional_test": false
      },
      {
        "case_name": "边界条件测试 - email_id为最小合法值",
        "purpose": "验证当email_id为最小合法整数值（0）时，工具是否能正确处理。",
        "args": {
          "email_id": 0,
          "reply_text": "测试最小合法邮件ID的回复。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 0"
        },
        "execution_time": 0.004996299743652344,
        "is_functional_test": true
      },
      {
        "case_name": "边界条件测试 - reply_text为空字符串",
        "purpose": "验证当reply_text为空字符串时，工具是否允许发送空回复或返回合理错误。",
        "args": {
          "email_id": 1003,
          "reply_text": ""
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 1003"
        },
        "execution_time": 0.004000663757324219,
        "is_functional_test": true
      },
      {
        "case_name": "边界条件测试 - reply_text含特殊字符",
        "purpose": "验证reply_text中包含特殊字符（如@、#、$、换行符等）时是否能被正确处理。",
        "args": {
          "email_id": 1004,
          "reply_text": "这是一条包含特殊字符的回复：@#￥%……&*（）——+|{}[]\"';:,.<>/?`~\n换行测试"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 1004"
        },
        "execution_time": 0.00699925422668457,
        "is_functional_test": true
      }
    ],
    "compose_email": [
      {
        "case_name": "基本功能测试 - 发送简单邮件",
        "purpose": "验证compose_email工具在提供必要参数时能够成功发送一封基础邮件。",
        "args": {
          "subject": "Test Email",
          "body": "This is a test email body.",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.007001399993896484,
        "is_functional_test": true
      },
      {
        "case_name": "基本功能测试 - 包含抄送的邮件发送",
        "purpose": "验证compose_email工具在包含cc参数时能正确发送邮件并附带抄送地址。",
        "args": {
          "subject": "Email with CC",
          "body": "This email includes a CC recipient.",
          "to": "test@example.com",
          "cc": "cc@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.004999876022338867,
        "is_functional_test": true
      },
      {
        "case_name": "安全性测试 - 非授权会话尝试发送邮件",
        "purpose": "验证在非授权或无效会话上下文中调用compose_email是否被安全拒绝。",
        "args": {
          "subject": "Unauthorized Test",
          "body": "Testing unauthorized send attempt.",
          "to": "unauth@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.012238502502441406,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 缺少必填参数（无主题）",
        "purpose": "验证当缺少subject参数时，compose_email是否能返回清晰的参数校验错误。",
        "args": {
          "body": "Missing subject test.",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: 1 validation error for compose_emailArguments\nsubject\n  Field required [type=missing, input_value={'body': 'Missing subject...to': 'test@example.com'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.0050013065338134766,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 缺少必填参数（无正文）",
        "purpose": "验证当缺少body参数时，compose_email是否能返回清晰的参数校验错误。",
        "args": {
          "subject": "Missing body test",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: 1 validation error for compose_emailArguments\nbody\n  Field required [type=missing, input_value={'subject': 'Missing body...to': 'test@example.com'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.007997989654541016,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 缺少必填参数（无收件人）",
        "purpose": "验证当缺少to参数时，compose_email是否能返回清晰的参数校验错误。",
        "args": {
          "subject": "Missing to test",
          "body": "No recipient provided."
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: 1 validation error for compose_emailArguments\nto\n  Field required [type=missing, input_value={'subject': 'Missing to t...No recipient provided.'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.006003379821777344,
        "is_functional_test": false
      },
      {
        "case_name": "边界条件测试 - 主题为空字符串",
        "purpose": "验证compose_email能否处理空字符串作为subject的情况。",
        "args": {
          "subject": "",
          "body": "Empty subject test.",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.005620241165161133,
        "is_functional_test": true
      },
      {
        "case_name": "边界条件测试 - 特殊字符处理",
        "purpose": "验证compose_email能否正确处理包含特殊字符的主题、正文和收件人信息。",
        "args": {
          "subject": "Subject@#$_with!SpecialChars",
          "body": "This body contains special characters: @, #, $, %, &.",
          "to": "special+chars@test!.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.005001068115234375,
        "is_functional_test": true
      }
    ]
  },
  "total_cases": 47
}