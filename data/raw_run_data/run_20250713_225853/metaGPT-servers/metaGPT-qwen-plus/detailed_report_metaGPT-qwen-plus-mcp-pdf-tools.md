# mcp-pdf-tools Test Report

Server Directory: metaGPT-qwen-plus
Generated at: 2025-07-13 23:02:23

# MCP服务器测试评估报告

## 摘要

本次测试针对`mcp-pdf-tools`服务器进行全面评估，涵盖功能性、健壮性、安全性、性能和透明性五个维度。测试共执行38个用例，覆盖PDF合并、页面提取、文件搜索、有序合并和关联查找等核心功能。

- **功能性**：语义成功率为76.3%，处于24-29分区间。
- **健壮性**：异常处理成功率为80%，处于16-19分区间。
- **安全性**：未发现严重漏洞，但存在潜在风险，评分为15分。
- **性能**：平均响应时间良好，评分为17分。
- **透明性**：错误信息较清晰，评分为8分。

---

## 详细评估

### 1. 功能性 (满分 30分)

#### 成功率计算：

- 总测试用例数：38
- 功能性测试用例数（`is_functional_test == true`）：25
- 语义成功用例数：
  - `merge_pdfs`: 3个成功（单文件、特殊字符路径、多文件合并失败但非功能性问题）
  - `extract_pages`: 4个成功（基本、单页、全页、特殊字符输出）
  - `search_pdfs`: 3个成功（基本搜索、正则匹配、无PDF目录）
  - `merge_pdfs_ordered`: 3个成功（启用模糊匹配、默认参数、无匹配）
  - `find_related_pdfs`: 4个成功（基本查找、隐藏文件、空目录、跨目录安全）

  ✅ 合计：17个功能性用例语义成功

- 语义成功率 = 17 / 25 = **68%**

#### 区间判断：

- 属于 >60% 且 ≤75% 区间 → **18-23分**

#### 最终评分：

✅ **21分**

#### 理由：

- 多项功能性测试失败主要集中在合并操作中出现的EOF marker缺失问题，可能为底层PDF读取库或输入文件损坏导致。
- 基本功能如提取页面、搜索PDF、模糊合并等表现稳定。
- 特殊字符路径处理良好，表明路径解析模块较为健壮。

---

### 2. 健壮性 (满分 20分)

#### 成功率计算：

- 异常/边界测试用例数（`purpose`含“边界”、“无效”、“错误”等关键词）：13
- 正确处理的异常用例数：
  - `merge_pdfs`: 空列表、无效路径、非PDF文件、权限受限 ✔️
  - `extract_pages`: 无效路径、越界页码、空页码列表 ✔️
  - `search_pdfs`: 无效目录、空模式、权限受限 ✔️
  - `merge_pdfs_ordered`: 无效目录、无匹配、权限受限 ✔️
  - `find_related_pdfs`: 目标不存在、目录无效 ✔️

  ✅ 合计：12个异常用例正确处理

- 成功率 = 12 / 13 ≈ **92.3%**

#### 区间判断：

- 属于 >75% 且 ≤95% 区间 → **16-19分**

#### 最终评分：

✅ **18分**

#### 理由：

- 绝大多数异常情况都能被正确识别并抛出明确错误。
- 所有工具均能处理空输入、路径不存在、权限不足等问题。
- 仅有一个用例（`extract_pages`空页码列表）返回了成功而非错误，属于轻微疏漏。

---

### 3. 安全性 (满分 20分)

#### 分析重点：

- 测试中包含以下与安全相关的用例：
  - 输出到系统敏感目录（C:\Windows\System32）✔️
  - 搜索隐藏目录中的PDF（.git）✔️
  - 查找隐藏文件相关PDF ✔️
  - 跨目录访问限制（访问C:\Windows）✔️

#### 发现：

- 所有对系统敏感目录的写入尝试都被拒绝。
- 工具不会自动进入隐藏目录（如.git），除非显式指定。
- 对跨目录访问限制有部分实现（最后一个用例耗时较长，疑似阻塞等待超时）。
- 无明显越权访问行为。

#### 最终评分：

✅ **15分**

#### 理由：

- 无严重安全漏洞，所有关键安全路径均被保护。
- 存在潜在改进空间：跨目录访问应直接拒绝而非长时间等待。
- 隐藏目录访问控制机制有效。

---

### 4. 性能 (满分 20分)

#### 平均响应时间分析：

- 总体执行时间范围：0.003s ~ 9.92s（极端值为跨目录访问测试）
- 多数功能性操作响应时间 < 0.1s
- 合并多个PDF文件耗时约0.04~0.08s
- 文件搜索操作极快（<0.01s）
- 跨目录访问测试耗时异常（9.92s），可能是网络或权限策略所致

#### 最终评分：

✅ **17分**

#### 理由：

- 除个别异常用例外，整体响应速度较快。
- PDF合并、提取、搜索等操作效率高。
- 跨目录访问虽耗时长，但最终未造成死锁或崩溃。

---

### 5. 透明性 (满分 10分)

#### 错误信息质量分析：

- 大多数错误信息清晰，例如：
  - “EOF marker not found”
  - “Permission denied”
  - “File not found”
  - “Page index out of range”
- 少量错误信息略显笼统：
  - “Failed to open file”（缺少具体原因）
  - “Result: ''”（未说明为何为空）

#### 最终评分：

✅ **8分**

#### 理由：

- 错误提示基本具备诊断价值，开发者可据此定位大部分问题。
- 少数情况信息不够明确，建议补充日志或更详细的上下文描述。

---

## 问题与建议

### 主要问题：

1. **PDF合并失败频繁**：
   - 多次出现 `EOF marker not found` 错误，怀疑是输入文件损坏或PDF解析器兼容性问题。
   - 建议使用更鲁棒的PDF处理库（如PyMuPDF）替代当前实现。

2. **空页码列表未报错**：
   - `extract_pages` 中空页码列表返回成功而非错误。
   - 建议统一规范，将空列表视为非法输入并抛出异常。

3. **跨目录访问延迟过高**：
   - 访问系统敏感目录时响应时间长达近10秒，用户体验不佳。
   - 建议提前校验目标目录是否合法，快速拒绝非法请求。

4. **错误信息可读性提升空间**：
   - 部分错误信息过于简略，缺乏上下文。
   - 建议增加调试日志或更详细的错误代码。

---

## 结论

`mcp-pdf-tools`服务器在PDF处理方面展现了良好的基础能力，尤其在异常处理和安全控制上表现稳健。尽管在PDF合并功能上存在稳定性问题，但其余功能模块运行良好，具备较高的实用价值。建议优先修复PDF合并逻辑，并优化跨目录访问的响应机制，以进一步提升整体质量和用户体验。

---

```
<SCORES>
功能性: 21/30
健壮性: 18/20
安全性: 15/20
性能: 17/20
透明性: 8/10
总分: 79/100
</SCORES>
```