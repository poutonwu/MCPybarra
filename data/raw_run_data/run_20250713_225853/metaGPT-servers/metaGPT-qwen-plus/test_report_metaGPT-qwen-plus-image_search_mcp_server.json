{
  "server_name": "image_search_mcp_server",
  "parent_dir": "metaGPT-qwen-plus",
  "report_name": "metaGPT-qwen-plus-image_search_mcp_server",
  "server_path": "workspace\\metaGPT-servers\\metaGPT-qwen-plus\\image_search_mcp_server.py",
  "timestamp": "2025-07-13T22:58:56.798346",
  "tools": [
    {
      "name": "search_images",
      "description": "\n    根据关键词在指定图片源中检索图片。\n\n    Args:\n        keyword: 搜索关键词。\n        source: 图片源（unsplash, pexels, pixabay）。\n\n    Returns:\n        包含图片链接、作者等信息的JSON字符串。\n\n    Raises:\n        ValueError: 如果图片源无效。\n        httpx.HTTPStatusError: 如果API请求失败。\n    ",
      "args_schema": {
        "properties": {
          "keyword": {
            "title": "Keyword",
            "type": "string"
          },
          "source": {
            "default": "unsplash",
            "title": "Source",
            "type": "string"
          }
        },
        "required": [
          "keyword"
        ],
        "title": "search_imagesArguments",
        "type": "object"
      }
    },
    {
      "name": "download_image",
      "description": "\n    下载并保存指定URL的图片。\n\n    Args:\n        url: 图片URL。\n        filename: 保存的文件名。\n\n    Returns:\n        包含保存状态和路径的JSON字符串。\n\n    Raises:\n        httpx.HTTPStatusError: 如果图片下载失败。\n    ",
      "args_schema": {
        "properties": {
          "url": {
            "title": "Url",
            "type": "string"
          },
          "filename": {
            "title": "Filename",
            "type": "string"
          }
        },
        "required": [
          "url",
          "filename"
        ],
        "title": "download_imageArguments",
        "type": "object"
      }
    },
    {
      "name": "generate_icon",
      "description": "\n    根据描述生成指定尺寸的图标。\n\n    Args:\n        description: 图标描述。\n        size: 图标尺寸，默认为64。\n\n    Returns:\n        包含保存状态和路径的JSON字符串。\n\n    Raises:\n        ValueError: 如果尺寸小于16或大于256。\n    ",
      "args_schema": {
        "properties": {
          "description": {
            "title": "Description",
            "type": "string"
          },
          "size": {
            "default": 64,
            "title": "Size",
            "type": "integer"
          }
        },
        "required": [
          "description"
        ],
        "title": "generate_iconArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "search_images": [
      {
        "case_name": "基本功能-默认源搜索",
        "purpose": "验证工具在使用默认图片源（unsplash）和有效关键词时能否正常返回图片结果",
        "args": {
          "keyword": "nature"
        },
        "response": {
          "error": "ToolException: Error executing tool search_images: Client error '401 Unauthorized' for url 'https://api.unsplash.com/search/photos?query=nature&per_page=5'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/401"
        },
        "execution_time": 1.689040184020996,
        "is_functional_test": true
      },
      {
        "case_name": "基本功能-指定Pexels源搜索",
        "purpose": "验证工具在指定pexels源并提供关键词时是否能正确检索图片",
        "args": {
          "keyword": "technology",
          "source": "pexels"
        },
        "response": {
          "result": "{\"page\":1,\"per_page\":5,\"photos\":[{\"id\":546819,\"width\":4288,\"height\":2848,\"url\":\"https://www.pexels.com/photo/close-up-photo-of-programming-of-codes-546819/\",\"photographer\":\"luis gomes\",\"photographer_url\":\"https://www.pexels.com/@luis-gomes-166706\",\"photographer_id\":166706,\"avg_color\":\"#282C44\",\"src\":{\"original\":\"https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg\",\"large2x\":\"https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress\\u0026cs=tinysrgb\\u0026dpr=2\\u0026h=650\\u0026w=940\",\"large\":\"https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress\\u0026cs=tinysrgb\\u0026h=650\\u0026w=940\",\"medium\":\"https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress\\u0026cs=tinysrgb\\u0026h=350\",\"small\":\"https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress\\u0026cs=tinysrgb\\u0026h=130\",\"portrait\":\"https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress\\u0026cs=tinysrgb\\u0026fit=crop\\u0026h=1200\\u0026w=800\",\"landscape\":\"https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress\\u0026cs=tinysrgb\\u0026fit=crop\\u0026h=627\\u0026w=1200\",\"tiny\":\"https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress\\u0026cs=tinysrgb\\u0026dpr=1\\u0026fit=crop\\u0026h=200\\u0026w=280\"},\"liked\":false,\"alt\":\"Close-up of a computer screen displaying programming code in a dark environment.\"},{\"id\":356056,\"width\":4288,\"height\":2848,\"url\":\"https://www.pexels....[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计7325字符，剩余5825字符"
        },
        "execution_time": 1.7964670658111572,
        "is_functional_test": true
      },
      {
        "case_name": "基本功能-指定Pixabay源搜索",
        "purpose": "验证工具在指定pixabay源并提供关键词时是否能正确检索图片",
        "args": {
          "keyword": "flowers",
          "source": "pixabay"
        },
        "response": {
          "result": "{\"total\":1479179,\"totalHits\":500,\"hits\":[{\"id\":9704301,\"pageURL\":\"https://pixabay.com/photos/wheat-cereal-ear-seeds-field-9704301/\",\"type\":\"photo\",\"tags\":\"wheat, cereal, ear, seeds, field, village, rural, growth, nature, agriculture, farm, food\",\"previewURL\":\"https://cdn.pixabay.com/photo/2025/07/09/10/09/wheat-9704301_150.jpg\",\"previewWidth\":150,\"previewHeight\":100,\"webformatURL\":\"https://pixabay.com/get/g1973f26d038fd897c6c711fc42717d1e56b21afb8387c1a387285c727d1d9946fc5c472494852c0125b597f247b5ce955b659642d52aa9a93fe5b65cd7b18eed_640.jpg\",\"webformatWidth\":640,\"webformatHeight\":427,\"largeImageURL\":\"https://pixabay.com/get/g366e0a8a628d60f94ef86b96f63bbe997949122a6c2bd50532b85a2983d4692019189b7f921aad5da8350a15f5feeab4d4992f4280de5b50c0e11adca5bcc51a_1280.jpg\",\"imageWidth\":6000,\"imageHeight\":4000,\"imageSize\":4550930,\"views\":1806,\"downloads\":1420,\"collections\":3,\"likes\":57,\"comments\":25,\"user_id\":9363663,\"user\":\"Nowaja\",\"userImageURL\":\"https://cdn.pixabay.com/user/2020/09/15/15-16-12-52_250x250.jpg\",\"noAiTraining\":false,\"isAiGenerated\":false,\"isGRated\":true,\"isLowQuality\":0,\"userURL\":\"https://pixabay.com/users/9363663/\"},{\"id\":9702173,\"pageURL\":\"https://pixabay.com/photos/eastern-yellow-robin-yellow-robin-9702173/\",\"type\":\"photo\",\"tags\":\"eastern yellow robin, yellow robin, robin, bird, eopsaltria australis, wildlife, wild, nature, avian, birdwatching, plumage, feathers, australia, australian bush\",\"previewURL\":\"https://cdn.pixabay.com/photo/2025/07/08/07/01/eastern-yellow-rob...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计5792字符，剩余4292字符"
        },
        "execution_time": 2.2203102111816406,
        "is_functional_test": true
      },
      {
        "case_name": "错误处理-无效图片源",
        "purpose": "验证工具在传入不支持的图片源时是否抛出ValueError",
        "args": {
          "keyword": "mountains",
          "source": "invalid_source"
        },
        "response": {
          "error": "ToolException: Error executing tool search_images: 无效的图片源: invalid_source"
        },
        "execution_time": 0.0039997100830078125,
        "is_functional_test": false
      },
      {
        "case_name": "边界条件-空关键词搜索",
        "purpose": "测试工具在空关键词下是否仍能处理请求或返回合理结果",
        "args": {
          "keyword": ""
        },
        "response": {
          "error": "ToolException: Error executing tool search_images: Client error '401 Unauthorized' for url 'https://api.unsplash.com/search/photos?query=&per_page=5'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/401"
        },
        "execution_time": 1.5216538906097412,
        "is_functional_test": false
      },
      {
        "case_name": "安全性测试-特殊字符注入尝试",
        "purpose": "测试工具是否对特殊字符进行安全处理，防止潜在注入攻击",
        "args": {
          "keyword": "test; rm -rf /",
          "source": "unsplash"
        },
        "response": {
          "error": "ToolException: Error executing tool search_images: Client error '401 Unauthorized' for url 'https://api.unsplash.com/search/photos?query=test%3B+rm+-rf+%2F&per_page=5'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/401"
        },
        "execution_time": 1.5462219715118408,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理-API请求失败模拟",
        "purpose": "模拟API请求失败场景，验证工具是否能正确抛出httpx.HTTPStatusError",
        "args": {
          "keyword": "error_test",
          "source": "unsplash"
        },
        "response": {
          "error": "ToolException: Error executing tool search_images: Client error '401 Unauthorized' for url 'https://api.unsplash.com/search/photos?query=error_test&per_page=5'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/401"
        },
        "execution_time": 4.220516204833984,
        "is_functional_test": false
      }
    ],
    "download_image": [
      {
        "case_name": "基本功能-成功下载图片",
        "purpose": "验证工具能够正确下载并保存指定URL的图片文件",
        "args": {
          "url": "https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg",
          "filename": "downloaded_image.jpg"
        },
        "response": {
          "result": "{\"status\": \"success\", \"path\": \"./images\\downloaded_image.jpg\"}"
        },
        "execution_time": 1.647714376449585,
        "is_functional_test": true
      },
      {
        "case_name": "错误处理-无效URL格式",
        "purpose": "测试工具在传入无效图片URL时是否能抛出HTTP请求异常",
        "args": {
          "url": "http://invalid.url/image.jpg",
          "filename": "invalid_url_image.jpg"
        },
        "response": {
          "error": "ToolException: Error executing tool download_image: Server error '502 Bad Gateway' for url 'http://invalid.url/image.jpg'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502"
        },
        "execution_time": 2.136079788208008,
        "is_functional_test": false
      },
      {
        "case_name": "安全性测试-路径穿越尝试",
        "purpose": "测试工具是否对文件名中的路径穿越字符进行安全处理",
        "args": {
          "url": "https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg",
          "filename": "../../../malicious_image.jpg"
        },
        "response": {
          "result": "{\"status\": \"success\", \"path\": \"./images\\../../../malicious_image.jpg\"}"
        },
        "execution_time": 1.6526691913604736,
        "is_functional_test": false
      },
      {
        "case_name": "边界条件-空文件名",
        "purpose": "测试工具在空文件名参数下是否能正常处理或抛出合理错误",
        "args": {
          "url": "https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg",
          "filename": ""
        },
        "response": {
          "error": "ToolException: Error executing tool download_image: [Errno 2] No such file or directory: './images\\\\'"
        },
        "execution_time": 1.745727300643921,
        "is_functional_test": false
      },
      {
        "case_name": "基本功能-特殊字符文件名",
        "purpose": "验证工具能否正确处理包含特殊字符的文件名",
        "args": {
          "url": "https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg",
          "filename": "image_with_!@#$%^&*()_+.jpg"
        },
        "response": {
          "error": "ToolException: Error executing tool download_image: [Errno 22] Invalid argument: './images\\\\image_with_!@#$%^&*()_+.jpg'"
        },
        "execution_time": 1.6604037284851074,
        "is_functional_test": true
      },
      {
        "case_name": "错误处理-无写入权限目录",
        "purpose": "测试工具在目标目录无写入权限时是否能正确抛出异常",
        "args": {
          "url": "https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg",
          "filename": "C:\\Windows\\system32\\unwritable_image.jpg"
        },
        "response": {
          "error": "ToolException: Error executing tool download_image: [Errno 13] Permission denied: 'C:\\\\Windows\\\\system32\\\\unwritable_image.jpg'"
        },
        "execution_time": 1.7086849212646484,
        "is_functional_test": false
      },
      {
        "case_name": "边界条件-超长文件名",
        "purpose": "测试工具在文件名长度超过系统限制时的行为",
        "args": {
          "url": "https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg",
          "filename": "a_very_long_filename_that_exceeds_windows_maximum_length_of_260_characters________________________________________________________.jpg"
        },
        "response": {
          "result": "{\"status\": \"success\", \"path\": \"./images\\a_very_long_filename_that_exceeds_windows_maximum_length_of_260_characters________________________________________________________.jpg\"}"
        },
        "execution_time": 1.6740696430206299,
        "is_functional_test": false
      },
      {
        "case_name": "基本功能-从现有文件列表下载",
        "purpose": "使用测试区中已存在的图片文件URL进行下载，验证工具与实际文件系统的兼容性",
        "args": {
          "url": "file:///D:/devWorkspace/MCPServer-Generator/testSystem/testFiles/nature.jpeg",
          "filename": "local_file_download.jpeg"
        },
        "response": {
          "error": "ToolException: Error executing tool download_image: Request URL is missing an 'http://' or 'https://' protocol."
        },
        "execution_time": 0.4065725803375244,
        "is_functional_test": true
      }
    ],
    "generate_icon": [
      {
        "case_name": "基本功能-默认尺寸生成图标",
        "purpose": "验证工具在使用默认尺寸64和有效描述时能否正常生成图标",
        "args": {
          "description": "A red circle with a checkmark inside"
        },
        "response": {
          "result": "{\"status\": \"success\", \"path\": \"./images\\icon_a_red_circle_with_a_checkmark_inside_64x64.png\"}"
        },
        "execution_time": 0.004591941833496094,
        "is_functional_test": true
      },
      {
        "case_name": "基本功能-指定尺寸生成图标",
        "purpose": "验证工具在指定尺寸为128时能否根据描述生成图标",
        "args": {
          "description": "A blue square with a lightning bolt",
          "size": 128
        },
        "response": {
          "result": "{\"status\": \"success\", \"path\": \"./images\\icon_a_blue_square_with_a_lightning_bolt_128x128.png\"}"
        },
        "execution_time": 0.007544755935668945,
        "is_functional_test": true
      },
      {
        "case_name": "安全性测试-特殊字符描述处理",
        "purpose": "测试工具是否对描述中的特殊字符进行安全处理，防止潜在注入攻击",
        "args": {
          "description": "Test icon <script>alert('xss')</script>",
          "size": 64
        },
        "response": {
          "error": "ToolException: Error executing tool generate_icon: [Errno 22] Invalid argument: \"./images\\\\icon_test_icon_<script>alert('xss')</script>_64x64.png\""
        },
        "execution_time": 0.006990909576416016,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理-尺寸小于最小值",
        "purpose": "验证工具在尺寸小于16时是否抛出ValueError",
        "args": {
          "description": "Small icon test",
          "size": 15
        },
        "response": {
          "error": "ToolException: Error executing tool generate_icon: 尺寸超出范围: 15. 有效范围是16到256。"
        },
        "execution_time": 0.005991935729980469,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理-尺寸大于最大值",
        "purpose": "验证工具在尺寸大于256时是否抛出ValueError",
        "args": {
          "description": "Large icon test",
          "size": 257
        },
        "response": {
          "error": "ToolException: Error executing tool generate_icon: 尺寸超出范围: 257. 有效范围是16到256。"
        },
        "execution_time": 0.0029993057250976562,
        "is_functional_test": false
      },
      {
        "case_name": "边界条件-最小合法尺寸",
        "purpose": "测试工具在尺寸为16时是否能正确生成图标",
        "args": {
          "description": "Minimum size icon",
          "size": 16
        },
        "response": {
          "result": "{\"status\": \"success\", \"path\": \"./images\\icon_minimum_size_icon_16x16.png\"}"
        },
        "execution_time": 0.002999544143676758,
        "is_functional_test": true
      },
      {
        "case_name": "边界条件-最大合法尺寸",
        "purpose": "测试工具在尺寸为256时是否能正确生成图标",
        "args": {
          "description": "Maximum size icon",
          "size": 256
        },
        "response": {
          "result": "{\"status\": \"success\", \"path\": \"./images\\icon_maximum_size_icon_256x256.png\"}"
        },
        "execution_time": 0.003994941711425781,
        "is_functional_test": true
      },
      {
        "case_name": "边界条件-含特殊字符的描述",
        "purpose": "测试工具是否能正确处理包含特殊字符的描述文本",
        "args": {
          "description": "Icon with !@#$%^&*()_+=-`~[]{}|;':\",./<>?",
          "size": 64
        },
        "response": {
          "error": "ToolException: Error executing tool generate_icon: [Errno 22] Invalid argument: './images\\\\icon_icon_with_!@#$%^&*()_+=-`~[]{}|;\\':\",./<>?_64x64.png'"
        },
        "execution_time": 0.00700068473815918,
        "is_functional_test": true
      }
    ]
  },
  "total_cases": 23
}