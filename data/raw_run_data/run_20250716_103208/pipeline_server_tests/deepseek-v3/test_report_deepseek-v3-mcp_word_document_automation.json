{
  "server_name": "server",
  "parent_dir": "refined",
  "report_name": "deepseek-v3-mcp_word_document_automation",
  "server_path": "workspace/pipeline-output-servers/deepseek-v3/mcp_word_document_automation/refined/server.py",
  "timestamp": "2025-07-16T10:32:11.318584",
  "tools": [
    {
      "name": "create_document",
      "description": "\n    Creates a new Word document and sets metadata such as title, author, and keywords.\n\n    Args:\n        title: The title of the document.\n        author: The author of the document. Defaults to \"Unknown\".\n        keywords: A list of keywords for the document. Defaults to an empty list.\n\n    Returns:\n        A string containing the path or identifier of the newly created document.\n    ",
      "args_schema": {
        "properties": {
          "title": {
            "title": "Title",
            "type": "string"
          },
          "author": {
            "default": "Unknown",
            "title": "Author",
            "type": "string"
          },
          "keywords": {
            "default": null,
            "items": {},
            "title": "Keywords",
            "type": "array"
          }
        },
        "required": [
          "title"
        ],
        "title": "create_documentArguments",
        "type": "object"
      }
    },
    {
      "name": "get_document_text",
      "description": "\n    Extracts the full text content of a specified Word document.\n\n    Args:\n        document_id: The identifier or path of the document.\n\n    Returns:\n        A string containing the full text of the document.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          }
        },
        "required": [
          "document_id"
        ],
        "title": "get_document_textArguments",
        "type": "object"
      }
    },
    {
      "name": "add_paragraph",
      "description": "\n    Adds a paragraph of text to a specified Word document.\n\n    Args:\n        document_id: The identifier or path of the document.\n        text: The text to add as a paragraph.\n\n    Returns:\n        A boolean indicating success or failure.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          },
          "text": {
            "title": "Text",
            "type": "string"
          }
        },
        "required": [
          "document_id",
          "text"
        ],
        "title": "add_paragraphArguments",
        "type": "object"
      }
    },
    {
      "name": "add_heading",
      "description": "\n    Adds a heading to a specified Word document at a specified level (e.g., H1, H2).\n\n    Args:\n        document_id: The identifier or path of the document.\n        text: The text of the heading.\n        level: The heading level (1 for H1, 2 for H2, etc.).\n\n    Returns:\n        A boolean indicating success or failure.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          },
          "text": {
            "title": "Text",
            "type": "string"
          },
          "level": {
            "title": "Level",
            "type": "integer"
          }
        },
        "required": [
          "document_id",
          "text",
          "level"
        ],
        "title": "add_headingArguments",
        "type": "object"
      }
    },
    {
      "name": "create_custom_style",
      "description": "\n    Creates a custom text style (e.g., font, size, color) for use in the document.\n\n    Args:\n        style_name: The name of the custom style.\n        font: The font name.\n        size: The font size.\n        color: The font color in HEX format (e.g., \"#FF0000\").\n\n    Returns:\n        A boolean indicating success or failure.\n    ",
      "args_schema": {
        "properties": {
          "style_name": {
            "title": "Style Name",
            "type": "string"
          },
          "font": {
            "title": "Font",
            "type": "string"
          },
          "size": {
            "title": "Size",
            "type": "integer"
          },
          "color": {
            "title": "Color",
            "type": "string"
          }
        },
        "required": [
          "style_name",
          "font",
          "size",
          "color"
        ],
        "title": "create_custom_styleArguments",
        "type": "object"
      }
    },
    {
      "name": "format_text",
      "description": "\n    Applies formatting (e.g., bold, italic) to a specified range of text in the document.\n\n    Args:\n        document_id: The identifier or path of the document.\n        start_pos: The starting position of the text range.\n        end_pos: The ending position of the text range.\n        format_options: A dictionary of formatting options (e.g., {\"bold\": True, \"italic\": False}).\n\n    Returns:\n        A boolean indicating success or failure.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          },
          "start_pos": {
            "title": "Start Pos",
            "type": "integer"
          },
          "end_pos": {
            "title": "End Pos",
            "type": "integer"
          },
          "format_options": {
            "title": "Format Options",
            "type": "object"
          }
        },
        "required": [
          "document_id",
          "start_pos",
          "end_pos",
          "format_options"
        ],
        "title": "format_textArguments",
        "type": "object"
      }
    },
    {
      "name": "protect_document",
      "description": "\n    Sets password protection for a specified Word document.\n\n    Args:\n        document_id: The identifier or path of the document.\n        password: The password to set for the document.\n\n    Returns:\n        A boolean indicating success or failure.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          },
          "password": {
            "title": "Password",
            "type": "string"
          }
        },
        "required": [
          "document_id",
          "password"
        ],
        "title": "protect_documentArguments",
        "type": "object"
      }
    },
    {
      "name": "add_footnote_to_document",
      "description": "\n    Adds a footnote to a specified Word document.\n\n    Args:\n        document_id: The identifier or path of the document.\n        text: The text of the footnote.\n\n    Returns:\n        A boolean indicating success or failure.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          },
          "text": {
            "title": "Text",
            "type": "string"
          }
        },
        "required": [
          "document_id",
          "text"
        ],
        "title": "add_footnote_to_documentArguments",
        "type": "object"
      }
    },
    {
      "name": "get_paragraph_text_from_document",
      "description": "\n    Extracts the text of a specific paragraph from a Word document.\n\n    Args:\n        document_id: The identifier or path of the document.\n        paragraph_index: The index of the paragraph to extract.\n\n    Returns:\n        A string containing the text of the specified paragraph.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          },
          "paragraph_index": {
            "title": "Paragraph Index",
            "type": "integer"
          }
        },
        "required": [
          "document_id",
          "paragraph_index"
        ],
        "title": "get_paragraph_text_from_documentArguments",
        "type": "object"
      }
    },
    {
      "name": "find_text_in_document",
      "description": "\n    Searches for a specified text string in a Word document and returns its positions.\n\n    Args:\n        document_id: The identifier or path of the document.\n        search_text: The text to search for.\n\n    Returns:\n        A list of dictionaries, each containing the start and end positions of the found text.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          },
          "search_text": {
            "title": "Search Text",
            "type": "string"
          }
        },
        "required": [
          "document_id",
          "search_text"
        ],
        "title": "find_text_in_documentArguments",
        "type": "object"
      }
    },
    {
      "name": "add_table",
      "description": "\n    Adds a table to a specified Word document.\n\n    Args:\n        document_id: The identifier or path of the document.\n        rows: The number of rows in the table.\n        cols: The number of columns in the table.\n        data: The data to populate the table.\n\n    Returns:\n        A boolean indicating success or failure.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          },
          "rows": {
            "title": "Rows",
            "type": "integer"
          },
          "cols": {
            "title": "Cols",
            "type": "integer"
          },
          "data": {
            "items": {},
            "title": "Data",
            "type": "array"
          }
        },
        "required": [
          "document_id",
          "rows",
          "cols",
          "data"
        ],
        "title": "add_tableArguments",
        "type": "object"
      }
    },
    {
      "name": "add_image",
      "description": "\n    Adds an image to a specified Word document.\n\n    Args:\n        document_id: The identifier or path of the document.\n        image_path: The path to the image file.\n\n    Returns:\n        A boolean indicating success or failure.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          },
          "image_path": {
            "title": "Image Path",
            "type": "string"
          }
        },
        "required": [
          "document_id",
          "image_path"
        ],
        "title": "add_imageArguments",
        "type": "object"
      }
    },
    {
      "name": "add_page_break",
      "description": "\n    Adds a page break to a specified Word document.\n\n    Args:\n        document_id: The identifier or path of the document.\n\n    Returns:\n        A boolean indicating success or failure.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          }
        },
        "required": [
          "document_id"
        ],
        "title": "add_page_breakArguments",
        "type": "object"
      }
    },
    {
      "name": "add_header_footer",
      "description": "\n    Adds a header or footer to a specified Word document.\n\n    Args:\n        document_id: The identifier or path of the document.\n        text: The text to add to the header or footer.\n        is_header: True for header, False for footer.\n\n    Returns:\n        A boolean indicating success or failure.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          },
          "text": {
            "title": "Text",
            "type": "string"
          },
          "is_header": {
            "title": "Is Header",
            "type": "boolean"
          }
        },
        "required": [
          "document_id",
          "text",
          "is_header"
        ],
        "title": "add_header_footerArguments",
        "type": "object"
      }
    },
    {
      "name": "convert_to_pdf",
      "description": "\n    Converts a specified Word document to PDF format.\n\n    Args:\n        document_id: The identifier or path of the document.\n\n    Returns:\n        A string containing the path or identifier of the converted PDF.\n    ",
      "args_schema": {
        "properties": {
          "document_id": {
            "title": "Document Id",
            "type": "string"
          }
        },
        "required": [
          "document_id"
        ],
        "title": "convert_to_pdfArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "create_document": [
      {
        "case_name": "Basic Document Creation",
        "purpose": "验证使用最小必要参数创建文档的基本功能是否正常工作。",
        "args": {
          "title": "Test Document"
        },
        "response": {
          "result": "workspace/Test Document.docx"
        },
        "execution_time": 0.020041704177856445,
        "is_functional_test": true
      },
      {
        "case_name": "Document Creation With Author",
        "purpose": "验证在提供标题和作者的情况下创建文档的功能是否正常。",
        "args": {
          "title": "Report Document",
          "author": "John Doe"
        },
        "response": {
          "result": "workspace/Report Document.docx"
        },
        "execution_time": 0.01870584487915039,
        "is_functional_test": true
      },
      {
        "case_name": "Document Creation With Keywords",
        "purpose": "验证在提供标题和关键词列表的情况下创建文档的功能是否正常。",
        "args": {
          "title": "Keyword Test Doc",
          "keywords": [
            "test",
            "document",
            "keyword"
          ]
        },
        "response": {
          "result": "workspace/Keyword Test Doc.docx"
        },
        "execution_time": 0.017568588256835938,
        "is_functional_test": true
      },
      {
        "case_name": "Document Creation With All Metadata",
        "purpose": "验证在提供标题、作者和关键词的情况下创建文档的功能是否正常。",
        "args": {
          "title": "Full Metadata Document",
          "author": "Jane Smith",
          "keywords": [
            "metadata",
            "full",
            "test"
          ]
        },
        "response": {
          "result": "workspace/Full Metadata Document.docx"
        },
        "execution_time": 0.023639202117919922,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Keywords List Handling",
        "purpose": "验证当关键词参数为空列表时工具是否能正确处理。",
        "args": {
          "title": "Empty Keywords Document",
          "keywords": []
        },
        "response": {
          "result": "workspace/Empty Keywords Document.docx"
        },
        "execution_time": 0.019156455993652344,
        "is_functional_test": true
      },
      {
        "case_name": "Security - Special Characters in Title",
        "purpose": "验证工具对包含特殊字符的标题进行安全处理，防止注入或非法操作。",
        "args": {
          "title": "<script>alert('xss')</script>",
          "author": "Attacker",
          "keywords": [
            "xss",
            "security"
          ]
        },
        "response": {
          "error": "ToolException: Error executing tool create_document: Failed to create document: [Errno 22] Invalid argument: \"workspace/<script>alert('xss')</script>.docx\""
        },
        "execution_time": 0.012190580368041992,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Title",
        "purpose": "验证未提供标题时工具是否能优雅地处理错误（标题为必填项）。",
        "args": {},
        "response": {
          "error": "ToolException: Error executing tool create_document: 1 validation error for create_documentArguments\ntitle\n  Field required [type=missing, input_value={}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.003775358200073242,
        "is_functional_test": false
      }
    ],
    "add_paragraph": [
      {
        "case_name": "Basic Paragraph Addition",
        "purpose": "验证向指定文档添加基本段落的功能是否正常工作。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "text": "This is a basic paragraph."
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.01809215545654297,
        "is_functional_test": true
      },
      {
        "case_name": "Add Empty Paragraph",
        "purpose": "验证工具是否允许添加空段落（应成功，因为内容为空是合法的）。",
        "args": {
          "document_id": "workspace/Report Document.docx",
          "text": ""
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.020045757293701172,
        "is_functional_test": true
      },
      {
        "case_name": "Add Paragraph With Special Characters",
        "purpose": "验证段落中可以包含特殊字符，如标点、符号等。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx",
          "text": "This paragraph contains special characters: !@#$%^&*(), <>, and \"quotes\"."
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.02810525894165039,
        "is_functional_test": true
      },
      {
        "case_name": "Add Paragraph To Nonexistent Document",
        "purpose": "验证尝试向不存在的文档添加段落时是否能正确处理错误。",
        "args": {
          "document_id": "workspace/NonExistentDocument.docx",
          "text": "This should not be added."
        },
        "response": {
          "error": "ToolException: Error executing tool add_paragraph: Failed to add paragraph: Package not found at 'workspace/NonExistentDocument.docx'"
        },
        "execution_time": 0.003000020980834961,
        "is_functional_test": false
      },
      {
        "case_name": "Security - Script Injection Attempt",
        "purpose": "验证工具是否安全地处理包含潜在脚本注入的文本内容。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx",
          "text": "<script>alert('xss')</script>"
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.01692056655883789,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时是否能优雅处理错误。",
        "args": {
          "text": "This should fail due to missing document ID."
        },
        "response": {
          "error": "ToolException: Error executing tool add_paragraph: 1 validation error for add_paragraphArguments\ndocument_id\n  Field required [type=missing, input_value={'text': 'This should fai...o missing document ID.'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.0035037994384765625,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Text Parameter",
        "purpose": "验证未提供 text 参数时是否能优雅处理错误。",
        "args": {
          "document_id": "workspace/Empty Keywords Document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool add_paragraph: 1 validation error for add_paragraphArguments\ntext\n  Field required [type=missing, input_value={'document_id': 'workspac...Keywords Document.docx'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.0025086402893066406,
        "is_functional_test": false
      }
    ],
    "add_heading": [
      {
        "case_name": "Basic Heading Addition",
        "purpose": "验证向指定文档添加基本标题（H1）的功能是否正常工作。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "text": "Introduction",
          "level": 1
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.022499799728393555,
        "is_functional_test": true
      },
      {
        "case_name": "Add Heading With Level 3",
        "purpose": "验证向文档添加H3级别的标题是否成功。",
        "args": {
          "document_id": "workspace/Report Document.docx",
          "text": "Subsection Details",
          "level": 3
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.028466224670410156,
        "is_functional_test": true
      },
      {
        "case_name": "Add Empty Heading",
        "purpose": "验证工具是否允许添加空标题（应成功，因为空文本是合法的）。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx",
          "text": "",
          "level": 2
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.020776748657226562,
        "is_functional_test": true
      },
      {
        "case_name": "Add Heading With Special Characters",
        "purpose": "验证标题中可以包含特殊字符，如标点、符号等。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx",
          "text": "Section: !@#$%^&*(), <>, and \"quotes\"",
          "level": 2
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.020685195922851562,
        "is_functional_test": true
      },
      {
        "case_name": "Security - Script Injection Attempt",
        "purpose": "验证工具是否安全地处理包含潜在脚本注入的标题文本。",
        "args": {
          "document_id": "workspace/Empty Keywords Document.docx",
          "text": "<script>alert('xss')</script>",
          "level": 1
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.020562171936035156,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Invalid Level",
        "purpose": "验证当提供无效的标题级别（如0或负数）时，工具是否能优雅地处理错误。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "text": "Invalid Level Heading",
          "level": 0
        },
        "response": {
          "error": "ToolException: Error executing tool add_heading: Failed to add heading: Heading level must be between 1 and 9"
        },
        "execution_time": 0.0030622482299804688,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时是否能优雅处理错误。",
        "args": {
          "text": "This should fail due to missing document ID",
          "level": 2
        },
        "response": {
          "error": "ToolException: Error executing tool add_heading: 1 validation error for add_headingArguments\ndocument_id\n  Field required [type=missing, input_value={'text': 'This should fai...ocument ID', 'level': 2}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.0040149688720703125,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Level Parameter",
        "purpose": "验证未提供 level 参数时是否能优雅处理错误（level 是必填项）。",
        "args": {
          "document_id": "workspace/Report Document.docx",
          "text": "Heading without level"
        },
        "response": {
          "error": "ToolException: Error executing tool add_heading: 1 validation error for add_headingArguments\nlevel\n  Field required [type=missing, input_value={'document_id': 'workspac...'Heading without level'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.0032706260681152344,
        "is_functional_test": false
      }
    ],
    "get_document_text": [
      {
        "case_name": "Basic Document Text Extraction",
        "purpose": "验证从已创建文档中提取完整文本内容的基本功能是否正常工作。",
        "args": {
          "document_id": "workspace/Test Document.docx"
        },
        "response": {
          "result": "This is a basic paragraph.\nIntroduction"
        },
        "execution_time": 0.01105046272277832,
        "is_functional_test": true
      },
      {
        "case_name": "Extract Text From Document With Author",
        "purpose": "验证从包含作者信息的文档中提取文本内容是否正常。",
        "args": {
          "document_id": "workspace/Report Document.docx"
        },
        "response": {
          "result": "\nSubsection Details"
        },
        "execution_time": 0.01003575325012207,
        "is_functional_test": true
      },
      {
        "case_name": "Extract Text From Document With Keywords",
        "purpose": "验证从包含关键词信息的文档中提取文本内容是否正常。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx"
        },
        "response": {
          "result": "This paragraph contains special characters: !@#$%^&*(), <>, and \"quotes\".\n"
        },
        "execution_time": 0.02181553840637207,
        "is_functional_test": true
      },
      {
        "case_name": "Extract Text From Document With All Metadata",
        "purpose": "验证从包含完整元数据（标题、作者、关键词）的文档中提取文本内容是否正常。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx"
        },
        "response": {
          "result": "<script>alert('xss')</script>\nSection: !@#$%^&*(), <>, and \"quotes\""
        },
        "execution_time": 0.010013103485107422,
        "is_functional_test": true
      },
      {
        "case_name": "Security - Special Characters in Document Path",
        "purpose": "验证工具是否安全地处理包含特殊字符的文档路径，防止路径遍历或注入攻击。",
        "args": {
          "document_id": "workspace/../../test_files/evil.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool get_document_text: Failed to extract text from document: Package not found at 'workspace/../../test_files/evil.docx'"
        },
        "execution_time": 0.00299835205078125,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Nonexistent Document",
        "purpose": "验证尝试提取不存在文档的文本内容时是否能正确处理错误。",
        "args": {
          "document_id": "workspace/NonExistentDocument.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool get_document_text: Failed to extract text from document: Package not found at 'workspace/NonExistentDocument.docx'"
        },
        "execution_time": 0.0031387805938720703,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时是否能优雅处理错误。",
        "args": {},
        "response": {
          "error": "ToolException: Error executing tool get_document_text: 1 validation error for get_document_textArguments\ndocument_id\n  Field required [type=missing, input_value={}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.002998828887939453,
        "is_functional_test": false
      },
      {
        "case_name": "Boundary - Empty Document",
        "purpose": "验证从一个没有任何内容的文档中提取文本时是否返回空字符串。",
        "args": {
          "document_id": "workspace/Empty Document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool get_document_text: Failed to extract text from document: Package not found at 'workspace/Empty Document.docx'"
        },
        "execution_time": 0.004019260406494141,
        "is_functional_test": true
      }
    ],
    "get_paragraph_text_from_document": [
      {
        "case_name": "Basic Paragraph Extraction",
        "purpose": "验证从已创建文档中提取指定段落的基本功能是否正常工作。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "paragraph_index": 0
        },
        "response": {
          "result": "This is a basic paragraph."
        },
        "execution_time": 0.010679483413696289,
        "is_functional_test": true
      },
      {
        "case_name": "Extract Paragraph From Document With Multiple Paragraphs",
        "purpose": "验证从包含多个段落的文档中正确提取指定索引段落的功能。",
        "args": {
          "document_id": "workspace/Report Document.docx",
          "paragraph_index": 1
        },
        "response": {
          "result": "Subsection Details"
        },
        "execution_time": 0.010684490203857422,
        "is_functional_test": true
      },
      {
        "case_name": "Extract Empty Paragraph",
        "purpose": "验证工具能够正确提取内容为空的段落。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx",
          "paragraph_index": 2
        },
        "response": {
          "error": "ToolException: Error executing tool get_paragraph_text_from_document: Failed to get paragraph text: Paragraph index out of range"
        },
        "execution_time": 0.012981176376342773,
        "is_functional_test": true
      },
      {
        "case_name": "Negative Index Handling",
        "purpose": "验证使用负数段落索引时是否能优雅处理错误（如Python风格负索引不被支持）。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx",
          "paragraph_index": -1
        },
        "response": {
          "error": "ToolException: Error executing tool get_paragraph_text_from_document: Failed to get paragraph text: Paragraph index out of range"
        },
        "execution_time": 0.015163660049438477,
        "is_functional_test": false
      },
      {
        "case_name": "Paragraph Index Out Of Range",
        "purpose": "验证请求超出实际段落数量范围的索引时是否能正确处理错误。",
        "args": {
          "document_id": "workspace/Empty Keywords Document.docx",
          "paragraph_index": 999
        },
        "response": {
          "error": "ToolException: Error executing tool get_paragraph_text_from_document: Failed to get paragraph text: Paragraph index out of range"
        },
        "execution_time": 0.026894330978393555,
        "is_functional_test": false
      },
      {
        "case_name": "Security - Script Injection in Paragraph Index",
        "purpose": "验证工具是否安全地处理非法段落索引输入，防止注入攻击。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx",
          "paragraph_index": "<script>alert('xss')</script>"
        },
        "response": {
          "error": "ToolException: Error executing tool get_paragraph_text_from_document: 1 validation error for get_paragraph_text_from_documentArguments\nparagraph_index\n  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value=\"<script>alert('xss')</script>\", input_type=str]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing"
        },
        "execution_time": 0.005997419357299805,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时是否能优雅处理错误。",
        "args": {
          "paragraph_index": 0
        },
        "response": {
          "error": "ToolException: Error executing tool get_paragraph_text_from_document: 1 validation error for get_paragraph_text_from_documentArguments\ndocument_id\n  Field required [type=missing, input_value={'paragraph_index': 0}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.003003835678100586,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Paragraph Index",
        "purpose": "验证未提供 paragraph_index 参数时是否能优雅处理错误。",
        "args": {
          "document_id": "workspace/Test Document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool get_paragraph_text_from_document: 1 validation error for get_paragraph_text_from_documentArguments\nparagraph_index\n  Field required [type=missing, input_value={'document_id': 'workspace/Test Document.docx'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.003477334976196289,
        "is_functional_test": false
      }
    ],
    "find_text_in_document": [
      {
        "case_name": "Basic Text Search",
        "purpose": "验证在已创建文档中搜索基本文本的功能是否正常工作。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "search_text": "basic paragraph"
        },
        "response": {
          "result": "{\n  \"start\": 10,\n  \"end\": 25\n}"
        },
        "execution_time": 0.010946273803710938,
        "is_functional_test": true
      },
      {
        "case_name": "Search For Nonexistent Text",
        "purpose": "验证搜索不存在的文本时工具是否返回空结果而不报错。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "search_text": "nonexistent text"
        },
        "response": {
          "result": ""
        },
        "execution_time": 0.01706695556640625,
        "is_functional_test": true
      },
      {
        "case_name": "Search In Document With Special Characters",
        "purpose": "验证工具是否能正确搜索包含特殊字符的文本。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx",
          "search_text": "special characters"
        },
        "response": {
          "result": "{\n  \"start\": 24,\n  \"end\": 42\n}"
        },
        "execution_time": 0.014132499694824219,
        "is_functional_test": true
      },
      {
        "case_name": "Search In Empty Document",
        "purpose": "验证在没有段落的文档中搜索文本时工具是否正确处理。",
        "args": {
          "document_id": "workspace/Empty Keywords Document.docx",
          "search_text": "empty"
        },
        "response": {
          "result": ""
        },
        "execution_time": 0.014011621475219727,
        "is_functional_test": true
      },
      {
        "case_name": "Security - Search For Script Injection",
        "purpose": "验证工具是否安全地处理包含潜在脚本注入的搜索文本。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx",
          "search_text": "<script>alert('xss')</script>"
        },
        "response": {
          "result": "{\n  \"start\": 0,\n  \"end\": 29\n}"
        },
        "execution_time": 0.01310586929321289,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Search In Nonexistent Document",
        "purpose": "验证尝试在不存在的文档中搜索时是否能优雅地处理错误。",
        "args": {
          "document_id": "workspace/NonExistentDocument.docx",
          "search_text": "test"
        },
        "response": {
          "error": "ToolException: Error executing tool find_text_in_document: Failed to find text in document: Package not found at 'workspace/NonExistentDocument.docx'"
        },
        "execution_time": 0.021867036819458008,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时是否能优雅处理错误。",
        "args": {
          "search_text": "test"
        },
        "response": {
          "error": "ToolException: Error executing tool find_text_in_document: 1 validation error for find_text_in_documentArguments\ndocument_id\n  Field required [type=missing, input_value={'search_text': 'test'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.003786325454711914,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Search Text",
        "purpose": "验证未提供 search_text 参数时是否能优雅处理错误。",
        "args": {
          "document_id": "workspace/Test Document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool find_text_in_document: 1 validation error for find_text_in_documentArguments\nsearch_text\n  Field required [type=missing, input_value={'document_id': 'workspace/Test Document.docx'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.005278348922729492,
        "is_functional_test": false
      }
    ],
    "create_custom_style": [
      {
        "case_name": "Basic Custom Style Creation",
        "purpose": "验证使用标准参数创建自定义文本样式的基本功能是否正常工作。",
        "args": {
          "style_name": "DefaultStyle",
          "font": "Arial",
          "size": 12,
          "color": "#000000"
        },
        "response": {
          "error": "ToolException: Error executing tool create_custom_style: Failed to create custom style: invalid literal for int() with base 16: '#0'"
        },
        "execution_time": 0.015628337860107422,
        "is_functional_test": true
      },
      {
        "case_name": "Create Style With Maximum Font Size",
        "purpose": "验证最大支持字体大小（例如 144）是否能正确应用。",
        "args": {
          "style_name": "LargeFontStyle",
          "font": "Times New Roman",
          "size": 144,
          "color": "#FF5733"
        },
        "response": {
          "error": "ToolException: Error executing tool create_custom_style: Failed to create custom style: invalid literal for int() with base 16: '#F'"
        },
        "execution_time": 0.015946626663208008,
        "is_functional_test": true
      },
      {
        "case_name": "Create Style With Minimum Font Size",
        "purpose": "验证最小支持字体大小（例如 1）是否能正确应用。",
        "args": {
          "style_name": "TinyFontStyle",
          "font": "Courier New",
          "size": 1,
          "color": "#0000FF"
        },
        "response": {
          "error": "ToolException: Error executing tool create_custom_style: Failed to create custom style: invalid literal for int() with base 16: '#0'"
        },
        "execution_time": 0.017280101776123047,
        "is_functional_test": true
      },
      {
        "case_name": "Create Style With Invalid Color Format",
        "purpose": "验证工具是否拒绝非HEX格式的颜色值。",
        "args": {
          "style_name": "InvalidColorStyle",
          "font": "Verdana",
          "size": 10,
          "color": "red"
        },
        "response": {
          "error": "ToolException: Error executing tool create_custom_style: Failed to create custom style: invalid literal for int() with base 16: 're'"
        },
        "execution_time": 0.024686813354492188,
        "is_functional_test": false
      },
      {
        "case_name": "Create Style Without Required Parameters",
        "purpose": "验证未提供必填字段时工具是否能优雅处理错误。",
        "args": {
          "style_name": "",
          "font": "",
          "size": null,
          "color": ""
        },
        "response": {
          "error": "ToolException: Error executing tool create_custom_style: 1 validation error for create_custom_styleArguments\nsize\n  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_type"
        },
        "execution_time": 0.006547212600708008,
        "is_functional_test": false
      },
      {
        "case_name": "Security - Script Injection in Style Name",
        "purpose": "验证工具是否安全地处理包含潜在脚本注入的样式名称。",
        "args": {
          "style_name": "<script>alert('xss')</script>",
          "font": "Arial",
          "size": 12,
          "color": "#000000"
        },
        "response": {
          "error": "ToolException: Error executing tool create_custom_style: Failed to create custom style: invalid literal for int() with base 16: '#0'"
        },
        "execution_time": 0.019617795944213867,
        "is_functional_test": false
      },
      {
        "case_name": "Create Style With Special Characters in Name",
        "purpose": "验证样式名称中包含特殊字符是否被正确处理。",
        "args": {
          "style_name": "Style!@#$%^&*()_+{}|:\"<>?`~",
          "font": "Arial",
          "size": 12,
          "color": "#000000"
        },
        "response": {
          "error": "ToolException: Error executing tool create_custom_style: Failed to create custom style: invalid literal for int() with base 16: '#0'"
        },
        "execution_time": 0.016176223754882812,
        "is_functional_test": true
      },
      {
        "case_name": "Create Duplicate Style Name",
        "purpose": "验证系统是否允许重复的样式名称存在或是否自动处理冲突。",
        "args": {
          "style_name": "DefaultStyle",
          "font": "Calibri",
          "size": 14,
          "color": "#00FF00"
        },
        "response": {
          "error": "ToolException: Error executing tool create_custom_style: Failed to create custom style: invalid literal for int() with base 16: '#0'"
        },
        "execution_time": 0.016739606857299805,
        "is_functional_test": true
      }
    ],
    "format_text": [
      {
        "case_name": "Basic Text Formatting",
        "purpose": "验证对指定文本范围应用基本格式（如加粗）的功能是否正常。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "start_pos": 0,
          "end_pos": 5,
          "format_options": {
            "bold": true,
            "italic": false
          }
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.027211427688598633,
        "is_functional_test": true
      },
      {
        "case_name": "Apply Multiple Formats",
        "purpose": "验证可以同时应用多种格式（如加粗和斜体）到同一文本范围。",
        "args": {
          "document_id": "workspace/Report Document.docx",
          "start_pos": 10,
          "end_pos": 20,
          "format_options": {
            "bold": true,
            "italic": true
          }
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.024029254913330078,
        "is_functional_test": true
      },
      {
        "case_name": "Format Empty Range",
        "purpose": "验证当起始位置与结束位置相同时（即空范围）是否能安全处理。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx",
          "start_pos": 5,
          "end_pos": 5,
          "format_options": {
            "underline": true
          }
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.037628889083862305,
        "is_functional_test": true
      },
      {
        "case_name": "Security - Script Injection in Format Options",
        "purpose": "验证工具是否安全地处理包含潜在脚本注入的格式选项。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx",
          "start_pos": 0,
          "end_pos": 10,
          "format_options": {
            "custom_script": "<script>alert('xss')</script>"
          }
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.030341386795043945,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Invalid Document ID",
        "purpose": "验证在提供无效文档ID时是否能优雅地处理错误。",
        "args": {
          "document_id": "workspace/NonExistentDocument.docx",
          "start_pos": 0,
          "end_pos": 10,
          "format_options": {
            "bold": true
          }
        },
        "response": {
          "error": "ToolException: Error executing tool format_text: Failed to format text: Package not found at 'workspace/NonExistentDocument.docx'"
        },
        "execution_time": 0.02352619171142578,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Required Parameters",
        "purpose": "验证未提供必需参数时是否能正确抛出验证错误。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "start_pos": 0
        },
        "response": {
          "error": "ToolException: Error executing tool format_text: 2 validation errors for format_textArguments\nend_pos\n  Field required [type=missing, input_value={'document_id': 'workspac...t.docx', 'start_pos': 0}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing\nformat_options\n  Field required [type=missing, input_value={'document_id': 'workspac...t.docx', 'start_pos': 0}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.005024433135986328,
        "is_functional_test": false
      },
      {
        "case_name": "Boundary Conditions - Zero Position",
        "purpose": "验证从位置0开始的边界情况是否处理正确。",
        "args": {
          "document_id": "workspace/Empty Keywords Document.docx",
          "start_pos": 0,
          "end_pos": 0,
          "format_options": {
            "italic": true
          }
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.024053335189819336,
        "is_functional_test": true
      },
      {
        "case_name": "Boundary Conditions - Negative Position",
        "purpose": "验证负数位置是否被正确拒绝以防止非法范围。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "start_pos": -1,
          "end_pos": 5,
          "format_options": {
            "underline": true
          }
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.03603410720825195,
        "is_functional_test": false
      }
    ],
    "add_table": [
      {
        "case_name": "Basic Table Addition",
        "purpose": "验证向指定文档添加基本表格的功能是否正常工作。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "rows": 3,
          "cols": 2,
          "data": [
            [
              "Row1-Col1",
              "Row1-Col2"
            ],
            [
              "Row2-Col1",
              "Row2-Col2"
            ],
            [
              "Row3-Col1",
              "Row3-Col2"
            ]
          ]
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.026157855987548828,
        "is_functional_test": true
      },
      {
        "case_name": "Add Empty Table",
        "purpose": "验证可以成功添加空行空列的表格（0行0列）。",
        "args": {
          "document_id": "workspace/Report Document.docx",
          "rows": 0,
          "cols": 0,
          "data": []
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.02252364158630371,
        "is_functional_test": true
      },
      {
        "case_name": "Add Table With Special Characters",
        "purpose": "验证表格数据中包含特殊字符时工具是否能正确处理。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx",
          "rows": 2,
          "cols": 2,
          "data": [
            [
              "!@#$%^&*",
              "<>\"'{}[]"
            ],
            [
              "中文测试",
              "日本語テスト"
            ]
          ]
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.02178049087524414,
        "is_functional_test": true
      },
      {
        "case_name": "Security - Script Injection Attempt in Data",
        "purpose": "验证工具是否安全地处理表格数据中的潜在脚本注入内容。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx",
          "rows": 1,
          "cols": 1,
          "data": [
            [
              "<script>alert('xss')</script>"
            ]
          ]
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.029906511306762695,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时是否能优雅处理错误。",
        "args": {
          "rows": 2,
          "cols": 2,
          "data": [
            [
              "A",
              "B"
            ],
            [
              "C",
              "D"
            ]
          ]
        },
        "response": {
          "error": "ToolException: Error executing tool add_table: 1 validation error for add_tableArguments\ndocument_id\n  Field required [type=missing, input_value={'rows': 2, 'cols': 2, 'd...['A', 'B'], ['C', 'D']]}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.004506349563598633,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Invalid Row Count",
        "purpose": "验证提供负数行数时是否能正确处理错误。",
        "args": {
          "document_id": "workspace/Empty Keywords Document.docx",
          "rows": -1,
          "cols": 2,
          "data": [
            [
              "A",
              "B"
            ]
          ]
        },
        "response": {
          "error": "ToolException: Error executing tool add_table: Failed to add table: Data dimensions must match rows and columns"
        },
        "execution_time": 0.005001068115234375,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Add Table To Nonexistent Document",
        "purpose": "验证尝试向不存在的文档添加表格时是否能正确处理错误。",
        "args": {
          "document_id": "workspace/NonExistentDocument.docx",
          "rows": 2,
          "cols": 2,
          "data": [
            [
              "X",
              "Y"
            ],
            [
              "Z",
              "W"
            ]
          ]
        },
        "response": {
          "error": "ToolException: Error executing tool add_table: Failed to add table: Package not found at 'workspace/NonExistentDocument.docx'"
        },
        "execution_time": 0.004022359848022461,
        "is_functional_test": false
      },
      {
        "case_name": "Boundary Condition - Large Table",
        "purpose": "验证工具处理大尺寸表格的能力（例如1000行100列）。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx",
          "rows": 1000,
          "cols": 100,
          "data": []
        },
        "response": {
          "error": "ToolException: Error executing tool add_table: Failed to add table: Data dimensions must match rows and columns"
        },
        "execution_time": 0.0039997100830078125,
        "is_functional_test": true
      }
    ],
    "add_image": [
      {
        "case_name": "Basic Image Addition",
        "purpose": "验证向已存在文档中添加图片的基本功能是否正常工作。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "image_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\hit.png"
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.024089574813842773,
        "is_functional_test": true
      },
      {
        "case_name": "Add Image To Document With Author",
        "purpose": "验证向包含作者信息的文档添加图片的功能是否正常。",
        "args": {
          "document_id": "workspace/Report Document.docx",
          "image_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\app.png"
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.02570176124572754,
        "is_functional_test": true
      },
      {
        "case_name": "Add Image To Document With Keywords",
        "purpose": "验证向包含关键词的文档添加图片的功能是否正常。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx",
          "image_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\xue.png"
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.21106505393981934,
        "is_functional_test": true
      },
      {
        "case_name": "Add Image To Nonexistent Document",
        "purpose": "验证尝试向不存在的文档添加图片时是否能正确处理错误。",
        "args": {
          "document_id": "workspace/NonExistentDocument.docx",
          "image_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\hit.png"
        },
        "response": {
          "error": "ToolException: Error executing tool add_image: Failed to add image: Package not found at 'workspace/NonExistentDocument.docx'"
        },
        "execution_time": 0.00699925422668457,
        "is_functional_test": false
      },
      {
        "case_name": "Security - Special Characters in Image Path",
        "purpose": "验证工具对包含特殊字符的图片路径进行安全处理，防止注入或非法操作。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "image_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\<script>malicious</script>.png"
        },
        "response": {
          "error": "ToolException: Error executing tool add_image: Failed to add image: Image file not found: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\<script>malicious</script>.png"
        },
        "execution_time": 0.005010366439819336,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时是否能优雅地处理错误。",
        "args": {
          "image_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\hit.png"
        },
        "response": {
          "error": "ToolException: Error executing tool add_image: 1 validation error for add_imageArguments\ndocument_id\n  Field required [type=missing, input_value={'image_path': 'D:\\\\devWo...em\\\\testFiles\\\\hit.png'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.02018284797668457,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Image Path",
        "purpose": "验证未提供 image_path 参数时是否能优雅地处理错误。",
        "args": {
          "document_id": "workspace/Test Document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool add_image: 1 validation error for add_imageArguments\nimage_path\n  Field required [type=missing, input_value={'document_id': 'workspace/Test Document.docx'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.006011247634887695,
        "is_functional_test": false
      },
      {
        "case_name": "Boundary Condition - Zero Length Image File",
        "purpose": "验证向文档中添加大小为0字节的图片文件时是否能正确处理。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "image_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\zero_byte_image.png"
        },
        "response": {
          "error": "ToolException: Error executing tool add_image: Failed to add image: Image file not found: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\zero_byte_image.png"
        },
        "execution_time": 0.006005048751831055,
        "is_functional_test": false
      }
    ],
    "add_page_break": [
      {
        "case_name": "Basic Page Break Addition",
        "purpose": "验证向已存在文档添加分页符的基本功能是否正常工作。",
        "args": {
          "document_id": "workspace/Test Document.docx"
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.02137279510498047,
        "is_functional_test": true
      },
      {
        "case_name": "Add Page Break To Document With Author",
        "purpose": "验证向包含作者信息的文档添加分页符的功能是否正常。",
        "args": {
          "document_id": "workspace/Report Document.docx"
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.0223691463470459,
        "is_functional_test": true
      },
      {
        "case_name": "Add Page Break To Document With Keywords",
        "purpose": "验证向包含关键词的文档添加分页符时工具是否正常处理。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx"
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.18962574005126953,
        "is_functional_test": true
      },
      {
        "case_name": "Add Page Break To Document With All Metadata",
        "purpose": "验证向包含完整元数据（标题、作者、关键词）的文档添加分页符是否成功。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx"
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.020664691925048828,
        "is_functional_test": true
      },
      {
        "case_name": "Security - Special Characters in Document Path",
        "purpose": "验证当 document_id 包含特殊字符时，工具是否安全地处理路径以防止注入攻击。",
        "args": {
          "document_id": "workspace/<script>alert('xss')</script>.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool add_page_break: Failed to add page break: Package not found at 'workspace/<script>alert('xss')</script>.docx'"
        },
        "execution_time": 0.004174232482910156,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时工具是否能优雅地处理错误。",
        "args": {},
        "response": {
          "error": "ToolException: Error executing tool add_page_break: 1 validation error for add_page_breakArguments\ndocument_id\n  Field required [type=missing, input_value={}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.004388332366943359,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Add Page Break To Nonexistent Document",
        "purpose": "验证尝试向不存在的文档添加分页符时是否能正确处理错误。",
        "args": {
          "document_id": "workspace/NonExistentDocument.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool add_page_break: Failed to add page break: Package not found at 'workspace/NonExistentDocument.docx'"
        },
        "execution_time": 0.011016845703125,
        "is_functional_test": false
      },
      {
        "case_name": "Boundary Condition - Long Document Path",
        "purpose": "验证工具在提供超长文档路径时是否能正确处理边界情况。",
        "args": {
          "document_id": "workspace/very_long_document_name_1234567890_abcdefghijklmnopqrstuvwxyz.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool add_page_break: Failed to add page break: Package not found at 'workspace/very_long_document_name_1234567890_abcdefghijklmnopqrstuvwxyz.docx'"
        },
        "execution_time": 0.0040051937103271484,
        "is_functional_test": true
      }
    ],
    "add_header_footer": [
      {
        "case_name": "Basic Header Addition",
        "purpose": "验证向指定文档添加基本页眉的功能是否正常工作。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "text": "This is a header.",
          "is_header": true
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.02466559410095215,
        "is_functional_test": true
      },
      {
        "case_name": "Basic Footer Addition",
        "purpose": "验证向指定文档添加基本页脚的功能是否正常工作。",
        "args": {
          "document_id": "workspace/Report Document.docx",
          "text": "This is a footer.",
          "is_header": false
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.027935266494750977,
        "is_functional_test": true
      },
      {
        "case_name": "Add Empty Header",
        "purpose": "验证工具是否允许添加空页眉（应成功，因为内容为空是合法的）。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx",
          "text": "",
          "is_header": true
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.1987922191619873,
        "is_functional_test": true
      },
      {
        "case_name": "Add Header To Nonexistent Document",
        "purpose": "验证尝试向不存在的文档添加页眉时是否能正确处理错误。",
        "args": {
          "document_id": "workspace/NonExistentDocument.docx",
          "text": "This should not be added as header.",
          "is_header": true
        },
        "response": {
          "error": "ToolException: Error executing tool add_header_footer: Failed to add header/footer: Package not found at 'workspace/NonExistentDocument.docx'"
        },
        "execution_time": 0.005205631256103516,
        "is_functional_test": false
      },
      {
        "case_name": "Security - Script Injection in Header",
        "purpose": "验证工具是否安全地处理包含潜在脚本注入的页眉文本。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx",
          "text": "<script>alert('xss')</script>",
          "is_header": true
        },
        "response": {
          "result": "true"
        },
        "execution_time": 0.023055553436279297,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时是否能优雅处理错误。",
        "args": {
          "text": "Header text without document ID",
          "is_header": true
        },
        "response": {
          "error": "ToolException: Error executing tool add_header_footer: 1 validation error for add_header_footerArguments\ndocument_id\n  Field required [type=missing, input_value={'text': 'Header text wit... ID', 'is_header': True}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.01204991340637207,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Text Parameter",
        "purpose": "验证未提供 text 参数时是否能优雅处理错误。",
        "args": {
          "document_id": "workspace/Empty Keywords Document.docx",
          "is_header": false
        },
        "response": {
          "error": "ToolException: Error executing tool add_header_footer: 1 validation error for add_header_footerArguments\ntext\n  Field required [type=missing, input_value={'document_id': 'workspac...cx', 'is_header': False}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.005004405975341797,
        "is_functional_test": false
      }
    ],
    "add_footnote_to_document": [
      {
        "case_name": "Basic Footnote Addition",
        "purpose": "验证向指定文档添加基本脚注的基本功能是否正常工作。",
        "args": {
          "document_id": "workspace/Test Document.docx",
          "text": "This is a basic footnote."
        },
        "response": {
          "error": "ToolException: Error executing tool add_footnote_to_document: Failed to add footnote: 'Document' object has no attribute 'add_footnote'"
        },
        "execution_time": 0.012511253356933594,
        "is_functional_test": true
      },
      {
        "case_name": "Add Empty Footnote",
        "purpose": "验证工具是否允许添加空脚注（内容为空是合法的）。",
        "args": {
          "document_id": "workspace/Report Document.docx",
          "text": ""
        },
        "response": {
          "error": "ToolException: Error executing tool add_footnote_to_document: Failed to add footnote: 'Document' object has no attribute 'add_footnote'"
        },
        "execution_time": 0.01385807991027832,
        "is_functional_test": true
      },
      {
        "case_name": "Add Footnote With Special Characters",
        "purpose": "验证脚注中可以包含特殊字符，如标点、符号等。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx",
          "text": "This footnote contains special characters: !@#$%^&*(), <>, and \"quotes\"."
        },
        "response": {
          "error": "ToolException: Error executing tool add_footnote_to_document: Failed to add footnote: 'Document' object has no attribute 'add_footnote'"
        },
        "execution_time": 0.02858257293701172,
        "is_functional_test": true
      },
      {
        "case_name": "Add Footnote To Nonexistent Document",
        "purpose": "验证尝试向不存在的文档添加脚注时是否能正确处理错误。",
        "args": {
          "document_id": "workspace/NonExistentDocument.docx",
          "text": "This should not be added."
        },
        "response": {
          "error": "ToolException: Error executing tool add_footnote_to_document: Failed to add footnote: Package not found at 'workspace/NonExistentDocument.docx'"
        },
        "execution_time": 0.0029997825622558594,
        "is_functional_test": false
      },
      {
        "case_name": "Security - Script Injection Attempt",
        "purpose": "验证工具是否安全地处理包含潜在脚本注入的脚注文本。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx",
          "text": "<script>alert('xss')</script>"
        },
        "response": {
          "error": "ToolException: Error executing tool add_footnote_to_document: Failed to add footnote: 'Document' object has no attribute 'add_footnote'"
        },
        "execution_time": 0.010775327682495117,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时是否能优雅处理错误。",
        "args": {
          "text": "This should fail due to missing document ID."
        },
        "response": {
          "error": "ToolException: Error executing tool add_footnote_to_document: 1 validation error for add_footnote_to_documentArguments\ndocument_id\n  Field required [type=missing, input_value={'text': 'This should fai...o missing document ID.'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.003997087478637695,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Text Parameter",
        "purpose": "验证未提供 text 参数时是否能优雅处理错误。",
        "args": {
          "document_id": "workspace/Empty Keywords Document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool add_footnote_to_document: 1 validation error for add_footnote_to_documentArguments\ntext\n  Field required [type=missing, input_value={'document_id': 'workspac...Keywords Document.docx'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.0045049190521240234,
        "is_functional_test": false
      }
    ],
    "protect_document": [
      {
        "case_name": "Basic Document Protection",
        "purpose": "验证使用有效文档路径和密码对文档进行基本保护功能是否正常工作。",
        "args": {
          "document_id": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\saved_document.docx",
          "password": "secure123"
        },
        "response": {
          "error": "ToolException: Error executing tool protect_document: Failed to protect document: (-2147352567, '发生意外。', (0, 'Microsoft Word', 'Word 在试图打开文件时遇到错误。\\n请尝试下列方法:\\n* 检查文档或驱动器的文件权限。\\n* 确保有足够的内存和磁盘空间。\\n* 用文本恢复转换器打开文件。\\r (D:\\\\devWorkspace\\\\...\\\\saved_document.docx)', 'wdmain11.chm', 24601, -2146823167), None)"
        },
        "execution_time": 0.08668160438537598,
        "is_functional_test": true
      },
      {
        "case_name": "Protect Nonexistent Document",
        "purpose": "验证尝试对不存在的文档设置保护时工具是否能正确处理错误。",
        "args": {
          "document_id": "workspace/NonExistentDocument.docx",
          "password": "password123"
        },
        "response": {
          "error": "ToolException: Error executing tool protect_document: Failed to protect document: (-2147352567, '发生意外。', (0, 'Microsoft Word', '很抱歉，找不到您的文件。该项目是否已移动、重命名或删除?\\r (C:\\\\Users\\\\PS\\\\...\\\\NonExistentDocument.docx)', 'wdmain11.chm', 24654, -2146823114), None)"
        },
        "execution_time": 0.00895237922668457,
        "is_functional_test": false
      },
      {
        "case_name": "Empty Password Protection",
        "purpose": "验证使用空密码设置文档保护时是否允许（应成功，因为空密码在某些系统中是合法的）。",
        "args": {
          "document_id": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\saved_document.docx",
          "password": ""
        },
        "response": {
          "error": "ToolException: Error executing tool protect_document: Failed to protect document: (-2147352567, '发生意外。', (0, 'Microsoft Word', 'Word 在试图打开文件时遇到错误。\\n请尝试下列方法:\\n* 检查文档或驱动器的文件权限。\\n* 确保有足够的内存和磁盘空间。\\n* 用文本恢复转换器打开文件。\\r (D:\\\\devWorkspace\\\\...\\\\saved_document.docx)', 'wdmain11.chm', 24601, -2146823167), None)"
        },
        "execution_time": 0.061341285705566406,
        "is_functional_test": true
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时是否能优雅地处理错误。",
        "args": {
          "password": "password123"
        },
        "response": {
          "error": "ToolException: Error executing tool protect_document: 1 validation error for protect_documentArguments\ndocument_id\n  Field required [type=missing, input_value={'password': 'password123'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.004072427749633789,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Password",
        "purpose": "验证未提供 password 参数时是否能优雅地处理错误。",
        "args": {
          "document_id": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\saved_document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool protect_document: 1 validation error for protect_documentArguments\npassword\n  Field required [type=missing, input_value={'document_id': 'D:\\\\devW...s\\\\saved_document.docx'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.0039997100830078125,
        "is_functional_test": false
      },
      {
        "case_name": "Security - Special Characters in Password",
        "purpose": "验证密码中包含特殊字符时是否能安全处理。",
        "args": {
          "document_id": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\saved_document.docx",
          "password": "!@#$%^&*()_+=-`~[]{}|;:,.<>?\"'\\/"
        },
        "response": {
          "error": "ToolException: Error executing tool protect_document: Failed to protect document: (-2147352567, '发生意外。', (0, 'Microsoft Word', 'Word 在试图打开文件时遇到错误。\\n请尝试下列方法:\\n* 检查文档或驱动器的文件权限。\\n* 确保有足够的内存和磁盘空间。\\n* 用文本恢复转换器打开文件。\\r (D:\\\\devWorkspace\\\\...\\\\saved_document.docx)', 'wdmain11.chm', 24601, -2146823167), None)"
        },
        "execution_time": 0.05660533905029297,
        "is_functional_test": true
      },
      {
        "case_name": "Boundary Condition - Empty Document ID",
        "purpose": "验证使用空字符串作为文档ID时是否能正确处理错误。",
        "args": {
          "document_id": "",
          "password": "password123"
        },
        "response": {
          "error": "ToolException: Error executing tool protect_document: Failed to protect document: 'NoneType' object has no attribute 'SaveAs'"
        },
        "execution_time": 0.011224985122680664,
        "is_functional_test": false
      }
    ],
    "convert_to_pdf": [
      {
        "case_name": "Basic PDF Conversion",
        "purpose": "验证使用有效文档路径进行基本PDF转换功能是否正常工作。",
        "args": {
          "document_id": "workspace/Test Document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool convert_to_pdf: Failed to convert to PDF: (-2147352567, '发生意外。', (0, 'Microsoft Word', '很抱歉，找不到您的文件。该项目是否已移动、重命名或删除?\\r (\"C:\\\\Users\\\\PS\\\\...\\\\Test Document.docx\")', 'wdmain11.chm', 24654, -2146823114), None)"
        },
        "execution_time": 0.015058279037475586,
        "is_functional_test": true
      },
      {
        "case_name": "Convert Document With Author Metadata",
        "purpose": "验证包含作者信息的文档能否正确转换为PDF格式。",
        "args": {
          "document_id": "workspace/Report Document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool convert_to_pdf: Failed to convert to PDF: (-2147352567, '发生意外。', (0, 'Microsoft Word', '很抱歉，找不到您的文件。该项目是否已移动、重命名或删除?\\r (\"C:\\\\Users\\\\PS\\\\...\\\\Report Document.docx\")', 'wdmain11.chm', 24654, -2146823114), None)"
        },
        "execution_time": 0.014035224914550781,
        "is_functional_test": true
      },
      {
        "case_name": "Convert Document With Keywords",
        "purpose": "验证包含关键词的文档能否正确转换为PDF格式。",
        "args": {
          "document_id": "workspace/Keyword Test Doc.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool convert_to_pdf: Failed to convert to PDF: (-2147352567, '发生意外。', (0, 'Microsoft Word', '很抱歉，找不到您的文件。该项目是否已移动、重命名或删除?\\r (\"C:\\\\Users\\\\PS\\\\...\\\\Keyword Test Doc.docx\")', 'wdmain11.chm', 24654, -2146823114), None)"
        },
        "execution_time": 0.01385045051574707,
        "is_functional_test": true
      },
      {
        "case_name": "Convert Document With All Metadata",
        "purpose": "验证包含完整元数据（标题、作者、关键词）的文档能否正确转换为PDF格式。",
        "args": {
          "document_id": "workspace/Full Metadata Document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool convert_to_pdf: Failed to convert to PDF: (-2147352567, '发生意外。', (0, 'Microsoft Word', '很抱歉，找不到您的文件。该项目是否已移动、重命名或删除?\\r (\"C:\\\\...\\\\Full Metadata Document.docx\")', 'wdmain11.chm', 24654, -2146823114), None)"
        },
        "execution_time": 0.012837886810302734,
        "is_functional_test": true
      },
      {
        "case_name": "Convert Empty Keywords Document",
        "purpose": "验证空关键词列表的文档能否成功转换为PDF格式。",
        "args": {
          "document_id": "workspace/Empty Keywords Document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool convert_to_pdf: Failed to convert to PDF: (-2147352567, '发生意外。', (0, 'Microsoft Word', '很抱歉，找不到您的文件。该项目是否已移动、重命名或删除?\\r (\"C:\\\\...\\\\Empty Keywords Document.docx\")', 'wdmain11.chm', 24654, -2146823114), None)"
        },
        "execution_time": 0.013431072235107422,
        "is_functional_test": true
      },
      {
        "case_name": "Security - Special Characters in Document Path",
        "purpose": "验证工具是否安全处理包含特殊字符的文档路径，防止注入攻击。",
        "args": {
          "document_id": "workspace/<script>alert('xss')</script>.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool convert_to_pdf: Failed to convert to PDF: 'NoneType' object has no attribute 'SaveAs'"
        },
        "execution_time": 0.012559890747070312,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Missing Document ID",
        "purpose": "验证未提供 document_id 参数时是否能优雅地处理错误。",
        "args": {},
        "response": {
          "error": "ToolException: Error executing tool convert_to_pdf: 1 validation error for convert_to_pdfArguments\ndocument_id\n  Field required [type=missing, input_value={}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.0050237178802490234,
        "is_functional_test": false
      },
      {
        "case_name": "Boundary Condition - Long File Name",
        "purpose": "验证长文件名的文档能否成功转换为PDF格式。",
        "args": {
          "document_id": "workspace/large_document_save_attempt.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool convert_to_pdf: Failed to convert to PDF: (-2147352567, '发生意外。', (0, 'Microsoft Word', '很抱歉，找不到您的文件。该项目是否已移动、重命名或删除?\\r (C:\\\\...\\\\large_document_save_attempt.docx)', 'wdmain11.chm', 24654, -2146823114), None)"
        },
        "execution_time": 0.01212167739868164,
        "is_functional_test": true
      }
    ]
  },
  "total_cases": 115
}