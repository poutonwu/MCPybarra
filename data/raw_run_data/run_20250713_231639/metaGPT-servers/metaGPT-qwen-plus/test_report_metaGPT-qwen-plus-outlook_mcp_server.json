{
  "server_name": "outlook_mcp_server",
  "parent_dir": "metaGPT-qwen-plus",
  "report_name": "metaGPT-qwen-plus-outlook_mcp_server",
  "server_path": "workspace\\metaGPT-servers\\metaGPT-qwen-plus\\outlook_mcp_server.py",
  "timestamp": "2025-07-13T23:18:10.034924",
  "tools": [
    {
      "name": "list_folders",
      "description": "\n    列出所有可用的Outlook邮件文件夹。\n\n    Returns:\n        包含文件夹名称和路径的字典列表。\n    ",
      "args_schema": {
        "properties": {},
        "title": "list_foldersArguments",
        "type": "object"
      }
    },
    {
      "name": "list_recent_emails",
      "description": "\n    获取指定天数内最近的邮件标题列表。\n\n    Args:\n        days: 需要检索的过去天数，默认为7天。\n        folder_name: 指定的邮件文件夹名称，如果为空则使用默认收件箱。\n\n    Returns:\n        包含邮件主题、发件人和接收时间的字典列表。\n    ",
      "args_schema": {
        "properties": {
          "days": {
            "default": 7,
            "title": "Days",
            "type": "integer"
          },
          "folder_name": {
            "default": null,
            "title": "Folder Name",
            "type": "string"
          }
        },
        "title": "list_recent_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_emails",
      "description": "\n    在指定时间段和文件夹内按联系人或关键词搜索邮件。\n\n    Args:\n        query: 搜索查询字符串，可以是联系人或关键词。\n        folder_name: 指定的邮件文件夹名称，如果为空则使用默认收件箱。\n        start_date: 搜索的起始日期（格式：YYYY-MM-DD HH:MM）。\n        end_date: 搜索的结束日期（格式：YYYY-MM-DD HH:MM）。\n\n    Returns:\n        包含匹配邮件主题、发件人和接收时间的字典列表。\n    ",
      "args_schema": {
        "properties": {
          "query": {
            "title": "Query",
            "type": "string"
          },
          "folder_name": {
            "default": null,
            "title": "Folder Name",
            "type": "string"
          },
          "start_date": {
            "default": null,
            "title": "Start Date",
            "type": "string"
          },
          "end_date": {
            "default": null,
            "title": "End Date",
            "type": "string"
          }
        },
        "required": [
          "query"
        ],
        "title": "search_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_email_by_number",
      "description": "\n    获取指定编号的邮件详细信息。\n\n    Args:\n        email_id: 邮件的唯一标识符。\n\n    Returns:\n        包含邮件正文和附件信息的字典。\n    ",
      "args_schema": {
        "properties": {
          "email_id": {
            "title": "Email Id",
            "type": "integer"
          }
        },
        "required": [
          "email_id"
        ],
        "title": "get_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "reply_to_email_by_number",
      "description": "\n    对指定编号的邮件进行回复。\n\n    Args:\n        email_id: 邮件的唯一标识符。\n        reply_text: 回复邮件的内容。\n\n    Returns:\n        包含回复结果的状态消息。\n    ",
      "args_schema": {
        "properties": {
          "email_id": {
            "title": "Email Id",
            "type": "integer"
          },
          "reply_text": {
            "title": "Reply Text",
            "type": "string"
          }
        },
        "required": [
          "email_id",
          "reply_text"
        ],
        "title": "reply_to_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "compose_email",
      "description": "\n    新建并发送一封新邮件。\n\n    Args:\n        subject: 邮件的主题。\n        body: 邮件正文内容。\n        to: 收件人邮箱地址。\n        cc: 抄送邮箱地址（可选）。\n\n    Returns:\n        包含发送结果的状态消息。\n    ",
      "args_schema": {
        "properties": {
          "subject": {
            "title": "Subject",
            "type": "string"
          },
          "body": {
            "title": "Body",
            "type": "string"
          },
          "to": {
            "title": "To",
            "type": "string"
          },
          "cc": {
            "default": null,
            "title": "Cc",
            "type": "string"
          }
        },
        "required": [
          "subject",
          "body",
          "to"
        ],
        "title": "compose_emailArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "list_folders": [
      {
        "case_name": "列出所有Outlook邮件文件夹的基本功能测试",
        "purpose": "验证list_folders工具在无参数情况下能够正确列出Outlook中所有可用的邮件文件夹。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.014999866485595703,
        "is_functional_test": true
      },
      {
        "case_name": "尝试使用特殊字符路径进行安全访问测试",
        "purpose": "验证工具是否允许访问包含特殊字符的隐藏目录，防止潜在路径遍历攻击或非法访问。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.014998674392700195,
        "is_functional_test": false
      },
      {
        "case_name": "在无Outlook会话时调用list_folders的错误处理测试",
        "purpose": "验证当Outlook未运行或无法建立连接时，list_folders能否优雅地返回错误信息而非崩溃。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.014998912811279297,
        "is_functional_test": false
      },
      {
        "case_name": "在权限受限环境下调用list_folders的边界测试",
        "purpose": "验证当用户对Outlook数据访问权限受限时，工具是否能正确捕获异常并提示权限不足。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.019008636474609375,
        "is_functional_test": false
      },
      {
        "case_name": "测试Outlook配置文件为空时的行为",
        "purpose": "验证当Outlook没有配置任何账户或配置文件为空时，list_folders是否能正确返回空列表或适当提示。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.01898193359375,
        "is_functional_test": true
      },
      {
        "case_name": "测试含有非ASCII字符的文件夹名处理",
        "purpose": "验证list_folders是否能正确处理和返回包含非ASCII字符（如中文、日文等）的文件夹名称。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.016999244689941406,
        "is_functional_test": true
      },
      {
        "case_name": "测试工具在系统资源不足时的行为",
        "purpose": "模拟内存或CPU资源紧张的情况下，验证list_folders是否能稳定执行或至少不导致服务崩溃。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.020001888275146484,
        "is_functional_test": false
      },
      {
        "case_name": "测试工具在长时间无响应下的容错能力",
        "purpose": "验证当Outlook响应缓慢或挂起时，list_folders是否会超时处理并给出友好提示而不是无限等待。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.020002126693725586,
        "is_functional_test": false
      }
    ],
    "list_recent_emails": [
      {
        "case_name": "获取默认7天内收件箱邮件的基本功能测试",
        "purpose": "验证list_recent_emails工具在无参数情况下能正确获取最近7天内默认收件箱的邮件标题列表。",
        "args": {},
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.01700282096862793,
        "is_functional_test": true
      },
      {
        "case_name": "指定文件夹和30天范围获取邮件的功能测试",
        "purpose": "验证list_recent_emails工具在指定文件夹和30天范围内能否正确获取邮件信息。",
        "args": {
          "days": 30,
          "folder_name": "outformcptest@outlook.com"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.020000219345092773,
        "is_functional_test": true
      },
      {
        "case_name": "尝试访问包含特殊字符的隐藏文件夹的安全性测试",
        "purpose": "验证list_recent_emails是否允许访问包含特殊字符的隐藏目录，防止潜在路径遍历攻击或非法访问。",
        "args": {
          "folder_name": "..\\..\\.hidden_test_file.txt"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.01299905776977539,
        "is_functional_test": false
      },
      {
        "case_name": "无效文件夹名称时的错误处理测试",
        "purpose": "验证当提供一个不存在的文件夹名称时，工具是否能够优雅地返回错误信息而不是崩溃。",
        "args": {
          "folder_name": "invalid_folder"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.021001338958740234,
        "is_functional_test": false
      },
      {
        "case_name": "设置为0天时的边界条件测试",
        "purpose": "验证list_recent_emails工具在days参数设为0时的行为，确保其不会出现异常或逻辑错误。",
        "args": {
          "days": 0
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.009985685348510742,
        "is_functional_test": false
      },
      {
        "case_name": "负数天数输入时的边界测试",
        "purpose": "验证list_recent_emails工具在days参数为负值时是否能正确提示错误或忽略该值并使用默认值。",
        "args": {
          "days": -5
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.012517452239990234,
        "is_functional_test": false
      },
      {
        "case_name": "Outlook未运行时调用工具的错误处理测试",
        "purpose": "验证当Outlook未运行或无法建立连接时，list_recent_emails能否优雅地返回错误信息而非崩溃。",
        "args": {
          "days": 14
        },
        "response": {
          "result": "{\n  \"emails\": [\n    {\n      \"id\": 35,\n      \"subject\": \"Please sign in to your Outlook.com account\",\n      \"sender\": \"Outlook.com Team\",\n      \"received_time\": \"2025-06-30 17:04\"\n    }\n  ]\n}"
        },
        "execution_time": 16.796480894088745,
        "is_functional_test": false
      },
      {
        "case_name": "测试非ASCII字符文件夹名的邮件获取能力",
        "purpose": "验证list_recent_emails是否能正确处理和返回包含非ASCII字符（如中文、日文等）的文件夹中的邮件列表。",
        "args": {
          "folder_name": "测试文件夹_中文"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.02654576301574707,
        "is_functional_test": true
      }
    ],
    "search_emails": [
      {
        "case_name": "使用关键词搜索默认收件箱邮件的基本功能测试",
        "purpose": "验证search_emails工具在仅提供必要查询参数的情况下，能否正确在默认收件箱中按关键词搜索邮件。",
        "args": {
          "query": "meeting"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.014005899429321289,
        "is_functional_test": true
      },
      {
        "case_name": "指定文件夹和关键词搜索邮件的功能测试",
        "purpose": "验证search_emails工具在指定文件夹和关键词情况下能否正确搜索并返回匹配的邮件信息。",
        "args": {
          "query": "invoice",
          "folder_name": "outformcptest@outlook.com"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.016999244689941406,
        "is_functional_test": true
      },
      {
        "case_name": "使用时间段和关键词组合搜索邮件的功能测试",
        "purpose": "验证search_emails工具在提供起止时间范围和关键词时，是否能正确筛选出符合条件的邮件。",
        "args": {
          "query": "report",
          "start_date": "2025-06-01 00:00",
          "end_date": "2025-06-30 23:59"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.009089469909667969,
        "is_functional_test": true
      },
      {
        "case_name": "完整参数组合搜索邮件的功能测试",
        "purpose": "验证search_emails工具在提供全部参数（查询词、文件夹、起始与结束时间）时能否正确执行复杂搜索。",
        "args": {
          "query": "confirmation",
          "folder_name": "zhihutangjiang@126.com",
          "start_date": "2025-06-15 08:00",
          "end_date": "2025-06-20 18:00"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.012996912002563477,
        "is_functional_test": true
      },
      {
        "case_name": "尝试访问隐藏目录的安全性测试",
        "purpose": "验证search_emails是否允许访问包含特殊字符或路径遍历符号的非法文件夹路径，防止潜在路径遍历攻击。",
        "args": {
          "query": "test",
          "folder_name": "..\\..\\.hidden_test_file.txt"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.015998363494873047,
        "is_functional_test": false
      },
      {
        "case_name": "无效文件夹名称时的错误处理测试",
        "purpose": "验证当提供一个不存在的文件夹名称时，search_emails是否能够优雅地返回错误信息而不是崩溃。",
        "args": {
          "query": "document",
          "folder_name": "invalid_folder"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.014994144439697266,
        "is_functional_test": false
      },
      {
        "case_name": "无效日期格式输入时的错误处理测试",
        "purpose": "验证search_emails在用户提供不合法日期格式时是否能正确提示错误或忽略该参数。",
        "args": {
          "query": "summary",
          "start_date": "2025/06/15",
          "end_date": "2025-06-20 18:00"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.011529684066772461,
        "is_functional_test": false
      },
      {
        "case_name": "空查询字符串的边界条件测试",
        "purpose": "验证search_emails在查询字符串为空时的行为，确保其不会出现异常或逻辑错误。",
        "args": {
          "query": ""
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.008998870849609375,
        "is_functional_test": false
      }
    ],
    "get_email_by_number": [
      {
        "case_name": "获取有效邮件编号的基本功能测试",
        "purpose": "验证get_email_by_number工具在提供有效的邮件编号时，能否正确返回该邮件的正文和附件信息。",
        "args": {
          "email_id": 35
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.004999399185180664,
        "is_functional_test": true
      },
      {
        "case_name": "尝试访问非法或特殊字符路径的安全性测试",
        "purpose": "验证get_email_by_number工具是否允许通过特殊构造的邮件ID访问系统隐藏资源或执行潜在危险操作，防止安全漏洞。",
        "args": {
          "email_id": -1
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: -1"
        },
        "execution_time": 0.0030002593994140625,
        "is_functional_test": false
      },
      {
        "case_name": "输入不存在的邮件编号的错误处理测试",
        "purpose": "验证当提供的邮件编号不存在时，get_email_by_number是否能优雅地返回错误信息而不是崩溃。",
        "args": {
          "email_id": 999999
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 999999"
        },
        "execution_time": 0.007002592086791992,
        "is_functional_test": false
      },
      {
        "case_name": "邮件编号为0的边界条件测试",
        "purpose": "验证get_email_by_number工具在邮件编号为0时的行为，确保其不会出现异常或逻辑错误。",
        "args": {
          "email_id": 0
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 0"
        },
        "execution_time": 0.005000591278076172,
        "is_functional_test": false
      },
      {
        "case_name": "邮件编号为负数的边界测试",
        "purpose": "验证get_email_by_number工具在邮件编号为负值时是否能正确提示错误或忽略该值并返回适当的信息。",
        "args": {
          "email_id": -5
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: -5"
        },
        "execution_time": 0.0029997825622558594,
        "is_functional_test": false
      },
      {
        "case_name": "Outlook未运行时调用工具的错误处理测试",
        "purpose": "验证当Outlook未运行或无法建立连接时，get_email_by_number能否优雅地返回错误信息而非崩溃。",
        "args": {
          "email_id": 1
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 1"
        },
        "execution_time": 0.003999948501586914,
        "is_functional_test": false
      },
      {
        "case_name": "权限受限环境下调用get_email_by_number的边界测试",
        "purpose": "验证当用户对Outlook数据访问权限受限时，工具是否能正确捕获异常并提示权限不足。",
        "args": {
          "email_id": 1
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 1"
        },
        "execution_time": 0.007998943328857422,
        "is_functional_test": false
      },
      {
        "case_name": "获取最大允许邮件编号的边界测试",
        "purpose": "验证get_email_by_number在邮件编号达到系统最大整数值时是否仍能正确处理请求。",
        "args": {
          "email_id": 2147483647
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 2147483647"
        },
        "execution_time": 0.0040013790130615234,
        "is_functional_test": false
      }
    ],
    "reply_to_email_by_number": [
      {
        "case_name": "回复指定邮件ID的基本功能测试",
        "purpose": "验证reply_to_email_by_number工具在提供有效邮件ID和回复内容时能否正确执行邮件回复操作。",
        "args": {
          "email_id": 35,
          "reply_text": "这是对编号为35的邮件的标准回复。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.003999948501586914,
        "is_functional_test": true
      },
      {
        "case_name": "使用空字符串作为回复内容的安全性测试",
        "purpose": "验证当reply_text参数为空字符串时，工具是否仍能安全处理并完成邮件回复，防止潜在注入攻击或异常行为。",
        "args": {
          "email_id": 35,
          "reply_text": ""
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.004002571105957031,
        "is_functional_test": false
      },
      {
        "case_name": "无效邮件ID的错误处理测试",
        "purpose": "验证当提供一个不存在的邮件ID（如负数或极大值）时，工具是否能够优雅地返回错误信息而不是崩溃。",
        "args": {
          "email_id": -1,
          "reply_text": "这是一条尝试回复不存在邮件ID的测试内容。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: -1"
        },
        "execution_time": 0.003999948501586914,
        "is_functional_test": false
      },
      {
        "case_name": "邮件ID为零的边界条件测试",
        "purpose": "验证当邮件ID设置为0时，工具是否能正确识别并拒绝该请求，避免非法访问。",
        "args": {
          "email_id": 0,
          "reply_text": "这是一条测试邮件回复内容。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 0"
        },
        "execution_time": 0.003999948501586914,
        "is_functional_test": false
      },
      {
        "case_name": "包含特殊字符的回复文本处理测试",
        "purpose": "验证工具是否能正确处理包含特殊字符（如@、#、&等）的回复内容，确保不会导致解析错误或注入漏洞。",
        "args": {
          "email_id": 35,
          "reply_text": "这是一个包含特殊字符的回复：test@example.com & 测试内容！"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.006517171859741211,
        "is_functional_test": true
      },
      {
        "case_name": "Outlook未运行时调用工具的错误处理测试",
        "purpose": "验证当Outlook未运行或无法建立连接时，reply_to_email_by_number能否优雅地返回错误信息而非崩溃。",
        "args": {
          "email_id": 35,
          "reply_text": "这是用于测试Outlook未运行时的回复内容。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.0030024051666259766,
        "is_functional_test": false
      },
      {
        "case_name": "非ASCII字符回复内容的功能测试",
        "purpose": "验证reply_to_email_by_number是否能正确处理和发送包含非ASCII字符（如中文、日文等）的回复内容。",
        "args": {
          "email_id": 35,
          "reply_text": "这是一封用中文编写的回复邮件内容。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.004997968673706055,
        "is_functional_test": true
      }
    ],
    "compose_email": [
      {
        "case_name": "发送基础邮件的基本功能测试",
        "purpose": "验证compose_email工具在提供所有必填参数的情况下是否能够成功创建并发送一封普通邮件。",
        "args": {
          "subject": "Test Email Subject",
          "body": "This is the body of the test email.",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.006000041961669922,
        "is_functional_test": true
      },
      {
        "case_name": "包含抄送地址的邮件发送功能测试",
        "purpose": "验证compose_email工具在提供cc参数时是否能够正确将邮件抄送给指定收件人。",
        "args": {
          "subject": "Email with CC",
          "body": "This is a test email with a CC recipient.",
          "to": "main_recipient@example.com",
          "cc": "cc_recipient@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.012553691864013672,
        "is_functional_test": true
      },
      {
        "case_name": "缺少必填参数的主题字段错误处理测试",
        "purpose": "验证当不提供subject参数时，compose_email是否能优雅地返回错误信息而不是崩溃。",
        "args": {
          "body": "This email is missing the subject field.",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: 1 validation error for compose_emailArguments\nsubject\n  Field required [type=missing, input_value={'body': 'This email is m...to': 'test@example.com'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.003997087478637695,
        "is_functional_test": false
      },
      {
        "case_name": "缺少必填参数的收件人字段错误处理测试",
        "purpose": "验证当不提供to参数时，compose_email是否能正确提示收件人缺失并拒绝发送邮件。",
        "args": {
          "subject": "Missing To Field Test",
          "body": "This email is missing the 'to' field."
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: 1 validation error for compose_emailArguments\nto\n  Field required [type=missing, input_value={'subject': 'Missing To F...issing the 'to' field.\"}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.0040013790130615234,
        "is_functional_test": false
      },
      {
        "case_name": "使用特殊字符主题和正文的安全性测试",
        "purpose": "验证compose_email是否能安全处理包含特殊字符的邮件主题和正文内容，防止注入攻击或格式破坏。",
        "args": {
          "subject": "Subject with special chars: <script>alert(1)</script>",
          "body": "Body with special chars: &lt;div&gt;Testing&lt;/div&gt;",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.007999658584594727,
        "is_functional_test": false
      },
      {
        "case_name": "尝试发送空邮件正文的边界条件测试",
        "purpose": "验证compose_email在body为空字符串时是否仍能正常发送邮件（允许空正文）。",
        "args": {
          "subject": "Empty Body Test",
          "body": "",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.005506992340087891,
        "is_functional_test": true
      },
      {
        "case_name": "发送至无效邮箱地址的错误处理测试",
        "purpose": "验证compose_email在提供格式错误或不存在的邮箱地址时是否能正确捕获错误并提示用户。",
        "args": {
          "subject": "Invalid Email Test",
          "body": "Attempting to send to an invalid email address.",
          "to": "invalid-email@domain"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.0074999332427978516,
        "is_functional_test": false
      }
    ]
  },
  "total_cases": 46
}