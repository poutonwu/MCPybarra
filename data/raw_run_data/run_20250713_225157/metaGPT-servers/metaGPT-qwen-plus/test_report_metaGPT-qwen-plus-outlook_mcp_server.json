{
  "server_name": "outlook_mcp_server",
  "parent_dir": "metaGPT-qwen-plus",
  "report_name": "metaGPT-qwen-plus-outlook_mcp_server",
  "server_path": "workspace\\metaGPT-servers\\metaGPT-qwen-plus\\outlook_mcp_server.py",
  "timestamp": "2025-07-13T22:53:29.034502",
  "tools": [
    {
      "name": "list_folders",
      "description": "\n    列出所有可用的Outlook邮件文件夹。\n\n    Returns:\n        包含文件夹名称和路径的字典列表。\n    ",
      "args_schema": {
        "properties": {},
        "title": "list_foldersArguments",
        "type": "object"
      }
    },
    {
      "name": "list_recent_emails",
      "description": "\n    获取指定天数内最近的邮件标题列表。\n\n    Args:\n        days: 需要检索的过去天数，默认为7天。\n        folder_name: 指定的邮件文件夹名称，如果为空则使用默认收件箱。\n\n    Returns:\n        包含邮件主题、发件人和接收时间的字典列表。\n    ",
      "args_schema": {
        "properties": {
          "days": {
            "default": 7,
            "title": "Days",
            "type": "integer"
          },
          "folder_name": {
            "default": null,
            "title": "Folder Name",
            "type": "string"
          }
        },
        "title": "list_recent_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_emails",
      "description": "\n    在指定时间段和文件夹内按联系人或关键词搜索邮件。\n\n    Args:\n        query: 搜索查询字符串，可以是联系人或关键词。\n        folder_name: 指定的邮件文件夹名称，如果为空则使用默认收件箱。\n        start_date: 搜索的起始日期（格式：YYYY-MM-DD HH:MM）。\n        end_date: 搜索的结束日期（格式：YYYY-MM-DD HH:MM）。\n\n    Returns:\n        包含匹配邮件主题、发件人和接收时间的字典列表。\n    ",
      "args_schema": {
        "properties": {
          "query": {
            "title": "Query",
            "type": "string"
          },
          "folder_name": {
            "default": null,
            "title": "Folder Name",
            "type": "string"
          },
          "start_date": {
            "default": null,
            "title": "Start Date",
            "type": "string"
          },
          "end_date": {
            "default": null,
            "title": "End Date",
            "type": "string"
          }
        },
        "required": [
          "query"
        ],
        "title": "search_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_email_by_number",
      "description": "\n    获取指定编号的邮件详细信息。\n\n    Args:\n        email_id: 邮件的唯一标识符。\n\n    Returns:\n        包含邮件正文和附件信息的字典。\n    ",
      "args_schema": {
        "properties": {
          "email_id": {
            "title": "Email Id",
            "type": "integer"
          }
        },
        "required": [
          "email_id"
        ],
        "title": "get_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "reply_to_email_by_number",
      "description": "\n    对指定编号的邮件进行回复。\n\n    Args:\n        email_id: 邮件的唯一标识符。\n        reply_text: 回复邮件的内容。\n\n    Returns:\n        包含回复结果的状态消息。\n    ",
      "args_schema": {
        "properties": {
          "email_id": {
            "title": "Email Id",
            "type": "integer"
          },
          "reply_text": {
            "title": "Reply Text",
            "type": "string"
          }
        },
        "required": [
          "email_id",
          "reply_text"
        ],
        "title": "reply_to_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "compose_email",
      "description": "\n    新建并发送一封新邮件。\n\n    Args:\n        subject: 邮件的主题。\n        body: 邮件正文内容。\n        to: 收件人邮箱地址。\n        cc: 抄送邮箱地址（可选）。\n\n    Returns:\n        包含发送结果的状态消息。\n    ",
      "args_schema": {
        "properties": {
          "subject": {
            "title": "Subject",
            "type": "string"
          },
          "body": {
            "title": "Body",
            "type": "string"
          },
          "to": {
            "title": "To",
            "type": "string"
          },
          "cc": {
            "default": null,
            "title": "Cc",
            "type": "string"
          }
        },
        "required": [
          "subject",
          "body",
          "to"
        ],
        "title": "compose_emailArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "list_folders": [
      {
        "case_name": "列出所有可用Outlook文件夹",
        "purpose": "验证list_folders工具可以正确列出所有可用的Outlook邮件文件夹，且返回格式为包含名称和路径的字典列表。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.013406038284301758,
        "is_functional_test": true
      },
      {
        "case_name": "无参数调用功能验证",
        "purpose": "确认在不提供任何参数的情况下，工具能够正常执行并返回默认结果（如空列表或默认结构）。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.017525911331176758,
        "is_functional_test": true
      },
      {
        "case_name": "测试Outlook未连接时的行为",
        "purpose": "验证当Outlook未连接或无法访问时，工具是否能优雅处理错误并返回有意义的错误信息。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.03522849082946777,
        "is_functional_test": false
      },
      {
        "case_name": "权限不足时的错误处理",
        "purpose": "模拟用户对Outlook数据访问权限受限的情况，验证工具能否捕获异常并返回清晰的错误提示。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.021985292434692383,
        "is_functional_test": false
      },
      {
        "case_name": "测试Outlook账户为空的情况",
        "purpose": "验证当Outlook账户中没有任何文件夹时，工具是否能安全返回空列表而不抛出异常。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.01801013946533203,
        "is_functional_test": true
      },
      {
        "case_name": "特殊字符文件夹名处理",
        "purpose": "验证工具是否能正确处理包含特殊字符（如中文、空格、符号）的Outlook文件夹名称。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.016093015670776367,
        "is_functional_test": true
      },
      {
        "case_name": "长时间运行后稳定性测试",
        "purpose": "评估工具在系统长时间运行后仍能稳定列出Outlook文件夹的能力。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.013633489608764648,
        "is_functional_test": true
      },
      {
        "case_name": "资源占用边界测试",
        "purpose": "验证当Outlook中存在大量文件夹时，工具是否仍能有效执行而不会导致内存溢出或性能严重下降。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.014998912811279297,
        "is_functional_test": true
      }
    ],
    "list_recent_emails": [
      {
        "case_name": "默认参数获取最近7天邮件",
        "purpose": "验证在不提供任何参数的情况下，工具能够使用默认参数（7天、默认收件箱）成功获取最近邮件列表。",
        "args": {},
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.01152181625366211,
        "is_functional_test": true
      },
      {
        "case_name": "指定天数获取邮件",
        "purpose": "验证工具可以正确处理指定天数参数，返回该天数内邮件主题、发件人和接收时间。",
        "args": {
          "days": 3
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.010015487670898438,
        "is_functional_test": true
      },
      {
        "case_name": "指定文件夹获取邮件",
        "purpose": "验证工具能够正确访问指定邮件文件夹，并返回该文件夹中最近7天的邮件列表。",
        "args": {
          "folder_name": "\\outformcptest@outlook.com\\Inbox"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.01809215545654297,
        "is_functional_test": true
      },
      {
        "case_name": "同时指定天数和文件夹",
        "purpose": "验证工具在同时提供天数和文件夹参数时，能够正确过滤指定天数并在指定文件夹中返回邮件列表。",
        "args": {
          "days": 5,
          "folder_name": "\\zhihutangjiang@126.com\\工作邮件"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.01998305320739746,
        "is_functional_test": true
      },
      {
        "case_name": "文件夹名称包含特殊字符",
        "purpose": "验证工具是否能正确处理包含特殊字符（如空格、中文、符号）的文件夹名称。",
        "args": {
          "folder_name": "\\1291980381@qq.com\\测试 邮件#2024"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.02310323715209961,
        "is_functional_test": true
      },
      {
        "case_name": "权限不足时的错误处理",
        "purpose": "模拟用户对Outlook文件夹访问权限受限的情况，验证工具能否捕获异常并返回清晰的错误提示。",
        "args": {
          "folder_name": "\\outformcptest@outlook.com\\敏感数据"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.019244670867919922,
        "is_functional_test": false
      },
      {
        "case_name": "无效文件夹名称处理",
        "purpose": "验证工具在指定不存在或无效的文件夹名称时，是否能返回错误信息而不是抛出异常。",
        "args": {
          "folder_name": "\\invalid_email@example.com\\Inbox"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.017771482467651367,
        "is_functional_test": false
      },
      {
        "case_name": "极端天数参数测试",
        "purpose": "验证工具在输入极大或极小天数参数时的行为是否符合预期（如0天、1000天）。",
        "args": {
          "days": 0
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.01803421974182129,
        "is_functional_test": false
      }
    ],
    "search_emails": [
      {
        "case_name": "使用默认参数搜索邮件",
        "purpose": "验证在不提供任何可选参数的情况下，工具能够默认在收件箱中搜索所有匹配邮件。",
        "args": {
          "query": "test"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.007000923156738281,
        "is_functional_test": true
      },
      {
        "case_name": "指定文件夹搜索邮件",
        "purpose": "验证工具可以正确在指定的邮件文件夹中搜索匹配邮件。",
        "args": {
          "query": "report",
          "folder_name": "\\outformcptest@outlook.com\\Inbox"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.01600050926208496,
        "is_functional_test": true
      },
      {
        "case_name": "按时间范围搜索邮件",
        "purpose": "验证工具可以在指定的时间范围内搜索邮件。",
        "args": {
          "query": "meeting",
          "start_date": "2024-01-01 08:00",
          "end_date": "2024-01-31 18:00"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.015005111694335938,
        "is_functional_test": true
      },
      {
        "case_name": "同时使用关键词和时间段搜索",
        "purpose": "验证工具能够在指定时间段内根据关键词进行搜索。",
        "args": {
          "query": "invoice",
          "start_date": "2024-02-01 09:00",
          "end_date": "2024-02-28 17:00"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.023884057998657227,
        "is_functional_test": true
      },
      {
        "case_name": "特殊字符关键词搜索",
        "purpose": "验证工具是否能处理包含特殊字符的查询字符串。",
        "args": {
          "query": "#urgent!mail"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.012799739837646484,
        "is_functional_test": true
      },
      {
        "case_name": "无效文件夹名称处理",
        "purpose": "验证工具在指定不存在或无效的文件夹名称时是否能返回错误信息而不是抛出异常。",
        "args": {
          "query": "project",
          "folder_name": "\\invalid_email@example.com\\Inbox"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.014004230499267578,
        "is_functional_test": false
      },
      {
        "case_name": "权限不足时的错误处理",
        "purpose": "模拟用户对Outlook文件夹访问权限受限的情况，验证工具能否捕获异常并返回清晰的错误提示。",
        "args": {
          "query": "confidential",
          "folder_name": "\\outformcptest@outlook.com\\敏感数据"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.019998788833618164,
        "is_functional_test": false
      },
      {
        "case_name": "极端日期边界测试",
        "purpose": "验证工具在输入极早或极晚的日期时是否仍能正常处理。",
        "args": {
          "query": "old mail",
          "start_date": "1900-01-01 00:00",
          "end_date": "2100-12-31 23:59"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.008002281188964844,
        "is_functional_test": true
      }
    ],
    "get_email_by_number": [
      {
        "case_name": "获取有效邮件ID的基本功能测试",
        "purpose": "验证工具可以使用有效的邮件ID成功获取邮件详细信息，包括正文和附件。",
        "args": {
          "email_id": 1001
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 1001"
        },
        "execution_time": 0.0035064220428466797,
        "is_functional_test": true
      },
      {
        "case_name": "获取另一个有效邮件ID的附件信息",
        "purpose": "验证工具能够正确返回包含附件信息的邮件内容。",
        "args": {
          "email_id": 1002
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 1002"
        },
        "execution_time": 0.005002737045288086,
        "is_functional_test": true
      },
      {
        "case_name": "尝试获取不存在的邮件ID信息",
        "purpose": "验证工具在指定一个不存在的邮件ID时是否能优雅地处理错误并返回清晰提示。",
        "args": {
          "email_id": 9999
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 9999"
        },
        "execution_time": 0.009008407592773438,
        "is_functional_test": false
      },
      {
        "case_name": "邮件ID为负数的边界测试",
        "purpose": "验证工具在输入负值作为邮件ID时是否能正确拒绝请求并返回错误信息。",
        "args": {
          "email_id": -1
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: -1"
        },
        "execution_time": 0.00699162483215332,
        "is_functional_test": false
      },
      {
        "case_name": "邮件ID为零的边界测试",
        "purpose": "验证工具在输入0作为邮件ID时的行为是否符合预期（应返回错误）。",
        "args": {
          "email_id": 0
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 0"
        },
        "execution_time": 0.003999948501586914,
        "is_functional_test": false
      },
      {
        "case_name": "邮件ID为极大数值的边界测试",
        "purpose": "验证工具在输入极大数值（如1,000,000）作为邮件ID时是否能正确处理而不崩溃。",
        "args": {
          "email_id": 1000000
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 1000000"
        },
        "execution_time": 0.005998849868774414,
        "is_functional_test": false
      },
      {
        "case_name": "SQL注入攻击模拟测试",
        "purpose": "验证工具能否安全地拒绝包含潜在SQL注入风险的邮件ID输入。",
        "args": {
          "email_id": "1001 OR 1=1"
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 1 validation error for get_email_by_numberArguments\nemail_id\n  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value='1001 OR 1=1', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing"
        },
        "execution_time": 0.0070002079010009766,
        "is_functional_test": false
      },
      {
        "case_name": "跨站脚本攻击(XSS)测试",
        "purpose": "验证工具能否安全地拒绝包含XSS攻击向量的邮件ID输入。",
        "args": {
          "email_id": "<script>alert('xss')</script>"
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 1 validation error for get_email_by_numberArguments\nemail_id\n  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value=\"<script>alert('xss')</script>\", input_type=str]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing"
        },
        "execution_time": 0.00400090217590332,
        "is_functional_test": false
      }
    ],
    "reply_to_email_by_number": [
      {
        "case_name": "基本邮件回复功能测试",
        "purpose": "验证工具能够对指定编号的邮件进行正常回复，使用有效邮件ID和回复内容。",
        "args": {
          "email_id": 101,
          "reply_text": "这是测试回复内容。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 101"
        },
        "execution_time": 0.0029981136322021484,
        "is_functional_test": true
      },
      {
        "case_name": "空回复内容测试",
        "purpose": "验证当回复内容为空字符串时，工具是否仍能成功执行回复操作。",
        "args": {
          "email_id": 102,
          "reply_text": ""
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 102"
        },
        "execution_time": 0.0030002593994140625,
        "is_functional_test": true
      },
      {
        "case_name": "特殊字符回复内容测试",
        "purpose": "验证工具是否能正确处理包含特殊字符（如中文、符号）的回复内容。",
        "args": {
          "email_id": 103,
          "reply_text": "这是一条包含特殊字符的测试回复！@#￥%……&*（）——+【】{}；：'\"，。/<>?"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 103"
        },
        "execution_time": 0.00800633430480957,
        "is_functional_test": true
      },
      {
        "case_name": "无效邮件ID测试",
        "purpose": "验证当提供一个不存在的邮件ID时，工具是否能返回错误信息而不是抛出异常。",
        "args": {
          "email_id": -1,
          "reply_text": "尝试回复一条不存在的邮件。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: -1"
        },
        "execution_time": 0.006996631622314453,
        "is_functional_test": false
      },
      {
        "case_name": "邮件ID为非整数类型测试",
        "purpose": "验证当邮件ID不是整数类型时，工具是否能捕获参数类型错误并返回提示。",
        "args": {
          "email_id": "abc",
          "reply_text": "测试邮件ID为非整数的情况。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 1 validation error for reply_to_email_by_numberArguments\nemail_id\n  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value='abc', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing"
        },
        "execution_time": 0.00500035285949707,
        "is_functional_test": false
      },
      {
        "case_name": "回复内容为非字符串类型测试",
        "purpose": "验证当回复内容不是字符串类型时，工具是否能捕获参数类型错误并返回提示。",
        "args": {
          "email_id": 105,
          "reply_text": 12345
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 1 validation error for reply_to_email_by_numberArguments\nreply_text\n  Input should be a valid string [type=string_type, input_value=12345, input_type=int]\n    For further information visit https://errors.pydantic.dev/2.10/v/string_type"
        },
        "execution_time": 0.005167961120605469,
        "is_functional_test": false
      },
      {
        "case_name": "无邮件客户端连接时回复测试",
        "purpose": "模拟Outlook未连接情况，验证工具在无法发送邮件时是否能优雅地返回错误信息。",
        "args": {
          "email_id": 106,
          "reply_text": "测试Outlook未连接时的回复行为。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 106"
        },
        "execution_time": 0.008013010025024414,
        "is_functional_test": false
      }
    ],
    "compose_email": [
      {
        "case_name": "发送基本邮件",
        "purpose": "验证工具在提供所有必填参数时能够成功发送一封基本邮件。",
        "args": {
          "subject": "测试主题",
          "body": "这是测试邮件正文内容。",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.006000995635986328,
        "is_functional_test": true
      },
      {
        "case_name": "包含抄送地址的邮件发送",
        "purpose": "验证工具在提供cc参数时，能正确处理并发送带有抄送的邮件。",
        "args": {
          "subject": "带抄送的测试邮件",
          "body": "这封邮件有一个抄送地址。",
          "to": "recipient@example.com",
          "cc": "cc@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.0149993896484375,
        "is_functional_test": true
      },
      {
        "case_name": "发送空主题邮件",
        "purpose": "验证工具是否允许发送没有主题的邮件（空字符串）。",
        "args": {
          "subject": "",
          "body": "这是一个无主题的测试邮件。",
          "to": "empty_subject@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.0050008296966552734,
        "is_functional_test": true
      },
      {
        "case_name": "特殊字符主题和正文测试",
        "purpose": "验证工具是否能够正确处理包含特殊字符（如中文、符号）的主题和正文内容。",
        "args": {
          "subject": "测试邮件！@#￥%……&*（）——+{}【】；：\"|<>?/.,，。、？",
          "body": "这是一封包含各种特殊字符的邮件正文内容。",
          "to": "special_chars@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.00600433349609375,
        "is_functional_test": true
      },
      {
        "case_name": "无效收件人邮箱格式测试",
        "purpose": "验证工具对非法邮箱格式的处理能力，应返回错误提示而非静默失败。",
        "args": {
          "subject": "无效收件人测试",
          "body": "这封邮件使用了不合法的邮箱地址作为收件人。",
          "to": "invalid-email"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.007008790969848633,
        "is_functional_test": false
      },
      {
        "case_name": "缺失必填字段测试",
        "purpose": "验证工具在缺少必填字段（如to为空）时能否正确报错。",
        "args": {
          "subject": "缺少收件人测试",
          "body": "这封邮件未指定收件人地址。",
          "to": ""
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.010024070739746094,
        "is_functional_test": false
      },
      {
        "case_name": "XSS攻击向量安全测试",
        "purpose": "验证工具是否对邮件主题和正文中可能存在的脚本注入进行过滤或转义。",
        "args": {
          "subject": "<script>alert('xss')</script>",
          "body": "<img src=x onerror=alert(1)>",
          "to": "security_test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.0069887638092041016,
        "is_functional_test": false
      }
    ]
  },
  "total_cases": 46
}