{
  "server_name": "server",
  "parent_dir": "refined",
  "report_name": "gemini-2.5-pro-mcp_outlook_manager",
  "server_path": "workspace/pipeline-output-servers/gemini-2.5-pro/mcp_outlook_manager/refined/server.py",
  "timestamp": "2025-07-11T21:14:31.882480",
  "tools": [
    {
      "name": "list_folders",
      "description": "\n    Retrieves and lists all accessible email folders from the user's main Outlook mailbox.\n    This function scans the default mailbox for top-level folders and their direct subfolders,\n    providing a comprehensive list for use in other email-related functions.\n\n    Returns:\n        str: A JSON string representing a sorted list of folder names.\n             Example: '[\"Inbox\", \"Sent Items\", \"Drafts\", \"My Project Folder\"]'\n    ",
      "args_schema": {
        "properties": {},
        "title": "list_foldersArguments",
        "type": "object"
      }
    },
    {
      "name": "list_recent_emails",
      "description": "\n    Fetches a list of email summaries from a specified folder received within a given number of days.\n    The results are cached, and each email is assigned a number for subsequent operations like 'get_email_by_number'.\n    The list is sorted with the most recent emails first and is limited to the top 100 results for performance.\n\n    Args:\n        days (int): The number of past days to search for emails. Must be a positive integer.\n        folder_name (str, optional): The name of the Outlook folder to search in. Defaults to \"Inbox\".\n\n    Returns:\n        str: A JSON string representing a list of dictionaries, where each dictionary contains the\n             assigned number, subject, sender, and received time of an email. Returns an empty list if no emails are found.\n             Example: '[{\"number\": 1, \"subject\": \"Project Update\", \"from\": \"John Doe\", \"received\": \"2023-10-27 10:30\"}]'\n    ",
      "args_schema": {
        "properties": {
          "days": {
            "title": "Days",
            "type": "integer"
          },
          "folder_name": {
            "default": "Inbox",
            "title": "Folder Name",
            "type": "string"
          }
        },
        "required": [
          "days"
        ],
        "title": "list_recent_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_emails",
      "description": "\n    Searches for emails based on a keyword within a specified date range and folder.\n    The search query is applied to the email's subject, body, and sender fields.\n    The results are cached, and each email is assigned a number for subsequent operations.\n    The list is sorted with the most recent emails first and is limited to the top 100 results.\n\n    Args:\n        query (str): The keyword or phrase to search for.\n        start_date (str): The start date for the search range, formatted as 'YYYY-MM-DD'.\n        end_date (str): The end date for the search range, formatted as 'YYYY-MM-DD'.\n        folder_name (str, optional): The name of the folder to search. Defaults to \"Inbox\".\n\n    Returns:\n        str: A JSON string representing a list of dictionaries, each containing the assigned number,\n             subject, sender, and received time of a matching email. Returns an empty list if no matches are found.\n             Example: '[{\"number\": 1, \"subject\": \"Re: Project Plan\", \"from\": \"Jane Smith\", \"received\": \"2023-10-26 15:00\"}]'\n    ",
      "args_schema": {
        "properties": {
          "query": {
            "title": "Query",
            "type": "string"
          },
          "start_date": {
            "title": "Start Date",
            "type": "string"
          },
          "end_date": {
            "title": "End Date",
            "type": "string"
          },
          "folder_name": {
            "default": "Inbox",
            "title": "Folder Name",
            "type": "string"
          }
        },
        "required": [
          "query",
          "start_date",
          "end_date"
        ],
        "title": "search_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_email_by_number",
      "description": "\n    Retrieves the full details of a specific email from the cache generated by\n    `list_recent_emails` or `search_emails`, using its assigned number.\n    This provides access to the sender, recipients, subject, full body, and attachments.\n\n    Args:\n        email_number (int): The number of the email as provided in the last list. Must be a positive integer.\n\n    Returns:\n        str: A JSON string representing a dictionary with the email's details, including sender,\n             recipients (To, CC), subject, body, received time, and a list of attachment filenames.\n             Returns an error message if the number is invalid or not found in the cache.\n             Example: '{\"from\": \"sender@example.com\", \"to\": \"you@example.com\", \"cc\": \"manager@example.com\", \"subject\": \"Project Update\", \"received\": \"2023-10-27 10:30:00\", \"body\": \"Here is the latest update...\", \"attachments\": [\"report.docx\", \"data.xlsx\"]}'\n    ",
      "args_schema": {
        "properties": {
          "email_number": {
            "title": "Email Number",
            "type": "integer"
          }
        },
        "required": [
          "email_number"
        ],
        "title": "get_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "reply_to_email_by_number",
      "description": "\n    Sends a 'Reply All' to a specific email from the cached list using its assigned number.\n    The provided reply text is prepended to the original email's body in the reply.\n\n    Args:\n        email_number (int): The number of the email to reply to, from the cached list.\n        reply_body (str): The content of the reply message. Cannot be empty.\n\n    Returns:\n        str: A JSON string containing a status message confirming the action.\n             Example: '{\"status\": \"Successfully replied to email number 1.\"}'\n    ",
      "args_schema": {
        "properties": {
          "email_number": {
            "title": "Email Number",
            "type": "integer"
          },
          "reply_body": {
            "title": "Reply Body",
            "type": "string"
          }
        },
        "required": [
          "email_number",
          "reply_body"
        ],
        "title": "reply_to_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "compose_email",
      "description": "\n    Composes and sends a new email with the specified subject, body, and recipients.\n\n    Args:\n        subject (str): The subject line of the new email. Cannot be empty.\n        body (str): The main content of the email. Cannot be empty.\n        recipients (List[str]): A list of one or more email addresses for the 'To' field.\n        cc_recipients (List[str], optional): A list of email addresses for the 'CC' field. Defaults to None.\n\n    Returns:\n        str: A JSON string containing a status message confirming that the email was sent.\n             Example: '{\"status\": \"Email with subject 'New Proposal' sent successfully.\"}'\n    ",
      "args_schema": {
        "properties": {
          "subject": {
            "title": "Subject",
            "type": "string"
          },
          "body": {
            "title": "Body",
            "type": "string"
          },
          "recipients": {
            "items": {
              "type": "string"
            },
            "title": "Recipients",
            "type": "array"
          },
          "cc_recipients": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Cc Recipients"
          }
        },
        "required": [
          "subject",
          "body",
          "recipients"
        ],
        "title": "compose_emailArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "list_folders": [
      {
        "case_name": "Basic Folder Listing",
        "purpose": "验证 list_folders 工具能够正确列出默认邮箱中的顶级文件夹和直接子文件夹",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 3.903067111968994,
        "is_functional_test": true
      },
      {
        "case_name": "Verify Sorted Order of Folders",
        "purpose": "确认返回的文件夹列表是按字母顺序排序的",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 1.1239182949066162,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Mailbox Test",
        "purpose": "测试当邮箱中没有任何文件夹时，工具是否能优雅地返回空数组",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 1.2187190055847168,
        "is_functional_test": true
      },
      {
        "case_name": "Special Character Folder Names Handling",
        "purpose": "验证工具可以正确处理包含特殊字符的文件夹名称并正常返回",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 1.053349256515503,
        "is_functional_test": true
      },
      {
        "case_name": "Unicode and Multilingual Folder Support",
        "purpose": "测试工具是否支持多语言（如中文、日文等）命名的邮件文件夹",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 1.1218996047973633,
        "is_functional_test": true
      },
      {
        "case_name": "SQL Injection in Folder Name Handling",
        "purpose": "验证工具能否安全处理包含潜在 SQL 注入字符的文件夹名称",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 1.0670325756072998,
        "is_functional_test": false
      },
      {
        "case_name": "XSS Attempt in Folder Name Handling",
        "purpose": "测试工具对包含潜在 XSS 攻击代码的文件夹名的处理能力",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 1.046699047088623,
        "is_functional_test": false
      },
      {
        "case_name": "Network Disconnection During Execution",
        "purpose": "模拟网络中断情况，验证工具是否能妥善处理连接失败的情况",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 1.3898396492004395,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Mailbox Credentials",
        "purpose": "测试使用无效凭据访问邮箱时工具的错误处理机制",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 1.1564290523529053,
        "is_functional_test": false
      },
      {
        "case_name": "Maximum Folder Depth Test",
        "purpose": "验证工具在遇到嵌套最深的文件夹结构时的行为是否符合预期",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 1.2009713649749756,
        "is_functional_test": true
      },
      {
        "case_name": "Very Long Folder Name Handling",
        "purpose": "测试工具处理超长文件夹名称的能力",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 1.1128504276275635,
        "is_functional_test": true
      },
      {
        "case_name": "Hidden and System Folder Exclusion",
        "purpose": "验证工具是否排除隐藏或系统文件夹，只返回用户可见的文件夹",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\u7a3f\", \"\\u8349\\u7a3f\\u7bb1\"]"
        },
        "execution_time": 1.10917067527771,
        "is_functional_test": true
      }
    ],
    "list_recent_emails": [
      {
        "case_name": "Basic Email Listing from Inbox",
        "purpose": "验证工具能正确从默认收件箱获取最近7天的邮件摘要列表，并按最新排序。",
        "args": {
          "days": 7
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.035248517990112305,
        "is_functional_test": true
      },
      {
        "case_name": "Email Listing from Custom Folder",
        "purpose": "验证工具能正确从指定文件夹获取最近30天的邮件摘要列表。",
        "args": {
          "days": 30,
          "folder_name": "Sent Items"
        },
        "response": {
          "result": "[{\"number\": 1, \"subject\": \"\\u65e0\\u6284\\u9001\\u6d4b\\u8bd5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 17:14\"}, {\"number\": 2, \"subject\": \"\\u6d4b\\u8bd5\\u90ae\\u4ef6!@#$%^&*()\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 17:13\"}, {\"number\": 3, \"subject\": \"\\u3053\\u308c\\u306f\\u65e5\\u672c\\u8a9e\\u306e\\u30c6\\u30b9\\u30c8\\u30e1\\u30fc\\u30eb\\u3067\\u3059\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 17:13\"}, {\"number\": 4, \"subject\": \"Outlook\\u8fde\\u63a5\\u5931\\u8d25\\u6d4b\\u8bd5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 17:13\"}, {\"number\": 5, \"subject\": \"\\u6700\\u5c0f\\u6536\\u4ef6\\u4eba\\u6d4b\\u8bd5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 17:13\"}, {\"number\": 6, \"subject\": \"\\u6700\\u5927\\u6536\\u4ef6\\u4eba\\u6d4b\\u8bd5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 17:13\"}, {\"number\": 7, \"subject\": \"\\u591a\\u6536\\u4ef6\\u4eba\\u6d4b\\u8bd5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 17:12\"}, {\"number\": 8, \"subject\": \"\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 17:11\"}, {\"number\": 9, \"subject\": \"\\u5e26\\u6284\\u9001\\u7684\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 17:11\"}, {\"number\": 10, \"subject\": \"Email with Attachment\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 16:08\"}, {\"number\": 11, \"subject\": \"<script>alert('xss')</script>\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 16:08\"}, {\"number\": 12, \"subject\": \"SQL Injection Test\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 16:08\"}, {\"number\": 13, \"subject\": \"Test Email\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 16:07\"}, {\"number\": 14, \"subject\": \"Test Email with CC\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 16:07\"}, {\"number\": 15, \"subject\": \"\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 16:07\"}, {\"number\": 16, \"subject\": \"Long Email Test\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 16:07\"}, {\"number\": 17, \"subject\": \"Special Characters Test\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-01 16:07\"}, {\"number\": 18, \"subject\": \"DROP TABLE users;\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 22:16\"}, {\"number\": 19, \"subject\": \"XSS\\u653b\\u51fb\\u6d4b\\u8bd5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 22:16\"}, {\"number\": 20, \"subject\": \"\\u6076\\u610f\\u811a\\u672c\\u9644\\u4ef6\\u6d4b\\u8bd5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 22:16\"}, {\"number\": 21, \"subject\": \"\\u9879\\u76ee\\u8fdb\\u5ea6\\u6c47\\u62a5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 22:15\"}, {\"number\": 22, \"subject\": \"\\u65e0\\u6284\\u9001\\u90ae\\u4ef6\\u6d4b\\u8bd5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 22:15\"}, {\"number\": 23, \"subject\": \"\\u8fd9\\u662f\\u4e00\\u4e2a\\u975e\\u5e38\\u957f\\u7684\\u90ae\\u4ef6\\u4e3b\\u9898\\u793a\\u4f8b\\uff0c\\u7528\\u4e8e\\u6d4b\\u8bd5compose_email\\u5de5\\u5177\\u5bf9\\u8d85\\u957f\\u4e3b\\u9898\\u884c\\u7684\\u5904\\u7406\\u80fd\\u529b\\uff0c\\u786e\\u4fdd\\u4e0d\\u4f1a\\u56e0\\u4e3a\\u4e3b\\u9898\\u8fc7\\u957f\\u800c\\u5bfc\\u81f4\\u53d1\\u9001\\u5931\\u8d25\\u6216\\u7cfb\\u7edf\\u5f02\\u5e38\\u3002\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 22:15\"}, {\"number\": 24, \"subject\": \"\\u7a7a\\u767d\\u6b63\\u6587\\u6d4b\\u8bd5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 22:15\"}, {\"number\": 25, \"subject\": \"SQL\\u6ce8\\u5165\\u6d4b\\u8bd5' OR 1=1--\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 21:57\"}, {\"number\": 26, \"subject\": \"\\u975e\\u6388\\u6743\\u53d1\\u9001\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 21:57\"}, {\"number\": 27, \"subject\": \"\\u5e26\\u9644\\u4ef6\\u7684\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 21:57\"}, {\"number\": 28, \"subject\": \"\\u591a\\u9644\\u4ef6\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 21:57\"}, {\"number\": 29, \"subject\": \"\\u6d4b\\u8bd5\\u90ae\\u4ef6\\u4e3b\\u9898\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 21:56\"}, {\"number\": 30, \"subject\": \"\\u5e26\\u6284\\u9001\\u7684\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 21:56\"}, {\"number\": 31, \"subject\": \"\\u7a7aCC\\u5b57\\u6bb5\\u6d4b\\u8bd5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 21:56\"}, {\"number\": 32, \"subject\": \"\\u5e26\\u6284\\u9001\\u7684\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:37\"}, {\"number\": 33, \"subject\": \"\\u591a\\u6536\\u4ef6\\u4eba\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:37\"}, {\"number\": 34, \"subject\": \"\\u8fd9\\u662f\\u4e00\\u4e2a\\u975e\\u5e38\\u957f\\u7684\\u90ae\\u4ef6\\u4e3b\\u9898\\u793a\\u4f8b\\uff0c\\u7528\\u4e8e\\u6d4b\\u8bd5compose_email\\u5de5\\u5177\\u5bf9\\u8d85\\u957f\\u4e3b\\u9898\\u884c\\u7684\\u5904\\u7406\\u80fd\\u529b\\uff0c\\u786e\\u4fdd\\u4e0d\\u4f1a\\u56e0\\u4e3a\\u4e3b\\u9898\\u8fc7\\u957f\\u800c\\u5bfc\\u81f4\\u53d1\\u9001\\u5931\\u8d25\\u6216\\u7cfb\\u7edf\\u5f02\\u5e38\\u3002\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:37\"}, {\"number\": 35, \"subject\": \"\\u7a7a\\u6284\\u9001\\u5b57\\u6bb5\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:37\"}, {\"number\": 36, \"subject\": \"SQL\\u6ce8\\u5165\\u6d4b\\u8bd5\\u4e3b\\u9898\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:37\"}, {\"number\": 37, \"subject\": \"XSS\\u653b\\u51fb\\u6d4b\\u8bd5\\u4e3b\\u9898\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:37\"}, {\"number\": 38, \"subject\": \"\\u975e\\u6388\\u6743\\u7528\\u6237\\u53d1\\u9001\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:37\"}, {\"number\": 39, \"subject\": \"\\u6d4b\\u8bd5\\u90ae\\u4ef6\\u4e3b\\u9898\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:36\"}, {\"number\": 40, \"subject\": \"Empty Body Test\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:20\"}, {\"number\": 41, \"subject\": \"Unauthorized Send Attempt\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:20\"}, {\"number\": 42, \"subject\": \"Outlook Not Running Test\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:20\"}, {\"number\": 43, \"subject\": \"\\u56de\\u590d: Please sign in to your Outlook.com account\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-30 20:19\"}, {\"number\": 44, \"subject\": \"Test Email Subject\", \"from\": \"Bocheng Peng\", \"received\": \"2025-06-...[截断]，共计13847字符，剩余7847字符"
        },
        "execution_time": 3.9046056270599365,
        "is_functional_test": true
      },
      {
        "case_name": "Zero Emails in Specified Period",
        "purpose": "测试当指定时间内没有邮件时，工具是否返回空数组。",
        "args": {
          "days": 1
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.031449317932128906,
        "is_functional_test": true
      },
      {
        "case_name": "Maximum Results Limit Test",
        "purpose": "验证工具是否限制结果为最多100条记录。",
        "args": {
          "days": 365
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: <unknown>.ReceivedTime\"}"
        },
        "execution_time": 0.019228219985961914,
        "is_functional_test": true
      },
      {
        "case_name": "Unicode Folder Name Handling",
        "purpose": "验证工具能否处理包含中文或Unicode字符的文件夹名称。",
        "args": {
          "days": 7,
          "folder_name": "\\u6536\\u4ef6\\u7bb1"
        },
        "response": {
          "result": "{\"error\": \"Folder '\\\\u6536\\\\u4ef6\\\\u7bb1' not found in Outlook.\"}"
        },
        "execution_time": 1.7066619396209717,
        "is_functional_test": true
      },
      {
        "case_name": "Special Characters in Folder Name",
        "purpose": "测试工具对包含特殊字符的文件夹名的兼容性。",
        "args": {
          "days": 7,
          "folder_name": "Test@#%&()_Folder"
        },
        "response": {
          "result": "{\"error\": \"Folder 'Test@#%&()_Folder' not found in Outlook.\"}"
        },
        "execution_time": 1.189849853515625,
        "is_functional_test": true
      },
      {
        "case_name": "SQL Injection Attempt in Folder Name",
        "purpose": "验证工具是否安全处理包含潜在 SQL 注入字符的文件夹名。",
        "args": {
          "days": 7,
          "folder_name": "Inbox'; DROP TABLE emails;--"
        },
        "response": {
          "result": "{\"error\": \"Folder 'Inbox'; DROP TABLE emails;--' not found in Outlook.\"}"
        },
        "execution_time": 2.820967674255371,
        "is_functional_test": false
      },
      {
        "case_name": "XSS Attempt in Folder Name",
        "purpose": "测试工具是否能够防止通过文件夹名注入 XSS 攻击代码。",
        "args": {
          "days": 7,
          "folder_name": "<script>alert('xss')</script>"
        },
        "response": {
          "result": "{\"error\": \"Folder '<script>alert('xss')</script>' not found in Outlook.\"}"
        },
        "execution_time": 1.0818705558776855,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Days Parameter - Zero",
        "purpose": "验证工具是否拒绝 days 参数为零的情况并返回错误。",
        "args": {
          "days": 0
        },
        "response": {
          "result": "{\"error\": \"Parameter 'days' must be a positive integer.\"}"
        },
        "execution_time": 0.002998828887939453,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Days Parameter - Negative Value",
        "purpose": "验证工具是否拒绝负数作为 days 参数。",
        "args": {
          "days": -5
        },
        "response": {
          "result": "{\"error\": \"Parameter 'days' must be a positive integer.\"}"
        },
        "execution_time": 0.0035130977630615234,
        "is_functional_test": false
      },
      {
        "case_name": "Very Large Days Value",
        "purpose": "测试工具在非常大的 days 值下的行为（如9999）。",
        "args": {
          "days": 9999
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: <unknown>.ReceivedTime\"}"
        },
        "execution_time": 0.024101734161376953,
        "is_functional_test": true
      },
      {
        "case_name": "Minimum Valid Days",
        "purpose": "验证最小有效 days 值（1）是否正常工作。",
        "args": {
          "days": 1
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.018019914627075195,
        "is_functional_test": true
      }
    ],
    "search_emails": [
      {
        "case_name": "Basic Email Search in Inbox",
        "purpose": "验证工具在默认收件箱中使用关键词进行基本邮件搜索功能是否正常工作。",
        "args": {
          "query": "test",
          "start_date": "2025-06-01",
          "end_date": "2025-07-01"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.04074287414550781,
        "is_functional_test": true
      },
      {
        "case_name": "Email Search in Sent Items Folder",
        "purpose": "测试工具能否在指定的 'Sent Items' 文件夹中正确执行搜索。",
        "args": {
          "query": "project",
          "start_date": "2025-06-01",
          "end_date": "2025-07-01",
          "folder_name": "Sent Items"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.03767824172973633,
        "is_functional_test": true
      },
      {
        "case_name": "Search with Empty Results",
        "purpose": "验证当没有匹配结果时，工具是否返回空数组。",
        "args": {
          "query": "nonexistentkeyword",
          "start_date": "2025-06-01",
          "end_date": "2025-07-01"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.02011728286743164,
        "is_functional_test": true
      },
      {
        "case_name": "Date Range Limitation Test",
        "purpose": "验证工具是否能正确处理跨日期范围的搜索请求。",
        "args": {
          "query": "report",
          "start_date": "2025-01-01",
          "end_date": "2025-12-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.017026424407958984,
        "is_functional_test": true
      },
      {
        "case_name": "Unicode Query Handling",
        "purpose": "测试工具对中文或Unicode字符作为搜索关键词的兼容性。",
        "args": {
          "query": "项目",
          "start_date": "2025-06-01",
          "end_date": "2025-07-01"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.05439281463623047,
        "is_functional_test": true
      },
      {
        "case_name": "Special Characters in Query",
        "purpose": "验证工具是否支持包含特殊字符的搜索关键词。",
        "args": {
          "query": "DROP TABLE users;--",
          "start_date": "2025-06-01",
          "end_date": "2025-07-01"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.032140254974365234,
        "is_functional_test": false
      },
      {
        "case_name": "XSS Attempt in Search Query",
        "purpose": "测试工具是否能够防止通过搜索关键词注入 XSS 攻击代码。",
        "args": {
          "query": "<script>alert('xss')</script>",
          "start_date": "2025-06-01",
          "end_date": "2025-07-01"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u65e0\\u6cd5\\u5206\\u6790\\u6761\\u4ef6\\u3002\\u9519\\u8bef\\u4f4d\\u7f6e\\u5728\\u201cxss\\u201d\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.020841121673583984,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Date Format Handling",
        "purpose": "验证工具是否拒绝格式错误的日期参数并返回错误信息。",
        "args": {
          "query": "meeting",
          "start_date": "2025/06/01",
          "end_date": "2025/07/01"
        },
        "response": {
          "result": "{\"error\": \"Invalid date format. Please use 'YYYY-MM-DD'.\"}"
        },
        "execution_time": 0.003785371780395508,
        "is_functional_test": false
      },
      {
        "case_name": "Missing Required Parameters",
        "purpose": "测试工具在缺少必填参数（如 query）时是否返回错误。",
        "args": {
          "start_date": "2025-06-01",
          "end_date": "2025-07-01"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: 1 validation error for search_emailsArguments\nquery\n  Field required [type=missing, input_value={'start_date': '2025-06-0...end_date': '2025-07-01'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.005387306213378906,
        "is_functional_test": false
      },
      {
        "case_name": "Empty Query String",
        "purpose": "验证工具在查询字符串为空时的行为是否符合预期。",
        "args": {
          "query": "",
          "start_date": "2025-06-01",
          "end_date": "2025-07-01"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: <unknown>.ReceivedTime\"}"
        },
        "execution_time": 0.034761905670166016,
        "is_functional_test": false
      },
      {
        "case_name": "Start Date After End Date",
        "purpose": "测试工具是否能正确处理开始日期晚于结束日期的情况。",
        "args": {
          "query": "summary",
          "start_date": "2025-07-15",
          "end_date": "2025-07-01"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.016112089157104492,
        "is_functional_test": false
      },
      {
        "case_name": "Maximum Result Limit Test",
        "purpose": "验证工具是否限制结果为最多100条记录。",
        "args": {
          "query": "*",
          "start_date": "2024-01-01",
          "end_date": "2025-12-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.015033483505249023,
        "is_functional_test": true
      }
    ],
    "get_email_by_number": [
      {
        "case_name": "Basic Email Retrieval by Number",
        "purpose": "验证工具能通过指定邮件编号获取完整的邮件详细信息。",
        "args": {
          "email_number": 1
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.008288383483886719,
        "is_functional_test": true
      },
      {
        "case_name": "Retrieve Email with Special Characters in Content",
        "purpose": "测试工具是否能正确处理包含特殊字符的邮件内容。",
        "args": {
          "email_number": 2
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 2. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.009508848190307617,
        "is_functional_test": true
      },
      {
        "case_name": "Unicode Email Retrieval",
        "purpose": "验证工具是否支持通过中文或Unicode表示的邮件编号获取邮件详情。",
        "args": {
          "email_number": 3
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 3. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.011132001876831055,
        "is_functional_test": true
      },
      {
        "case_name": "Invalid Email Number - Zero",
        "purpose": "验证工具拒绝为值为0的邮件编号返回错误信息。",
        "args": {
          "email_number": 0
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.005031108856201172,
        "is_functional_test": false
      },
      {
        "case_name": "Negative Email Number Input",
        "purpose": "测试工具对负数作为邮件编号的处理能力。",
        "args": {
          "email_number": -1
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.0030035972595214844,
        "is_functional_test": false
      },
      {
        "case_name": "Non-Integer Email Number",
        "purpose": "验证工具能否识别非整数输入并返回错误。",
        "args": {
          "email_number": "abc"
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 1 validation error for get_email_by_numberArguments\nemail_number\n  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value='abc', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing"
        },
        "execution_time": 0.005537748336791992,
        "is_functional_test": false
      },
      {
        "case_name": "Email Number Not Found",
        "purpose": "测试当提供的邮件编号不存在于缓存中时，工具是否返回错误信息。",
        "args": {
          "email_number": 9999
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 9999. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.009509801864624023,
        "is_functional_test": false
      },
      {
        "case_name": "SQL Injection Attempt in Email Number",
        "purpose": "验证工具是否安全地处理潜在 SQL 注入攻击的邮件编号。",
        "args": {
          "email_number": "1; DROP TABLE emails;"
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 1 validation error for get_email_by_numberArguments\nemail_number\n  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value='1; DROP TABLE emails;', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing"
        },
        "execution_time": 0.007000446319580078,
        "is_functional_test": false
      },
      {
        "case_name": "XSS Attempt via Email Number",
        "purpose": "测试工具是否能够防止通过邮件编号注入 XSS 攻击代码。",
        "args": {
          "email_number": "<script>alert('xss')</script>"
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 1 validation error for get_email_by_numberArguments\nemail_number\n  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value=\"<script>alert('xss')</script>\", input_type=str]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing"
        },
        "execution_time": 0.0050160884857177734,
        "is_functional_test": false
      },
      {
        "case_name": "Maximum Valid Email Number",
        "purpose": "验证工具在最大有效邮件编号下的行为。",
        "args": {
          "email_number": 2147483647
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 2147483647. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.007512331008911133,
        "is_functional_test": true
      },
      {
        "case_name": "Very Large Email Number",
        "purpose": "测试工具在超出实际范围的大邮件编号下的行为。",
        "args": {
          "email_number": 9999999999
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 9999999999. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.009528875350952148,
        "is_functional_test": true
      },
      {
        "case_name": "Email Retrieval After Cache Expiration",
        "purpose": "验证当邮件缓存过期后，工具是否无法检索邮件信息。",
        "args": {
          "email_number": 1
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.010523080825805664,
        "is_functional_test": false
      }
    ],
    "reply_to_email_by_number": [
      {
        "case_name": "Basic Reply to Email by Number",
        "purpose": "验证工具能正确通过指定邮件编号回复邮件，并将回复内容前置到原始邮件正文前。",
        "args": {
          "email_number": 1,
          "reply_body": "这是测试回复内容。"
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.08041787147521973,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Reply Body Test",
        "purpose": "验证当 reply_body 参数为空时，工具是否返回错误信息。",
        "args": {
          "email_number": 2,
          "reply_body": ""
        },
        "response": {
          "result": "{\"error\": \"Parameter 'reply_body' cannot be empty.\"}"
        },
        "execution_time": 0.09258437156677246,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Email Number - Zero",
        "purpose": "验证当 email_number 参数为0时，工具是否拒绝该请求并返回错误。",
        "args": {
          "email_number": 0,
          "reply_body": "This is an invalid number test."
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.006099224090576172,
        "is_functional_test": false
      },
      {
        "case_name": "Negative Email Number Test",
        "purpose": "验证当 email_number 参数为负数时，工具是否拒绝该请求并返回错误。",
        "args": {
          "email_number": -1,
          "reply_body": "This is a negative number test."
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.009738445281982422,
        "is_functional_test": false
      },
      {
        "case_name": "Reply to Non-Existent Email Number",
        "purpose": "验证当提供的 email_number 超出缓存邮件列表范围时，工具是否优雅处理错误。",
        "args": {
          "email_number": 999,
          "reply_body": "This is a non-existent email number test."
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 999. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.009045839309692383,
        "is_functional_test": false
      },
      {
        "case_name": "Special Characters in Reply Body",
        "purpose": "验证工具是否支持在 reply_body 中使用特殊字符和符号。",
        "args": {
          "email_number": 3,
          "reply_body": "这是一条包含特殊字符的回复：!@#$%^&*()_+=-[]{};':\",./<>?"
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 3. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.016098976135253906,
        "is_functional_test": true
      },
      {
        "case_name": "Unicode and Multilingual Reply Body",
        "purpose": "验证工具是否支持多语言（如中文、日文）在 reply_body 中的正常显示。",
        "args": {
          "email_number": 4,
          "reply_body": "これは日本語の返信テストです。This is a Japanese reply test."
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 4. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.01705026626586914,
        "is_functional_test": true
      },
      {
        "case_name": "XSS Attempt in Reply Body",
        "purpose": "测试工具是否能够防止通过 reply_body 注入 XSS 攻击代码。",
        "args": {
          "email_number": 6,
          "reply_body": "<script>alert('xss')</script>"
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 6. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.01752305030822754,
        "is_functional_test": false
      },
      {
        "case_name": "SQL Injection Attempt in Reply Body",
        "purpose": "验证工具是否安全处理包含潜在 SQL 注入内容的 reply_body。",
        "args": {
          "email_number": 7,
          "reply_body": "DROP TABLE users; --"
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 7. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.017370223999023438,
        "is_functional_test": false
      },
      {
        "case_name": "Minimum Valid Email Number",
        "purpose": "验证最小有效 email_number 值（1）是否正常工作。",
        "args": {
          "email_number": 1,
          "reply_body": "This is a minimum valid email number test."
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.016096115112304688,
        "is_functional_test": true
      },
      {
        "case_name": "Maximum Valid Email Number",
        "purpose": "验证最大有效 email_number 是否正常工作（假设当前最多有 44 封邮件）。",
        "args": {
          "email_number": 44,
          "reply_body": "This is a maximum valid email number test."
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 44. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.015555858612060547,
        "is_functional_test": true
      }
    ],
    "compose_email": [
      {
        "case_name": "Basic Email Composition with Required Fields",
        "purpose": "验证使用必填参数（主题、正文、收件人）可以成功发送邮件",
        "args": {
          "subject": "Test Subject",
          "body": "This is a test email body.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"status\": \"Email with subject 'Test Subject' sent successfully.\"}"
        },
        "execution_time": 6.417457818984985,
        "is_functional_test": true
      },
      {
        "case_name": "Email Composition with CC Recipients",
        "purpose": "验证包含可选CC收件人的邮件能否正常发送",
        "args": {
          "subject": "Test CC Email",
          "body": "This email includes a CC recipient.",
          "recipients": [
            "test@example.com"
          ],
          "cc_recipients": [
            "cc@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 1.2665274143218994,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Subject Field Validation",
        "purpose": "验证工具是否拒绝空主题字段并返回错误",
        "args": {
          "subject": "",
          "body": "This email has an empty subject.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Parameter 'subject' cannot be empty.\"}"
        },
        "execution_time": 0.005135536193847656,
        "is_functional_test": false
      },
      {
        "case_name": "Empty Body Field Validation",
        "purpose": "验证工具是否拒绝空正文内容并返回错误",
        "args": {
          "subject": "Missing Body Test",
          "body": "",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Parameter 'body' cannot be empty.\"}"
        },
        "execution_time": 0.01052236557006836,
        "is_functional_test": false
      },
      {
        "case_name": "Zero Recipients Handling",
        "purpose": "验证没有收件人时工具是否正确报错",
        "args": {
          "subject": "No Recipient Test",
          "body": "This email should fail due to no recipients.",
          "recipients": []
        },
        "response": {
          "result": "{\"error\": \"Parameter 'recipients' list cannot be empty.\"}"
        },
        "execution_time": 0.010056018829345703,
        "is_functional_test": false
      },
      {
        "case_name": "Special Characters in Subject Line",
        "purpose": "测试包含特殊字符的邮件主题是否能正常处理",
        "args": {
          "subject": "Test!@#$%^&*()_+{}[]|:\"<>?`~",
          "body": "Testing special characters in the subject line.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.7225210666656494,
        "is_functional_test": true
      },
      {
        "case_name": "Unicode Characters in Email Body",
        "purpose": "验证包含中文等Unicode字符的邮件正文是否能正常发送",
        "args": {
          "subject": "中文测试主题",
          "body": "这是一封用于测试的电子邮件，包含中文字符。",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"status\": \"Email with subject '\\u4e2d\\u6587\\u6d4b\\u8bd5\\u4e3b\\u9898' sent successfully.\"}"
        },
        "execution_time": 6.331777572631836,
        "is_functional_test": true
      },
      {
        "case_name": "Multiple Recipients Handling",
        "purpose": "验证工具是否支持多个收件人地址",
        "args": {
          "subject": "Multi-Recipient Test",
          "body": "This email is sent to multiple recipients.",
          "recipients": [
            "user1@example.com",
            "user2@example.com",
            "user3@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.6883223056793213,
        "is_functional_test": true
      },
      {
        "case_name": "Long Subject Line Handling",
        "purpose": "测试超长邮件主题行是否能被正确处理",
        "args": {
          "subject": "This is a very long subject line that exceeds normal length limits and should still be handled properly by the compose_email tool without any errors or truncation issues.",
          "body": "Testing long subject line handling.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.47165584564208984,
        "is_functional_test": true
      },
      {
        "case_name": "XSS Attempt in Email Content",
        "purpose": "测试包含潜在XSS攻击代码的邮件内容是否安全处理",
        "args": {
          "subject": "XSS Test",
          "body": "<script>alert('xss')</script>",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.27107667922973633,
        "is_functional_test": false
      },
      {
        "case_name": "SQL Injection Attempt in Email Body",
        "purpose": "验证包含潜在SQL注入的邮件正文是否被安全处理",
        "args": {
          "subject": "SQL Injection Test",
          "body": "DROP TABLE users; SELECT * FROM dual",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.44704413414001465,
        "is_functional_test": false
      },
      {
        "case_name": "Empty CC Recipients Handling",
        "purpose": "验证当提供空CC列表时工具是否正常处理",
        "args": {
          "subject": "Empty CC List Test",
          "body": "Testing behavior when CC list is provided but empty.",
          "recipients": [
            "test@example.com"
          ],
          "cc_recipients": []
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.42870306968688965,
        "is_functional_test": true
      }
    ]
  },
  "total_cases": 71
}