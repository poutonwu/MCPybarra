{
  "server_name": "outlook_mcp_server",
  "parent_dir": "metaGPT-qwen-plus",
  "report_name": "metaGPT-qwen-plus-outlook_mcp_server",
  "server_path": "workspace\\metaGPT-servers\\metaGPT-qwen-plus\\outlook_mcp_server.py",
  "timestamp": "2025-07-13T22:37:01.260312",
  "tools": [
    {
      "name": "list_folders",
      "description": "\n    列出所有可用的Outlook邮件文件夹。\n\n    Returns:\n        包含文件夹名称和路径的字典列表。\n    ",
      "args_schema": {
        "properties": {},
        "title": "list_foldersArguments",
        "type": "object"
      }
    },
    {
      "name": "list_recent_emails",
      "description": "\n    获取指定天数内最近的邮件标题列表。\n\n    Args:\n        days: 需要检索的过去天数，默认为7天。\n        folder_name: 指定的邮件文件夹名称，如果为空则使用默认收件箱。\n\n    Returns:\n        包含邮件主题、发件人和接收时间的字典列表。\n    ",
      "args_schema": {
        "properties": {
          "days": {
            "default": 7,
            "title": "Days",
            "type": "integer"
          },
          "folder_name": {
            "default": null,
            "title": "Folder Name",
            "type": "string"
          }
        },
        "title": "list_recent_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_emails",
      "description": "\n    在指定时间段和文件夹内按联系人或关键词搜索邮件。\n\n    Args:\n        query: 搜索查询字符串，可以是联系人或关键词。\n        folder_name: 指定的邮件文件夹名称，如果为空则使用默认收件箱。\n        start_date: 搜索的起始日期（格式：YYYY-MM-DD HH:MM）。\n        end_date: 搜索的结束日期（格式：YYYY-MM-DD HH:MM）。\n\n    Returns:\n        包含匹配邮件主题、发件人和接收时间的字典列表。\n    ",
      "args_schema": {
        "properties": {
          "query": {
            "title": "Query",
            "type": "string"
          },
          "folder_name": {
            "default": null,
            "title": "Folder Name",
            "type": "string"
          },
          "start_date": {
            "default": null,
            "title": "Start Date",
            "type": "string"
          },
          "end_date": {
            "default": null,
            "title": "End Date",
            "type": "string"
          }
        },
        "required": [
          "query"
        ],
        "title": "search_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_email_by_number",
      "description": "\n    获取指定编号的邮件详细信息。\n\n    Args:\n        email_id: 邮件的唯一标识符。\n\n    Returns:\n        包含邮件正文和附件信息的字典。\n    ",
      "args_schema": {
        "properties": {
          "email_id": {
            "title": "Email Id",
            "type": "integer"
          }
        },
        "required": [
          "email_id"
        ],
        "title": "get_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "reply_to_email_by_number",
      "description": "\n    对指定编号的邮件进行回复。\n\n    Args:\n        email_id: 邮件的唯一标识符。\n        reply_text: 回复邮件的内容。\n\n    Returns:\n        包含回复结果的状态消息。\n    ",
      "args_schema": {
        "properties": {
          "email_id": {
            "title": "Email Id",
            "type": "integer"
          },
          "reply_text": {
            "title": "Reply Text",
            "type": "string"
          }
        },
        "required": [
          "email_id",
          "reply_text"
        ],
        "title": "reply_to_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "compose_email",
      "description": "\n    新建并发送一封新邮件。\n\n    Args:\n        subject: 邮件的主题。\n        body: 邮件正文内容。\n        to: 收件人邮箱地址。\n        cc: 抄送邮箱地址（可选）。\n\n    Returns:\n        包含发送结果的状态消息。\n    ",
      "args_schema": {
        "properties": {
          "subject": {
            "title": "Subject",
            "type": "string"
          },
          "body": {
            "title": "Body",
            "type": "string"
          },
          "to": {
            "title": "To",
            "type": "string"
          },
          "cc": {
            "default": null,
            "title": "Cc",
            "type": "string"
          }
        },
        "required": [
          "subject",
          "body",
          "to"
        ],
        "title": "compose_emailArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "list_folders": [
      {
        "case_name": "列出所有Outlook邮件文件夹的基本功能测试",
        "purpose": "验证list_folders工具可以成功列出所有可用的Outlook邮件文件夹，使用默认参数执行核心功能。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.03451180458068848,
        "is_functional_test": true
      },
      {
        "case_name": "无权限访问Outlook账户的安全性测试",
        "purpose": "验证当用户没有访问Outlook账户权限时，工具是否安全处理并返回适当错误信息。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.02299976348876953,
        "is_functional_test": false
      },
      {
        "case_name": "Outlook未运行导致连接失败的错误处理测试",
        "purpose": "验证当Outlook客户端未启动时，工具能否优雅地处理连接失败的情况。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.027528047561645508,
        "is_functional_test": false
      },
      {
        "case_name": "Outlook配置异常或损坏的错误处理测试",
        "purpose": "验证在Outlook配置异常或数据文件损坏的情况下，工具是否能正确捕获异常并提供有用反馈。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.016994953155517578,
        "is_functional_test": false
      },
      {
        "case_name": "超长路径名和特殊字符目录下的Outlook文件夹测试",
        "purpose": "验证工具是否能够处理包含超长路径和特殊字符（如test_@_dir#1）的Outlook文件夹结构。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.017123937606811523,
        "is_functional_test": true
      },
      {
        "case_name": "Outlook中存在大量嵌套文件夹的边界条件测试",
        "purpose": "验证工具是否能正确处理深度嵌套的Outlook邮件文件夹结构。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.022516965866088867,
        "is_functional_test": true
      },
      {
        "case_name": "Outlook无可用文件夹的空结果处理测试",
        "purpose": "验证当Outlook中没有任何可用邮件文件夹时，工具是否能正确返回空列表而非报错。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.024994611740112305,
        "is_functional_test": true
      },
      {
        "case_name": "Outlook文件夹名称含Unicode字符的兼容性测试",
        "purpose": "验证工具是否能正确识别和显示含有非ASCII字符（如中文、日文等）的Outlook文件夹名称。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.020999670028686523,
        "is_functional_test": true
      }
    ],
    "list_recent_emails": [
      {
        "case_name": "获取默认收件箱中最近7天的邮件标题列表",
        "purpose": "验证list_recent_emails工具在使用默认参数时能够成功获取当前收件箱中最近7天内的邮件标题、发件人和接收时间。",
        "args": {},
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.015004158020019531,
        "is_functional_test": true
      },
      {
        "case_name": "指定文件夹获取最近7天邮件的基本功能测试",
        "purpose": "验证list_recent_emails工具可以正确从指定的邮件文件夹（非默认）中检索最近7天的邮件信息。",
        "args": {
          "folder_name": "\\outformcptest@outlook.com"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.02500009536743164,
        "is_functional_test": true
      },
      {
        "case_name": "自定义天数范围获取邮件的功能测试",
        "purpose": "验证list_recent_emails工具支持通过days参数自定义检索时间范围，并返回正确的邮件数据。",
        "args": {
          "days": 3,
          "folder_name": "\\outformcptest@outlook.com"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.021999597549438477,
        "is_functional_test": true
      },
      {
        "case_name": "输入0天获取当天邮件的功能测试",
        "purpose": "验证当days参数为0时，工具是否能正确获取当天收到的所有邮件。",
        "args": {
          "days": 0
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.017000913619995117,
        "is_functional_test": true
      },
      {
        "case_name": "无权限访问指定邮件文件夹的安全性测试",
        "purpose": "验证当用户没有权限访问特定邮件文件夹时，工具是否能安全处理并返回适当的错误信息而非暴露敏感内容。",
        "args": {
          "folder_name": "\\restricted_folder"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.018510818481445312,
        "is_functional_test": false
      },
      {
        "case_name": "无效文件夹名称导致邮件检索失败的错误处理测试",
        "purpose": "验证当提供一个不存在或格式错误的文件夹名称时，工具是否能优雅地处理错误并返回明确提示。",
        "args": {
          "folder_name": "\\invalid#folder@name"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.01699972152709961,
        "is_functional_test": false
      },
      {
        "case_name": "负数天数输入的边界条件测试",
        "purpose": "验证当days参数传入负值时，工具是否能正确识别并拒绝非法输入，防止异常行为。",
        "args": {
          "days": -5
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.014999866485595703,
        "is_functional_test": false
      },
      {
        "case_name": "超长天数参数的边界测试",
        "purpose": "验证工具是否能处理非常大的days参数值（如10000天），确保不会因性能问题或整数溢出而崩溃。",
        "args": {
          "days": 10000
        },
        "response": {
          "result": "{\n  \"emails\": [\n    {\n      \"id\": 35,\n      \"subject\": \"Please sign in to your Outlook.com account\",\n      \"sender\": \"Outlook.com Team\",\n      \"received_time\": \"2025-06-30 17:04\"\n    }\n  ]\n}"
        },
        "execution_time": 6.893368721008301,
        "is_functional_test": false
      }
    ],
    "search_emails": [
      {
        "case_name": "使用关键词在默认收件箱中搜索邮件的基本功能测试",
        "purpose": "验证search_emails工具可以使用关键词在默认收件箱中按时间范围成功检索匹配的邮件。",
        "args": {
          "query": "meeting",
          "start_date": "2025-06-01 00:00",
          "end_date": "2025-06-30 23:59"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.009000062942504883,
        "is_functional_test": true
      },
      {
        "case_name": "使用联系人名称在指定文件夹中搜索邮件的功能测试",
        "purpose": "验证search_emails工具可以使用联系人名称在指定邮件文件夹中成功检索邮件。",
        "args": {
          "query": "Outlook.com Team",
          "folder_name": "\\outformcptest@outlook.com",
          "start_date": "2025-06-01 00:00",
          "end_date": "2025-06-30 23:59"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.017998218536376953,
        "is_functional_test": true
      },
      {
        "case_name": "仅提供必填参数执行搜索的基本功能测试",
        "purpose": "验证search_emails工具在仅提供必填参数query时是否能使用默认值（默认收件箱和无时间限制）进行搜索。",
        "args": {
          "query": "reminder"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.010020017623901367,
        "is_functional_test": true
      },
      {
        "case_name": "输入特殊字符作为查询内容的安全性测试",
        "purpose": "验证search_emails工具是否安全处理包含特殊字符（如SQL注入或命令注入）的查询字符串，防止攻击行为。",
        "args": {
          "query": "'; DROP TABLE emails;--"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '无法分析条件。错误位置在“;”。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.006995201110839844,
        "is_functional_test": false
      },
      {
        "case_name": "无效日期格式导致搜索失败的错误处理测试",
        "purpose": "验证当用户提供非法日期格式时，工具是否能正确捕获错误并返回清晰提示而非崩溃。",
        "args": {
          "query": "test",
          "start_date": "2025/06/01",
          "end_date": "2025-06-30 23:59"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.01152658462524414,
        "is_functional_test": false
      },
      {
        "case_name": "结束日期早于起始日期的边界条件测试",
        "purpose": "验证当end_date早于start_date时，工具是否能正确识别并拒绝该非法时间范围。",
        "args": {
          "query": "report",
          "start_date": "2025-06-30 12:00",
          "end_date": "2025-06-01 08:00"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.02700662612915039,
        "is_functional_test": false
      },
      {
        "case_name": "空查询字符串导致搜索失败的错误处理测试",
        "purpose": "验证当query参数为空字符串时，工具是否能正确处理并返回错误信息而非异常。",
        "args": {
          "query": ""
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.01898050308227539,
        "is_functional_test": false
      }
    ],
    "get_email_by_number": [
      {
        "case_name": "获取指定邮件ID的详细信息的基本功能测试",
        "purpose": "验证get_email_by_number工具能够使用有效的邮件ID成功获取邮件正文和附件信息。",
        "args": {
          "email_id": 35
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.004001617431640625,
        "is_functional_test": true
      },
      {
        "case_name": "输入无效邮件ID的安全性测试",
        "purpose": "验证当提供一个不存在或非法的邮件ID时，工具是否能安全处理并返回适当的错误信息而非暴露敏感内容。",
        "args": {
          "email_id": -1
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: -1"
        },
        "execution_time": 0.0040013790130615234,
        "is_functional_test": false
      },
      {
        "case_name": "邮件ID为零的边界条件测试",
        "purpose": "验证当邮件ID为0时，工具是否能正确识别并拒绝非法输入，防止异常行为。",
        "args": {
          "email_id": 0
        },
        "response": {
          "result": "{\n  \"subject\": \"Please sign in to your Outlook.com account\",\n  \"sender\": \"Outlook.com Team\",\n  \"received_time\": \"2025-06-30 17:04\",\n  \"body\": \"Hello Bocheng Peng, \\r\\nWe noticed some unusual activity in your Outlook.com account. To help protect you, we've temporarily blocked your account. \\r\\nWhy are you seeing this? \\r\\nSomeone may have used your account to send out a lot of junk emails or something else that violates our Terms of Service <http://explore.live.com/microsoft-service-agreement?mkt=zh-CN> . \\r\\nHow can you unblock your account? \\r\\nThe fastest way to unblock your Outlook.com account is to verify your account <https://go.microsoft.com/fwlink/?linkid=2305049> . \\r\\nIf you haven't setup a mobile phone in your account, please contact Customer Support <http://windows.microsoft.com/zh-CN/windows/outlook/account-temporarily-blocked> . \\r\\nThanks,\\r\\nThe Outlook.com Team \\r\\nMicrosoft respects your privacy. To learn more, please read our online Privacy Statement <http://go.microsoft.com/fwlink/p/?LinkId=253457> . \\r\\nMicrosoft Corporation, One Microsoft Way, Redmond, WA 98052-6399, USA © 2025 Microsoft Corporation. All rights reserved. \",\n  \"attachments\": []\n}"
        },
        "execution_time": 0.011000394821166992,
        "is_functional_test": false
      },
      {
        "case_name": "超大邮件ID的边界测试",
        "purpose": "验证工具是否能处理非常大的邮件ID值（如999999），确保不会因性能问题或整数溢出而崩溃。",
        "args": {
          "email_id": 999999
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 999999"
        },
        "execution_time": 0.005999565124511719,
        "is_functional_test": false
      },
      {
        "case_name": "邮件ID参数为空的错误处理测试",
        "purpose": "验证当未提供邮件ID参数时，工具是否能优雅地处理错误并返回明确提示。",
        "args": {},
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 1 validation error for get_email_by_numberArguments\nemail_id\n  Field required [type=missing, input_value={}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.0059931278228759766,
        "is_functional_test": false
      }
    ],
    "reply_to_email_by_number": [
      {
        "case_name": "使用有效邮件ID和文本进行基本回复功能测试",
        "purpose": "验证reply_to_email_by_number工具能够使用有效的邮件ID和回复文本成功执行邮件回复操作。",
        "args": {
          "email_id": 1,
          "reply_text": "这是一封测试回复邮件。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 1"
        },
        "execution_time": 0.005000591278076172,
        "is_functional_test": true
      },
      {
        "case_name": "尝试回复不存在的邮件ID的安全性测试",
        "purpose": "验证当用户尝试回复一个不存在的邮件ID时，工具是否能安全处理并返回适当的错误信息。",
        "args": {
          "email_id": 99999,
          "reply_text": "这是一个无效邮件ID的回复尝试。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 99999"
        },
        "execution_time": 0.003999471664428711,
        "is_functional_test": false
      },
      {
        "case_name": "邮件ID为负数时的参数验证测试",
        "purpose": "验证当邮件ID为负数时，工具是否能正确识别非法输入并拒绝操作。",
        "args": {
          "email_id": -1,
          "reply_text": "这是一封测试回复邮件。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: -1"
        },
        "execution_time": 0.008001565933227539,
        "is_functional_test": false
      },
      {
        "case_name": "邮件ID为零时的边界条件测试",
        "purpose": "验证当邮件ID为0时，工具是否能正确拒绝该无效值并提示用户。",
        "args": {
          "email_id": 0,
          "reply_text": "这是一封测试回复邮件。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: <unknown>.CreateItem"
        },
        "execution_time": 0.013997077941894531,
        "is_functional_test": false
      },
      {
        "case_name": "回复文本为空字符串的边界情况测试",
        "purpose": "验证当回复内容为空字符串时，工具是否允许发送空邮件或给出适当提示。",
        "args": {
          "email_id": 2,
          "reply_text": ""
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 2"
        },
        "execution_time": 0.008998870849609375,
        "is_functional_test": false
      },
      {
        "case_name": "包含特殊字符的回复文本兼容性测试",
        "purpose": "验证工具是否能正确处理包含特殊字符（如Unicode、表情符号）的回复内容。",
        "args": {
          "email_id": 4,
          "reply_text": "这是一封带特殊字符的回复邮件：😊🚀✅🌍🔥"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 4"
        },
        "execution_time": 0.004000425338745117,
        "is_functional_test": true
      },
      {
        "case_name": "未连接Outlook账户时尝试回复邮件的错误处理测试",
        "purpose": "验证在Outlook客户端未运行或未连接的情况下尝试回复邮件时，工具是否能优雅地处理错误并提示用户。",
        "args": {
          "email_id": 5,
          "reply_text": "Outlook未连接状态下的回复测试。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 5"
        },
        "execution_time": 0.0049991607666015625,
        "is_functional_test": false
      }
    ],
    "compose_email": [
      {
        "case_name": "使用必填参数发送邮件的基本功能测试",
        "purpose": "验证compose_email工具在提供所有必填参数（subject, body, to）时可以成功发送一封邮件。",
        "args": {
          "subject": "测试邮件主题",
          "body": "这是一封测试邮件正文内容。",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.00700068473815918,
        "is_functional_test": true
      },
      {
        "case_name": "包含可选cc参数的邮件发送测试",
        "purpose": "验证compose_email工具在提供可选参数cc时，能够正确地将邮件抄送指定地址。",
        "args": {
          "subject": "带抄送的测试邮件",
          "body": "这封邮件包含抄送人。",
          "to": "recipient@example.com",
          "cc": "cc@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.005999088287353516,
        "is_functional_test": true
      },
      {
        "case_name": "邮件主题为空的安全性测试",
        "purpose": "验证当邮件主题为空时，工具是否能安全处理并返回适当提示或默认行为。",
        "args": {
          "subject": "",
          "body": "这是一个没有主题的测试邮件。",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.010000228881835938,
        "is_functional_test": false
      },
      {
        "case_name": "收件人邮箱格式不合法的错误处理测试",
        "purpose": "验证当提供的收件人邮箱格式不合法时，工具是否能优雅地拒绝请求并提示错误。",
        "args": {
          "subject": "测试无效收件人",
          "body": "测试内容：收件人邮箱格式错误。",
          "to": "invalid-email@",
          "cc": "optional-cc@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.006998538970947266,
        "is_functional_test": false
      },
      {
        "case_name": "缺少必要参数to的边界条件测试",
        "purpose": "验证当缺少必须参数'to'时，工具是否能正确报错并阻止邮件发送。",
        "args": {
          "subject": "缺少收件人的测试邮件",
          "body": "该邮件缺少收件人地址。"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: 1 validation error for compose_emailArguments\nto\n  Field required [type=missing, input_value={'subject': '缺少收件...少收件人地址。'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.006996870040893555,
        "is_functional_test": false
      },
      {
        "case_name": "邮件正文中包含特殊字符的兼容性测试",
        "purpose": "验证compose_email工具是否能正确处理邮件正文中包含特殊字符（如中文、表情符号等）的情况。",
        "args": {
          "subject": "含特殊字符的测试邮件",
          "body": "这是一封包含特殊字符的邮件正文：😊🚀✅©®™",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.005995273590087891,
        "is_functional_test": true
      },
      {
        "case_name": "尝试发送至受限邮箱地址的安全性测试",
        "purpose": "验证当试图发送邮件到一个受限或敏感邮箱地址时，工具是否能安全处理并阻止操作。",
        "args": {
          "subject": "敏感目标地址测试",
          "body": "这是一封测试发送到受限邮箱的内容。",
          "to": "admin@internal.company.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.008002519607543945,
        "is_functional_test": false
      }
    ]
  },
  "total_cases": 42
}