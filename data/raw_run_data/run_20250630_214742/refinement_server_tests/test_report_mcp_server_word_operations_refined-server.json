{
  "server_name": "server",
  "parent_dir": "mcp_server_word_operations_refined",
  "report_name": "mcp_server_word_operations_refined-server",
  "server_path": "workspace\\refinement\\mcp_server_word_operations_refined\\server.py",
  "timestamp": "2025-06-30T22:09:33.314879",
  "tools": [
    {
      "name": "read_document_content",
      "description": "\n    读取Microsoft Word文档的内容。\n\n    Args:\n        file_path: Word文档文件的路径 (必填)。\n\n    Returns:\n        包含文档文本内容的字符串。\n\n    Raises:\n        ValueError: 如果文件路径无效或不是.docx文件。\n        FileNotFoundError: 如果指定的文件不存在。\n        Exception: 如果读取文件时发生其他错误。\n\n    示例:\n        读取位于'workspace/documents/sample.docx'的文档内容:\n        read_document_content(file_path=\"workspace/documents/sample.docx\")\n    ",
      "args_schema": {
        "properties": {
          "file_path": {
            "title": "File Path",
            "type": "string"
          }
        },
        "required": [
          "file_path"
        ],
        "title": "read_document_contentArguments",
        "type": "object"
      }
    },
    {
      "name": "create_new_document",
      "description": "\n    创建一个新的Microsoft Word文档并在其中写入内容。\n\n    Args:\n        output_path: 新文档的输出路径 (必填)。\n        content: 要写入文档的文本内容 (必填)。\n\n    Returns:\n        表示操作成功的消息。\n\n    Raises:\n        ValueError: 如果output_path无效或不以.docx结尾。\n        Exception: 如果创建或保存文档时发生错误。\n\n    示例:\n        创建一个新文档并写入内容:\n        create_new_document(output_path=\"workspace/output/new_document.docx\", content=\"这是新文档的内容。\")\n    ",
      "args_schema": {
        "properties": {
          "output_path": {
            "title": "Output Path",
            "type": "string"
          },
          "content": {
            "title": "Content",
            "type": "string"
          }
        },
        "required": [
          "output_path",
          "content"
        ],
        "title": "create_new_documentArguments",
        "type": "object"
      }
    },
    {
      "name": "insert_text_or_image",
      "description": "\n    在指定位置插入文本或图片到现有的Word文档中。\n\n    Args:\n        doc_path: 现有Word文档的路径 (必填)。\n        position: 插入内容的位置索引（段落编号）(必填)。\n        text: 要插入的文本内容 (可选)。\n        image_path: 要插入的图片文件路径 (可选)。\n\n    Returns:\n        表示操作成功的消息。\n\n    Raises:\n        ValueError: 如果输入参数无效或缺少text与image_path中的至少一个。\n        FileNotFoundError: 如果指定的文档或图片文件不存在。\n        Exception: 如果插入内容时发生错误。\n\n    示例:\n        在第2个段落后插入文本:\n        insert_text_or_image(doc_path=\"workspace/documents/sample.docx\", position=2, text=\"这是插入的文本。\")\n\n        在第3个段落后插入图片:\n        insert_text_or_image(doc_path=\"workspace/documents/sample.docx\", position=3, image_path=\"workspace/images/sample.png\")\n    ",
      "args_schema": {
        "properties": {
          "doc_path": {
            "title": "Doc Path",
            "type": "string"
          },
          "position": {
            "title": "Position",
            "type": "integer"
          },
          "text": {
            "default": null,
            "title": "Text",
            "type": "string"
          },
          "image_path": {
            "default": null,
            "title": "Image Path",
            "type": "string"
          }
        },
        "required": [
          "doc_path",
          "position"
        ],
        "title": "insert_text_or_imageArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "create_new_document": [
      {
        "case_name": "基本功能测试_创建文档并写入内容",
        "purpose": "验证工具可以正确创建一个新的Word文档并在其中写入指定内容。",
        "args": {
          "output_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\new_document_test1.docx",
          "content": "这是基本功能测试的内容。"
        },
        "response": {
          "result": "{\"message\": \"\\u65b0\\u6587\\u6863\\u5df2\\u6210\\u529f\\u521b\\u5efa: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\new_document_test1.docx\"}"
        },
        "execution_time": 0.02747178077697754,
        "is_security_test": false
      },
      {
        "case_name": "基本功能测试_覆盖已有文档",
        "purpose": "验证工具在目标路径已存在同名文档时是否能够覆盖写入。",
        "args": {
          "output_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\new_document.docx",
          "content": "这是覆盖已有文档的测试内容。"
        },
        "response": {
          "result": "{\"message\": \"\\u65b0\\u6587\\u6863\\u5df2\\u6210\\u529f\\u521b\\u5efa: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\.git\\\\new_document.docx\"}"
        },
        "execution_time": 0.025000333786010742,
        "is_security_test": false
      },
      {
        "case_name": "基本功能测试_长文本写入",
        "purpose": "验证工具在写入大量文本内容时是否正常处理。",
        "args": {
          "output_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\long_content_document.docx",
          "content": "这是一个非常长的文本内容，用于测试工具在处理大量文本写入时的表现和稳定性。重复内容：测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试。"
        },
        "response": {
          "result": "{\"message\": \"\\u65b0\\u6587\\u6863\\u5df2\\u6210\\u529f\\u521b\\u5efa: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\long_content_document.docx\"}"
        },
        "execution_time": 0.026827096939086914,
        "is_security_test": false
      },
      {
        "case_name": "边界条件测试_空内容写入",
        "purpose": "验证工具在content参数为空字符串时能否成功创建一个空文档。",
        "args": {
          "output_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\empty_content_document.docx",
          "content": ""
        },
        "response": {
          "result": "{\"message\": \"\\u65b0\\u6587\\u6863\\u5df2\\u6210\\u529f\\u521b\\u5efa: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\empty_content_document.docx\"}"
        },
        "execution_time": 0.03587985038757324,
        "is_security_test": false
      },
      {
        "case_name": "边界条件测试_最大路径长度",
        "purpose": "验证工具在输出路径达到系统最大限制（如260字符）时是否能正常处理。",
        "args": {
          "output_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\aaaaaaaaaabbbbbbbbbbccccccccccddddddddddeeeeeeeeeeffffffffffgggggggggghhhhhhhhhhiiiiiiiiiijjjjjjjjjjkkkkkkkkkkllllllllllmmmmmmmmm\\maxpath.docx",
          "content": "测试最大路径长度支持。"
        },
        "response": {
          "result": "{\"message\": \"\\u65b0\\u6587\\u6863\\u5df2\\u6210\\u529f\\u521b\\u5efa: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\aaaaaaaaaabbbbbbbbbbccccccccccddddddddddeeeeeeeeeeffffffffffgggggggggghhhhhhhhhhiiiiiiiiiijjjjjjjjjjkkkkkkkkkkllllllllllmmmmmmmmm\\\\maxpath.docx\"}"
        },
        "execution_time": 0.02599644660949707,
        "is_security_test": false
      },
      {
        "case_name": "错误处理测试_无效输出路径格式",
        "purpose": "验证当output_path参数不合法时，工具是否抛出ValueError。",
        "args": {
          "output_path": "invalid_path/new_document.docx",
          "content": "测试无效路径处理。"
        },
        "response": {
          "result": "{\"message\": \"\\u65b0\\u6587\\u6863\\u5df2\\u6210\\u529f\\u521b\\u5efa: invalid_path/new_document.docx\"}"
        },
        "execution_time": 0.029532909393310547,
        "is_security_test": false
      },
      {
        "case_name": "错误处理测试_非.docx扩展名",
        "purpose": "验证当output_path未以.docx结尾时，工具是否抛出ValueError。",
        "args": {
          "output_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\wrong_extension.txt",
          "content": "测试非.docx扩展名处理。"
        },
        "response": {
          "error": "ToolException: Error executing tool create_new_document: 创建文档时出错: output_path必须以.docx结尾。"
        },
        "execution_time": 0.0060024261474609375,
        "is_security_test": false
      },
      {
        "case_name": "错误处理测试_写入受保护文件",
        "purpose": "验证尝试写入受操作系统保护或权限不足的文件时，工具是否抛出Exception。",
        "args": {
          "output_path": "C:\\Windows\\system32\\drivers\\etc\\hosts.docx",
          "content": "尝试写入受保护目录中的文件。"
        },
        "response": {
          "error": "ToolException: Error executing tool create_new_document: 创建文档时出错: [Errno 13] Permission denied: 'C:\\\\Windows\\\\system32\\\\drivers\\\\etc\\\\hosts.docx'"
        },
        "execution_time": 0.01499795913696289,
        "is_security_test": false
      },
      {
        "case_name": "安全性测试_路径遍历攻击尝试",
        "purpose": "验证工具是否对包含路径遍历符（../）的output_path进行有效校验。",
        "args": {
          "output_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\..\\malicious_document.docx",
          "content": "测试路径遍历安全漏洞。"
        },
        "response": {
          "result": "{\"message\": \"\\u65b0\\u6587\\u6863\\u5df2\\u6210\\u529f\\u521b\\u5efa: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\..\\\\malicious_document.docx\"}"
        },
        "execution_time": 0.0259091854095459,
        "is_security_test": false
      },
      {
        "case_name": "安全性测试_特殊字符路径",
        "purpose": "验证工具是否能安全处理含有特殊字符的输出路径，防止注入攻击。",
        "args": {
          "output_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\special<chars>:\\\"|?*.docx",
          "content": "测试特殊字符路径的安全性。"
        },
        "response": {
          "error": "ToolException: Error executing tool create_new_document: 创建文档时出错: [WinError 123] 文件名、目录名或卷标语法不正确。: 'D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\special<chars>:'"
        },
        "execution_time": 0.020002126693725586,
        "is_security_test": true
      },
      {
        "case_name": "安全性测试_写入隐藏或系统文件",
        "purpose": "验证工具是否允许写入隐藏或系统属性的文件路径，防止潜在安全风险。",
        "args": {
          "output_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\hooks\\.hidden_doc.docx",
          "content": "尝试写入隐藏文件路径。"
        },
        "response": {
          "result": "{\"message\": \"\\u65b0\\u6587\\u6863\\u5df2\\u6210\\u529f\\u521b\\u5efa: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\.git\\\\hooks\\\\.hidden_doc.docx\"}"
        },
        "execution_time": 0.025265216827392578,
        "is_security_test": true
      },
      {
        "case_name": "基本功能测试_使用现有文件夹路径",
        "purpose": "验证工具是否能在指定的有效文件夹路径下生成新文档。",
        "args": {
          "output_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\new_repo\\new_file.docx",
          "content": "测试使用现有文件夹路径写入文档。"
        },
        "response": {
          "result": "{\"message\": \"\\u65b0\\u6587\\u6863\\u5df2\\u6210\\u529f\\u521b\\u5efa: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\new_repo\\\\new_file.docx\"}"
        },
        "execution_time": 0.02600550651550293,
        "is_security_test": false
      }
    ],
    "read_document_content": [
      {
        "case_name": "基本功能测试_读取有效文档内容",
        "purpose": "验证工具可以正确读取一个存在的Word文档的文本内容。",
        "args": {
          "file_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\new_document_test1.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool read_document_content: 读取文档时出错: 文件未找到: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\new_document_test1.docx"
        },
        "execution_time": 0.004998445510864258,
        "is_security_test": false
      },
      {
        "case_name": "基本功能测试_读取非空长文本文档",
        "purpose": "验证工具能够正确读取包含大量文本的Word文档内容。",
        "args": {
          "file_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\long_content_document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool read_document_content: 读取文档时出错: 文件未找到: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\long_content_document.docx"
        },
        "execution_time": 0.0050013065338134766,
        "is_security_test": false
      },
      {
        "case_name": "基本功能测试_读取空文档",
        "purpose": "验证工具在读取一个已存在但内容为空的Word文档时是否正常处理。",
        "args": {
          "file_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\empty_content_document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool read_document_content: 读取文档时出错: 文件未找到: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\empty_content_document.docx"
        },
        "execution_time": 0.005997180938720703,
        "is_security_test": false
      },
      {
        "case_name": "边界条件测试_最大路径长度文档读取",
        "purpose": "验证工具在file_path参数达到系统最大路径限制（如260字符）时能否正常读取文档。",
        "args": {
          "file_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\aaaaaaaaaabbbbbbbbbbccccccccccddddddddddeeeeeeeeeeffffffffffgggggggggghhhhhhhhhhiiiiiiiiiijjjjjjjjjjkkkkkkkkkkllllllllllmmmmmmmmm\\maxpath.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool read_document_content: 读取文档时出错: 文件未找到: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\aaaaaaaaaabbbbbbbbbbccccccccccddddddddddeeeeeeeeeeffffffffffgggggggggghhhhhhhhhhiiiiiiiiiijjjjjjjjjjkkkkkkkkkkllllllllllmmmmmmmmm\\maxpath.docx"
        },
        "execution_time": 0.0029985904693603516,
        "is_security_test": false
      },
      {
        "case_name": "错误处理测试_文件路径不存在",
        "purpose": "验证当指定的file_path不存在时，工具是否抛出FileNotFoundError。",
        "args": {
          "file_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\nonexistent_document.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool read_document_content: 读取文档时出错: 文件未找到: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\nonexistent_document.docx"
        },
        "execution_time": 0.006005287170410156,
        "is_security_test": false
      },
      {
        "case_name": "错误处理测试_无效文件格式",
        "purpose": "验证当提供的file_path指向的不是.docx文件时，工具是否抛出ValueError。",
        "args": {
          "file_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\code (1).html"
        },
        "response": {
          "error": "ToolException: Error executing tool read_document_content: 读取文档时出错: file_path必须指向一个有效的.docx文件。"
        },
        "execution_time": 0.004996061325073242,
        "is_security_test": false
      },
      {
        "case_name": "错误处理测试_读取受保护文档",
        "purpose": "验证尝试读取操作系统权限不足或受保护的文档时，工具是否抛出Exception。",
        "args": {
          "file_path": "C:\\Windows\\system32\\drivers\\etc\\hosts.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool read_document_content: 读取文档时出错: 文件未找到: C:\\Windows\\system32\\drivers\\etc\\hosts.docx"
        },
        "execution_time": 0.004000425338745117,
        "is_security_test": false
      },
      {
        "case_name": "安全性测试_路径遍历攻击尝试",
        "purpose": "验证工具是否对包含路径遍历符（../）的file_path进行有效校验，防止路径穿越漏洞。",
        "args": {
          "file_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\..\\..\\malicious_document.docx"
        },
        "response": {
          "result": "{\"content\": \"\\u6d4b\\u8bd5\\u8def\\u5f84\\u904d\\u5386\\u5b89\\u5168\\u6f0f\\u6d1e\\u3002\"}"
        },
        "execution_time": 0.014138460159301758,
        "is_security_test": false
      },
      {
        "case_name": "安全性测试_特殊字符文件路径",
        "purpose": "验证工具是否能安全处理含有特殊字符的file_path，防止注入攻击或异常行为。",
        "args": {
          "file_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\special<chars>:\\\"|?*.docx"
        },
        "response": {
          "error": "ToolException: Error executing tool read_document_content: 读取文档时出错: 文件未找到: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\special<chars>:\\\"|?*.docx"
        },
        "execution_time": 0.0035071372985839844,
        "is_security_test": true
      },
      {
        "case_name": "安全性测试_读取隐藏或系统属性文档",
        "purpose": "验证工具是否允许读取具有隐藏或系统属性的文件，防止潜在安全风险。",
        "args": {
          "file_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\hooks\\.hidden_doc.docx"
        },
        "response": {
          "result": "{\"content\": \"\\u5c1d\\u8bd5\\u5199\\u5165\\u9690\\u85cf\\u6587\\u4ef6\\u8def\\u5f84\\u3002\"}"
        },
        "execution_time": 0.014008522033691406,
        "is_security_test": true
      }
    ],
    "insert_text_or_image": [
      {
        "case_name": "基本功能测试_在指定段落插入文本",
        "purpose": "验证工具能够在指定段落位置正确插入文本内容。",
        "args": {
          "doc_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\new_document.docx",
          "position": 1,
          "text": "这是插入的文本内容。"
        },
        "response": {
          "result": "{\"message\": \"\\u5185\\u5bb9\\u5df2\\u6210\\u529f\\u63d2\\u5165\\u5230\\u6587\\u6863: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\.git\\\\new_document.docx\"}"
        },
        "execution_time": 0.018999576568603516,
        "is_security_test": false
      },
      {
        "case_name": "基本功能测试_在指定段落插入图片",
        "purpose": "验证工具能够在指定段落位置正确插入图片文件。",
        "args": {
          "doc_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\new_document.docx",
          "position": 2,
          "image_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\mas.png"
        },
        "response": {
          "result": "{\"message\": \"\\u5185\\u5bb9\\u5df2\\u6210\\u529f\\u63d2\\u5165\\u5230\\u6587\\u6863: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\.git\\\\new_document.docx\"}"
        },
        "execution_time": 0.04099893569946289,
        "is_security_test": false
      },
      {
        "case_name": "基本功能测试_同时插入文本和图片",
        "purpose": "验证工具是否支持在同一个调用中同时插入文本和图片（虽然文档说明为可选，但实际可能支持）。",
        "args": {
          "doc_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\new_document.docx",
          "position": 3,
          "text": "这是插入的文本。",
          "image_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\nature_image.jpg"
        },
        "response": {
          "result": "{\"message\": \"\\u5185\\u5bb9\\u5df2\\u6210\\u529f\\u63d2\\u5165\\u5230\\u6587\\u6863: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\.git\\\\new_document.docx\"}"
        },
        "execution_time": 0.0303955078125,
        "is_security_test": false
      },
      {
        "case_name": "边界条件测试_在文档开头插入内容",
        "purpose": "验证工具在position=0时能否正确将内容插入到文档最开始的位置。",
        "args": {
          "doc_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\new_document.docx",
          "position": 0,
          "text": "这是插入到文档开头的内容。"
        },
        "response": {
          "result": "{\"message\": \"\\u5185\\u5bb9\\u5df2\\u6210\\u529f\\u63d2\\u5165\\u5230\\u6587\\u6863: D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\.git\\\\new_document.docx\"}"
        },
        "execution_time": 0.03099846839904785,
        "is_security_test": false
      },
      {
        "case_name": "边界条件测试_在超出当前段落数量的位置插入内容",
        "purpose": "验证当position大于现有段落数量时，工具是否能将内容插入到最后。",
        "args": {
          "doc_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\new_document.docx",
          "position": 999,
          "text": "这是插入到最后的内容。"
        },
        "response": {
          "error": "ToolException: Error executing tool insert_text_or_image: 插入内容时出错: position超出范围。请提供有效的段落索引。"
        },
        "execution_time": 0.01501774787902832,
        "is_security_test": false
      },
      {
        "case_name": "错误处理测试_缺少必要参数doc_path",
        "purpose": "验证当未提供必填参数doc_path时，工具是否抛出ValueError。",
        "args": {
          "position": 2,
          "text": "测试缺少doc_path的情况。"
        },
        "response": {
          "error": "ToolException: Error executing tool insert_text_or_image: 1 validation error for insert_text_or_imageArguments\ndoc_path\n  Field required [type=missing, input_value={'position': 2, 'text': '...doc_path的情况。'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.004999637603759766,
        "is_security_test": false
      },
      {
        "case_name": "错误处理测试_缺少必要参数position",
        "purpose": "验证当未提供必填参数position时，工具是否抛出ValueError。",
        "args": {
          "doc_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\new_document.docx",
          "text": "测试缺少position的情况。"
        },
        "response": {
          "error": "ToolException: Error executing tool insert_text_or_image: 1 validation error for insert_text_or_imageArguments\nposition\n  Field required [type=missing, input_value={'doc_path': 'D:\\\\devWork...position的情况。'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.004000425338745117,
        "is_security_test": false
      },
      {
        "case_name": "错误处理测试_未提供text与image_path",
        "purpose": "验证当既没有提供text也没有提供image_path时，工具是否抛出ValueError。",
        "args": {
          "doc_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\new_document.docx",
          "position": 2
        },
        "response": {
          "error": "ToolException: Error executing tool insert_text_or_image: 插入内容时出错: 必须提供text或image_path中的至少一个。"
        },
        "execution_time": 0.015039682388305664,
        "is_security_test": false
      },
      {
        "case_name": "错误处理测试_指定的文档不存在",
        "purpose": "验证当提供的doc_path指向的文档不存在时，工具是否抛出FileNotFoundError。",
        "args": {
          "doc_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\nonexistent_document.docx",
          "position": 2,
          "text": "尝试插入到不存在的文档。"
        },
        "response": {
          "error": "ToolException: Error executing tool insert_text_or_image: 插入内容时出错: 文档未找到: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\nonexistent_document.docx"
        },
        "execution_time": 0.0070078372955322266,
        "is_security_test": false
      },
      {
        "case_name": "错误处理测试_指定的图片文件不存在",
        "purpose": "验证当提供的image_path指向的图片不存在时，工具是否抛出FileNotFoundError。",
        "args": {
          "doc_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\new_document.docx",
          "position": 2,
          "image_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\nonexistent_image.png"
        },
        "response": {
          "error": "ToolException: Error executing tool insert_text_or_image: 插入内容时出错: 图片文件未找到: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\nonexistent_image.png"
        },
        "execution_time": 0.00404810905456543,
        "is_security_test": false
      },
      {
        "case_name": "安全性测试_路径遍历攻击尝试插入到父目录",
        "purpose": "验证工具是否对包含路径遍历符（../）的doc_path或image_path进行有效校验，防止路径穿越漏洞。",
        "args": {
          "doc_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\..\\malicious_document.docx",
          "position": 1,
          "text": "测试路径遍历安全漏洞。"
        },
        "response": {
          "error": "ToolException: Error executing tool insert_text_or_image: 插入内容时出错: 文档未找到: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\..\\malicious_document.docx"
        },
        "execution_time": 0.004427194595336914,
        "is_security_test": false
      },
      {
        "case_name": "安全性测试_特殊字符路径插入",
        "purpose": "验证工具是否能安全处理含有特殊字符的doc_path或image_path，防止注入攻击或异常行为。",
        "args": {
          "doc_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\special<chars>:\\\"|?*.docx",
          "position": 1,
          "text": "测试特殊字符路径的安全性。"
        },
        "response": {
          "error": "ToolException: Error executing tool insert_text_or_image: 插入内容时出错: 文档未找到: D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\.git\\special<chars>:\\\"|?*.docx"
        },
        "execution_time": 0.008917093276977539,
        "is_security_test": true
      }
    ]
  },
  "total_cases": 34
}