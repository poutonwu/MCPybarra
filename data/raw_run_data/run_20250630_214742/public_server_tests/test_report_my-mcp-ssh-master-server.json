{
  "server_name": "server",
  "parent_dir": "my-mcp-ssh-master",
  "report_name": "my-mcp-ssh-master-server",
  "server_path": "workspace\\public-mcp-servers\\my-mcp-ssh-master\\server.py",
  "timestamp": "2025-06-30T21:51:19.464493",
  "tools": [
    {
      "name": "connect",
      "description": "Connect to SSH server\n    \n    Args:\n        session_id: Session ID, will be automatically generated if not provided（默认的服务器是10.70.0.133，已经配置了免密登录，特别说明）\n        host: SSH server hostname or IP address, defaults to SSH_HOST environment variable\n        port: SSH server port, defaults to SSH_PORT environment variable or 22\n        username: SSH username, defaults to SSH_USERNAME environment variable\n        password: SSH password, defaults to SSH_PASSWORD environment variable\n        key_path: SSH private key file path, defaults to SSH_KEY_PATH environment variable or ~/.ssh/id_rsa\n        key_passphrase: SSH private key passphrase, defaults to SSH_KEY_PASSPHRASE environment variable\n    \n    Returns:\n        Connection status\n    ",
      "args_schema": {
        "properties": {
          "host": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "default": "10.70.0.133",
            "title": "Host"
          },
          "port": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "default": "26002",
            "title": "Port"
          },
          "username": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "default": "pengbocheng",
            "title": "Username"
          },
          "password": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "default": "",
            "title": "Password"
          },
          "key_path": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Key Path"
          },
          "key_passphrase": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Key Passphrase"
          }
        },
        "title": "connectArguments",
        "type": "object"
      }
    },
    {
      "name": "disconnect",
      "description": "Disconnect from SSH server\n    \n    Args:\n        session_id: Session ID to disconnect\n    \n    Returns:\n        Disconnection status\n    ",
      "args_schema": {
        "properties": {
          "session_id": {
            "title": "Session Id",
            "type": "string"
          }
        },
        "required": [
          "session_id"
        ],
        "title": "disconnectArguments",
        "type": "object"
      }
    },
    {
      "name": "list_sessions",
      "description": "List all active SSH sessions\n    \n    Returns:\n        List containing information about all sessions\n    ",
      "args_schema": {
        "properties": {},
        "title": "list_sessionsArguments",
        "type": "object"
      }
    },
    {
      "name": "execute",
      "description": "Execute command on SSH server\n    \n    Args:\n        session_id: Session ID\n        command: Command to execute\n        stdin: Input string to provide to the command, defaults to None\n        timeout: Command timeout in seconds, defaults to 60 seconds\n    \n    Returns:\n        Command output (stdout and stderr) and exit status\n    ",
      "args_schema": {
        "properties": {
          "session_id": {
            "title": "Session Id",
            "type": "string"
          },
          "command": {
            "title": "Command",
            "type": "string"
          },
          "stdin": {
            "default": "",
            "title": "Stdin",
            "type": "string"
          },
          "timeout": {
            "default": 60,
            "title": "Timeout",
            "type": "integer"
          }
        },
        "required": [
          "session_id",
          "command"
        ],
        "title": "executeArguments",
        "type": "object"
      }
    },
    {
      "name": "upload",
      "description": "Upload file to SSH server\n    \n    Args:\n        session_id: Session ID\n        local_path: Local file path\n        remote_path: Remote file path\n    \n    Returns:\n        Dictionary containing upload status information\n    ",
      "args_schema": {
        "properties": {
          "session_id": {
            "title": "Session Id",
            "type": "string"
          },
          "local_path": {
            "title": "Local Path",
            "type": "string"
          },
          "remote_path": {
            "title": "Remote Path",
            "type": "string"
          }
        },
        "required": [
          "session_id",
          "local_path",
          "remote_path"
        ],
        "title": "uploadArguments",
        "type": "object"
      }
    },
    {
      "name": "download",
      "description": "Download file from SSH server\n    \n    Args:\n        session_id: Session ID\n        remote_path: Remote file path\n        local_path: Local file path\n    \n    Returns:\n        Dictionary containing download status information\n    ",
      "args_schema": {
        "properties": {
          "session_id": {
            "title": "Session Id",
            "type": "string"
          },
          "remote_path": {
            "title": "Remote Path",
            "type": "string"
          },
          "local_path": {
            "title": "Local Path",
            "type": "string"
          }
        },
        "required": [
          "session_id",
          "remote_path",
          "local_path"
        ],
        "title": "downloadArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "connect": [
      {
        "case_name": "Basic SSH Connection with Default Parameters",
        "purpose": "验证使用默认参数是否可以成功连接SSH服务器",
        "args": {},
        "response": {
          "result": "{\n  \"success\": true,\n  \"session_id\": \"PCEQ2GD9\"\n}"
        },
        "execution_time": 0.33230161666870117,
        "is_security_test": false
      },
      {
        "case_name": "SSH Connection with Custom Host and Port",
        "purpose": "验证通过自定义host和port参数能否成功建立SSH连接",
        "args": {
          "host": "10.70.0.133",
          "port": 26002
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"session_id\": \"tSVvfJhL\"\n}"
        },
        "execution_time": 0.3257026672363281,
        "is_security_test": false
      },
      {
        "case_name": "SSH Connection with Username and Password",
        "purpose": "验证使用用户名和密码进行SSH连接是否可行",
        "args": {
          "username": "pengbocheng",
          "password": "test_password"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"session_id\": \"KznFReKI\"\n}"
        },
        "execution_time": 0.3042914867401123,
        "is_security_test": false
      },
      {
        "case_name": "SSH Connection with Invalid Host",
        "purpose": "测试无效的主机地址是否能被正确处理",
        "args": {
          "host": "invalid_host_address"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Connection failed: [Errno 11001] getaddrinfo failed\"\n}"
        },
        "execution_time": 1.2771403789520264,
        "is_security_test": false
      },
      {
        "case_name": "SSH Connection with Invalid Port",
        "purpose": "测试无效端口（如超出范围）时的错误处理",
        "args": {
          "port": 70000
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Connection failed: [Errno None] Unable to connect to port 4464 on 10.70.0.133\"\n}"
        },
        "execution_time": 2.3518834114074707,
        "is_security_test": false
      },
      {
        "case_name": "SSH Connection with Nonexistent Private Key Path",
        "purpose": "测试提供不存在的私钥路径时的行为",
        "args": {
          "key_path": "/nonexistent/path/to/id_rsa"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Connection failed: [Errno 2] No such file or directory: '/nonexistent/path/to/id_rsa'\"\n}"
        },
        "execution_time": 0.017999649047851562,
        "is_security_test": false
      },
      {
        "case_name": "SSH Connection with Wrong Password",
        "purpose": "验证错误密码是否会导致连接失败并正确返回错误信息",
        "args": {
          "username": "pengbocheng",
          "password": "wrong_password"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"session_id\": \"guYMxTLW\"\n}"
        },
        "execution_time": 0.28919410705566406,
        "is_security_test": false
      },
      {
        "case_name": "SSH Connection with Locked User Account",
        "purpose": "模拟账户锁定情况下的连接行为",
        "args": {
          "username": "locked_user",
          "password": "any_password"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Connection failed: Authentication failed.\"\n}"
        },
        "execution_time": 2.399864435195923,
        "is_security_test": false
      },
      {
        "case_name": "SSH Connection with Empty Host",
        "purpose": "测试空host值时的行为",
        "args": {
          "host": ""
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"session_id\": \"uhUX7Sa7\"\n}"
        },
        "execution_time": 0.33403635025024414,
        "is_security_test": false
      },
      {
        "case_name": "SSH Connection with Null Host",
        "purpose": "测试null作为host值时的行为",
        "args": {
          "host": null
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"session_id\": \"h09vqPnT\"\n}"
        },
        "execution_time": 0.34565114974975586,
        "is_security_test": false
      },
      {
        "case_name": "SSH Connection with Long Username",
        "purpose": "测试超长用户名是否被正确处理或拒绝",
        "args": {
          "username": "a_very_long_username_that_exceeds_reasonable_limits_and_may_cause_issues"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Connection failed: Authentication failed.\"\n}"
        },
        "execution_time": 0.5534791946411133,
        "is_security_test": false
      },
      {
        "case_name": "SSH Connection with Special Characters in Password",
        "purpose": "验证包含特殊字符的密码是否能被正确处理",
        "args": {
          "username": "pengbocheng",
          "password": "P@ssw0rd!#&*"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"session_id\": \"VLU90jhe\"\n}"
        },
        "execution_time": 0.30388689041137695,
        "is_security_test": false
      }
    ],
    "list_sessions": [
      {
        "case_name": "Basic Functionality - List Active Sessions",
        "purpose": "验证list_sessions工具在有多个活跃会话时能正确返回会话列表",
        "args": {},
        "response": [
          "{\n  \"session_id\": \"PCEQ2GD9\",\n  \"idle_time\": \"19.4s\"\n}",
          "{\n  \"session_id\": \"tSVvfJhL\",\n  \"idle_time\": \"19.1s\"\n}",
          "{\n  \"session_id\": \"KznFReKI\",\n  \"idle_time\": \"18.8s\"\n}",
          "{\n  \"session_id\": \"guYMxTLW\",\n  \"idle_time\": \"14.8s\"\n}",
          "{\n  \"session_id\": \"uhUX7Sa7\",\n  \"idle_time\": \"12.1s\"\n}",
          "{\n  \"session_id\": \"h09vqPnT\",\n  \"idle_time\": \"11.7s\"\n}",
          "{\n  \"session_id\": \"VLU90jhe\",\n  \"idle_time\": \"10.8s\"\n}"
        ],
        "execution_time": 0.013998031616210938,
        "is_security_test": false
      },
      {
        "case_name": "Functionality with No Active Sessions",
        "purpose": "验证当没有活跃SSH会话时，list_sessions是否返回空列表",
        "args": {},
        "response": [
          "{\n  \"session_id\": \"PCEQ2GD9\",\n  \"idle_time\": \"19.4s\"\n}",
          "{\n  \"session_id\": \"tSVvfJhL\",\n  \"idle_time\": \"19.1s\"\n}",
          "{\n  \"session_id\": \"KznFReKI\",\n  \"idle_time\": \"18.8s\"\n}",
          "{\n  \"session_id\": \"guYMxTLW\",\n  \"idle_time\": \"14.8s\"\n}",
          "{\n  \"session_id\": \"uhUX7Sa7\",\n  \"idle_time\": \"12.1s\"\n}",
          "{\n  \"session_id\": \"h09vqPnT\",\n  \"idle_time\": \"11.7s\"\n}",
          "{\n  \"session_id\": \"VLU90jhe\",\n  \"idle_time\": \"10.8s\"\n}"
        ],
        "execution_time": 0.01200413703918457,
        "is_security_test": false
      },
      {
        "case_name": "Session Detail Information Check",
        "purpose": "验证list_sessions返回的每个会话信息是否包含必要的详细信息字段（如session_id, username, host等）",
        "args": {},
        "response": [
          "{\n  \"session_id\": \"PCEQ2GD9\",\n  \"idle_time\": \"19.5s\"\n}",
          "{\n  \"session_id\": \"tSVvfJhL\",\n  \"idle_time\": \"19.1s\"\n}",
          "{\n  \"session_id\": \"KznFReKI\",\n  \"idle_time\": \"18.8s\"\n}",
          "{\n  \"session_id\": \"guYMxTLW\",\n  \"idle_time\": \"14.9s\"\n}",
          "{\n  \"session_id\": \"uhUX7Sa7\",\n  \"idle_time\": \"12.1s\"\n}",
          "{\n  \"session_id\": \"h09vqPnT\",\n  \"idle_time\": \"11.7s\"\n}",
          "{\n  \"session_id\": \"VLU90jhe\",\n  \"idle_time\": \"10.9s\"\n}"
        ],
        "execution_time": 0.00899362564086914,
        "is_security_test": false
      },
      {
        "case_name": "Boundary Test - Maximum Number of Sessions",
        "purpose": "验证系统支持的最大并发SSH会话数能否被list_sessions正确识别和处理",
        "args": {},
        "response": [
          "{\n  \"session_id\": \"PCEQ2GD9\",\n  \"idle_time\": \"19.5s\"\n}",
          "{\n  \"session_id\": \"tSVvfJhL\",\n  \"idle_time\": \"19.1s\"\n}",
          "{\n  \"session_id\": \"KznFReKI\",\n  \"idle_time\": \"18.8s\"\n}",
          "{\n  \"session_id\": \"guYMxTLW\",\n  \"idle_time\": \"14.9s\"\n}",
          "{\n  \"session_id\": \"uhUX7Sa7\",\n  \"idle_time\": \"12.1s\"\n}",
          "{\n  \"session_id\": \"h09vqPnT\",\n  \"idle_time\": \"11.8s\"\n}",
          "{\n  \"session_id\": \"VLU90jhe\",\n  \"idle_time\": \"10.9s\"\n}"
        ],
        "execution_time": 0.012999296188354492,
        "is_security_test": false
      },
      {
        "case_name": "Error Handling - Invalid Session Data",
        "purpose": "测试当存在损坏或无效的会话数据时，list_sessions是否能够正常处理并返回有效会话",
        "args": {},
        "response": [
          "{\n  \"session_id\": \"PCEQ2GD9\",\n  \"idle_time\": \"19.5s\"\n}",
          "{\n  \"session_id\": \"tSVvfJhL\",\n  \"idle_time\": \"19.2s\"\n}",
          "{\n  \"session_id\": \"KznFReKI\",\n  \"idle_time\": \"18.8s\"\n}",
          "{\n  \"session_id\": \"guYMxTLW\",\n  \"idle_time\": \"14.9s\"\n}",
          "{\n  \"session_id\": \"uhUX7Sa7\",\n  \"idle_time\": \"12.1s\"\n}",
          "{\n  \"session_id\": \"h09vqPnT\",\n  \"idle_time\": \"11.8s\"\n}",
          "{\n  \"session_id\": \"VLU90jhe\",\n  \"idle_time\": \"10.9s\"\n}"
        ],
        "execution_time": 0.013997316360473633,
        "is_security_test": false
      },
      {
        "case_name": "Security Test - Unauthorized Access Attempt",
        "purpose": "验证非授权用户尝试调用list_sessions时是否被拒绝访问",
        "args": {},
        "response": [
          "{\n  \"session_id\": \"PCEQ2GD9\",\n  \"idle_time\": \"19.5s\"\n}",
          "{\n  \"session_id\": \"tSVvfJhL\",\n  \"idle_time\": \"19.2s\"\n}",
          "{\n  \"session_id\": \"KznFReKI\",\n  \"idle_time\": \"18.9s\"\n}",
          "{\n  \"session_id\": \"guYMxTLW\",\n  \"idle_time\": \"14.9s\"\n}",
          "{\n  \"session_id\": \"uhUX7Sa7\",\n  \"idle_time\": \"12.1s\"\n}",
          "{\n  \"session_id\": \"h09vqPnT\",\n  \"idle_time\": \"11.8s\"\n}",
          "{\n  \"session_id\": \"VLU90jhe\",\n  \"idle_time\": \"10.9s\"\n}"
        ],
        "execution_time": 0.014000177383422852,
        "is_security_test": false
      },
      {
        "case_name": "Security Test - Session Hijacking Attempt",
        "purpose": "模拟攻击者尝试通过list_sessions获取其他用户的会话ID进行会话劫持",
        "args": {},
        "response": [
          "{\n  \"session_id\": \"PCEQ2GD9\",\n  \"idle_time\": \"19.5s\"\n}",
          "{\n  \"session_id\": \"tSVvfJhL\",\n  \"idle_time\": \"19.2s\"\n}",
          "{\n  \"session_id\": \"KznFReKI\",\n  \"idle_time\": \"18.9s\"\n}",
          "{\n  \"session_id\": \"guYMxTLW\",\n  \"idle_time\": \"14.9s\"\n}",
          "{\n  \"session_id\": \"uhUX7Sa7\",\n  \"idle_time\": \"12.2s\"\n}",
          "{\n  \"session_id\": \"h09vqPnT\",\n  \"idle_time\": \"11.8s\"\n}",
          "{\n  \"session_id\": \"VLU90jhe\",\n  \"idle_time\": \"10.9s\"\n}"
        ],
        "execution_time": 0.010996341705322266,
        "is_security_test": false
      },
      {
        "case_name": "Security Test - Enumeration Attack",
        "purpose": "测试list_sessions是否对会话枚举攻击具有防护机制（如速率限制、身份验证）",
        "args": {},
        "response": [
          "{\n  \"session_id\": \"PCEQ2GD9\",\n  \"idle_time\": \"19.5s\"\n}",
          "{\n  \"session_id\": \"tSVvfJhL\",\n  \"idle_time\": \"19.2s\"\n}",
          "{\n  \"session_id\": \"KznFReKI\",\n  \"idle_time\": \"18.9s\"\n}",
          "{\n  \"session_id\": \"guYMxTLW\",\n  \"idle_time\": \"14.9s\"\n}",
          "{\n  \"session_id\": \"uhUX7Sa7\",\n  \"idle_time\": \"12.2s\"\n}",
          "{\n  \"session_id\": \"h09vqPnT\",\n  \"idle_time\": \"11.8s\"\n}",
          "{\n  \"session_id\": \"VLU90jhe\",\n  \"idle_time\": \"11.0s\"\n}"
        ],
        "execution_time": 0.012000560760498047,
        "is_security_test": false
      }
    ],
    "execute": [
      {
        "case_name": "Basic Command Execution with Valid Session",
        "purpose": "验证在有效会话ID下执行基本命令（如 'ls'）是否能正确返回输出和退出状态",
        "args": {
          "session_id": "PCEQ2GD9",
          "command": "ls"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"stdout\": \"2023.nlposs-1.24.pdf\\napp.ico\\n专利1_副本.docx\\n测试新建.txt\\n\",\n  \"stderr\": \"\",\n  \"exit_status\": 0\n}"
        },
        "execution_time": 0.0436549186706543,
        "is_security_test": false
      },
      {
        "case_name": "Command Execution with Standard Input",
        "purpose": "验证带标准输入的命令（如 echo 命令）是否能正常接收输入并执行",
        "args": {
          "session_id": "KznFReKI",
          "command": "cat",
          "stdin": "Hello, SSH!"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"stdout\": \"Hello, SSH!\",\n  \"stderr\": \"\",\n  \"exit_status\": 0\n}"
        },
        "execution_time": 0.055632591247558594,
        "is_security_test": false
      },
      {
        "case_name": "Command Execution with Timeout Exceeded",
        "purpose": "验证超时设置是否生效，当命令执行时间超过指定 timeout 是否会被终止",
        "args": {
          "session_id": "tSVvfJhL",
          "command": "sleep 10 && echo done",
          "timeout": 5
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"stdout\": \"done\\n\",\n  \"stderr\": \"\",\n  \"exit_status\": 0\n}"
        },
        "execution_time": 10.042349576950073,
        "is_security_test": false
      },
      {
        "case_name": "Command Execution with Empty Command",
        "purpose": "测试空命令参数是否被工具接受，并返回合理的错误或空结果",
        "args": {
          "session_id": "VLU90jhe",
          "command": ""
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"stdout\": \"\",\n  \"stderr\": \"\",\n  \"exit_status\": 0\n}"
        },
        "execution_time": 0.02308201789855957,
        "is_security_test": false
      },
      {
        "case_name": "Command Execution with Invalid Session ID",
        "purpose": "验证使用无效的 session_id 是否导致执行失败并返回适当的错误信息",
        "args": {
          "session_id": "invalid_session_id",
          "command": "whoami"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Session not found: invalid_session_id\"\n}"
        },
        "execution_time": 0.0089263916015625,
        "is_security_test": false
      },
      {
        "case_name": "Command Injection Attempt via Special Characters",
        "purpose": "模拟命令注入攻击，测试系统是否对特殊字符进行过滤或转义",
        "args": {
          "session_id": "uhUX7Sa7",
          "command": "ls; rm -rf /tmp/test"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"stdout\": \"2023.nlposs-1.24.pdf\\napp.ico\\n专利1_副本.docx\\n测试新建.txt\\n\",\n  \"stderr\": \"\",\n  \"exit_status\": 0\n}"
        },
        "execution_time": 0.03300142288208008,
        "is_security_test": false
      },
      {
        "case_name": "Command Execution with Null Session ID",
        "purpose": "验证 null 类型的 session_id 是否被拒绝并返回明确错误",
        "args": {
          "session_id": null,
          "command": "uname -a"
        },
        "response": {
          "error": "ToolException: Error executing tool execute: 1 validation error for executeArguments\nsession_id\n  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.10/v/string_type"
        },
        "execution_time": 0.006998777389526367,
        "is_security_test": false
      },
      {
        "case_name": "Command Execution with Binary File Upload via stdin",
        "purpose": "测试通过 stdin 输入二进制文件内容是否可行，验证安全性与数据完整性",
        "args": {
          "session_id": "h09vqPnT",
          "command": "base64 -d > /tmp/binary_file",
          "stdin": "UEsDBBQAAAAIAA5bXlAAAAAAAAAAAAAAAAAKAAAAYXR0YWNoZWQvLnhtbFBLAQIUAAoAAAAAADlbXlAAAAAAAAAAAAAAAAsAAAAAAAAA AQAgALSBAAAAAGF0dG FjaGVkLy54bWxfUEsBAhQAFAAAAAgADlt eUBAAAAQAAAA AAAACwAAAAAAAAABACAAtoEAAAAAYXR0YWNoZWQvLnhtbFBLAQIUAA=="
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"stdout\": \"\",\n  \"stderr\": \"base64: invalid input\\n\",\n  \"exit_status\": 1\n}"
        },
        "execution_time": 0.08551192283630371,
        "is_security_test": true
      },
      {
        "case_name": "Command Execution with Path Traversal Attempt",
        "purpose": "测试路径穿越尝试是否被阻止，确保文件系统安全",
        "args": {
          "session_id": "PCEQ2GD9",
          "command": "cat ../../../../../../etc/passwd"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"stdout\": \"root:x:0:0:root:/root:/bin/bash\\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\\nsync:x:4:65534:sync:/bin:/bin/sync\\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\\n_apt:x:42:65534::/...[截断]，共计3299字符，剩余2499字符"
        },
        "execution_time": 0.03600287437438965,
        "is_security_test": true
      },
      {
        "case_name": "Command Execution with Non-ASCII Characters in Command",
        "purpose": "测试包含非 ASCII 字符的命令是否能被正确处理或拒绝",
        "args": {
          "session_id": "KznFReKI",
          "command": "echo 北京欢迎你"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"stdout\": \"北京欢迎你\\n\",\n  \"stderr\": \"\",\n  \"exit_status\": 0\n}"
        },
        "execution_time": 0.029946327209472656,
        "is_security_test": false
      }
    ],
    "upload": [
      {
        "case_name": "Basic Upload with Valid Session and Existing File",
        "purpose": "验证使用有效会话ID和存在的本地文件是否能成功上传到远程路径",
        "args": {
          "session_id": "PCEQ2GD9",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\新建测试文档.docx",
          "remote_path": "/tmp/新建测试文档.docx"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"local_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\新建测试文档.docx\",\n  \"remote_path\": \"/tmp/新建测试文档.docx\",\n  \"session_id\": \"PCEQ2GD9\"\n}"
        },
        "execution_time": 0.13060450553894043,
        "is_security_test": false
      },
      {
        "case_name": "Upload with Nonexistent Local File",
        "purpose": "测试当指定的本地文件不存在时，工具是否能正确返回错误信息",
        "args": {
          "session_id": "KznFReKI",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\nonexistent_file.txt",
          "remote_path": "/tmp/nonexistent_file.txt"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Error uploading file: [WinError 2] 系统找不到指定的文件。: 'D:\\\\\\\\devWorkspace\\\\\\\\MCPServer-Generator\\\\\\\\testSystem\\\\\\\\testFiles\\\\\\\\nonexistent_file.txt'\"\n}"
        },
        "execution_time": 0.038513898849487305,
        "is_security_test": false
      },
      {
        "case_name": "Upload to Invalid Remote Path",
        "purpose": "验证上传到无效的远程路径（如无写权限目录）时是否能被正确处理并返回错误",
        "args": {
          "session_id": "tSVvfJhL",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\性能测试文档_100.docx",
          "remote_path": "/root/restricted_dir/uploaded_file.docx"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Error uploading file: [Errno 13] Permission denied\"\n}"
        },
        "execution_time": 0.03900718688964844,
        "is_security_test": false
      },
      {
        "case_name": "Upload with Maximum File Size",
        "purpose": "测试系统对最大支持上传文件大小的限制，确保大文件上传不会导致崩溃或超时",
        "args": {
          "session_id": "VLU90jhe",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\工业问答.mp4",
          "remote_path": "/tmp/large_upload.mp4"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"local_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\工业问答.mp4\",\n  \"remote_path\": \"/tmp/large_upload.mp4\",\n  \"session_id\": \"VLU90jhe\"\n}"
        },
        "execution_time": 2.5180416107177734,
        "is_security_test": false
      },
      {
        "case_name": "Upload with Empty Local Path",
        "purpose": "验证空字符串作为本地路径时的行为",
        "args": {
          "session_id": "uhUX7Sa7",
          "local_path": "",
          "remote_path": "/tmp/empty_localpath_file.txt"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Error uploading file: [WinError 3] 系统找不到指定的路径。: ''\"\n}"
        },
        "execution_time": 0.03651142120361328,
        "is_security_test": false
      },
      {
        "case_name": "Upload with Null Session ID",
        "purpose": "验证 null 类型的 session_id 是否被拒绝并返回明确错误",
        "args": {
          "session_id": null,
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\app.ico",
          "remote_path": "/tmp/app.ico"
        },
        "response": {
          "error": "ToolException: Error executing tool upload: 1 validation error for uploadArguments\nsession_id\n  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.10/v/string_type"
        },
        "execution_time": 0.011995077133178711,
        "is_security_test": false
      },
      {
        "case_name": "Path Traversal Attempt in Remote Path",
        "purpose": "测试尝试在远程路径中使用路径穿越，验证系统是否阻止此类操作以保障文件系统安全",
        "args": {
          "session_id": "PCEQ2GD9",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\专利1_副本.docx",
          "remote_path": "../../../../etc/专利1_副本.docx"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Error uploading file: [Errno 13] Permission denied\"\n}"
        },
        "execution_time": 0.01653885841369629,
        "is_security_test": true
      },
      {
        "case_name": "Command Injection via Remote Path",
        "purpose": "模拟通过远程路径参数注入命令，测试系统是否对特殊字符进行过滤或转义",
        "args": {
          "session_id": "h09vqPnT",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\code (1).html",
          "remote_path": "/tmp/code.html; rm -rf /tmp/test"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Error uploading file: [Errno 2] No such file\"\n}"
        },
        "execution_time": 0.04885244369506836,
        "is_security_test": false
      },
      {
        "case_name": "Upload of Executable Binary File",
        "purpose": "测试上传可执行二进制文件是否会触发安全机制（如防病毒扫描、文件类型黑名单）",
        "args": {
          "session_id": "guYMxTLW",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\mas.png",
          "remote_path": "/tmp/mas.png"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"local_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\mas.png\",\n  \"remote_path\": \"/tmp/mas.png\",\n  \"session_id\": \"guYMxTLW\"\n}"
        },
        "execution_time": 0.1185297966003418,
        "is_security_test": true
      },
      {
        "case_name": "Upload with Special Characters in Remote Path",
        "purpose": "验证包含特殊字符的远程路径是否能被正确处理或拒绝",
        "args": {
          "session_id": "KznFReKI",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\智能软件工.pptx",
          "remote_path": "/tmp/智能软件工_@#&*.pptx"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"local_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\智能软件工.pptx\",\n  \"remote_path\": \"/tmp/智能软件工_@#&*.pptx\",\n  \"session_id\": \"KznFReKI\"\n}"
        },
        "execution_time": 0.29763078689575195,
        "is_security_test": false
      }
    ],
    "download": [
      {
        "case_name": "Basic Download with Valid Session and Existing Remote File",
        "purpose": "验证使用有效会话ID和存在的远程文件是否能成功下载到本地路径",
        "args": {
          "session_id": "PCEQ2GD9",
          "remote_path": "/tmp/新建测试文档.docx",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\下载_新建测试文档.docx"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"remote_path\": \"/tmp/新建测试文档.docx\",\n  \"local_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\下载_新建测试文档.docx\",\n  \"session_id\": \"PCEQ2GD9\"\n}"
        },
        "execution_time": 0.06814718246459961,
        "is_security_test": false
      },
      {
        "case_name": "Download with Nonexistent Remote File",
        "purpose": "测试当指定的远程文件不存在时，工具是否能正确返回错误信息",
        "args": {
          "session_id": "KznFReKI",
          "remote_path": "/tmp/nonexistent_file.txt",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\下载_nonexistent_file.txt"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Error downloading file: [Errno 2] No such file\"\n}"
        },
        "execution_time": 0.016206741333007812,
        "is_security_test": false
      },
      {
        "case_name": "Download to Invalid Local Path",
        "purpose": "验证下载到无效的本地路径（如无写权限目录或路径不存在）时是否能被正确处理并返回错误",
        "args": {
          "session_id": "tSVvfJhL",
          "remote_path": "/tmp/性能测试文档_100.docx",
          "local_path": "D:\\invalid\\path\\to\\downloaded_file.docx"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Error downloading file: [Errno 2] No such file\"\n}"
        },
        "execution_time": 0.019000768661499023,
        "is_security_test": false
      },
      {
        "case_name": "Download with Maximum File Size",
        "purpose": "测试系统对最大支持下载文件大小的限制，确保大文件下载不会导致崩溃或超时",
        "args": {
          "session_id": "VLU90jhe",
          "remote_path": "/tmp/large_upload.mp4",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\下载_工业问答.mp4"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"remote_path\": \"/tmp/large_upload.mp4\",\n  \"local_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\下载_工业问答.mp4\",\n  \"session_id\": \"VLU90jhe\"\n}"
        },
        "execution_time": 1.3611514568328857,
        "is_security_test": false
      },
      {
        "case_name": "Download with Empty Remote Path",
        "purpose": "验证空字符串作为远程路径时的行为",
        "args": {
          "session_id": "uhUX7Sa7",
          "remote_path": "",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\下载_empty_remote.txt"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Error downloading file: [Errno 2] No such file\"\n}"
        },
        "execution_time": 0.024999141693115234,
        "is_security_test": false
      },
      {
        "case_name": "Download with Null Session ID",
        "purpose": "验证 null 类型的 session_id 是否被拒绝并返回明确错误",
        "args": {
          "session_id": null,
          "remote_path": "/tmp/app.ico",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\下载_app.ico"
        },
        "response": {
          "error": "ToolException: Error executing tool download: 1 validation error for downloadArguments\nsession_id\n  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.10/v/string_type"
        },
        "execution_time": 0.026998043060302734,
        "is_security_test": false
      },
      {
        "case_name": "Path Traversal Attempt in Local Path",
        "purpose": "测试尝试在本地路径中使用路径穿越，验证系统是否阻止此类操作以保障文件系统安全",
        "args": {
          "session_id": "PCEQ2GD9",
          "remote_path": "/tmp/专利1_副本.docx",
          "local_path": "..\\..\\..\\..\\Downloads\\专利1_副本.docx"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Error downloading file: [Errno 2] No such file or directory: '..\\\\\\\\..\\\\\\\\..\\\\\\\\..\\\\\\\\Downloads\\\\\\\\专利1_副本.docx'\"\n}"
        },
        "execution_time": 0.015001058578491211,
        "is_security_test": true
      },
      {
        "case_name": "Command Injection via Local Path",
        "purpose": "模拟通过本地路径参数注入命令，测试系统是否对特殊字符进行过滤或转义",
        "args": {
          "session_id": "h09vqPnT",
          "remote_path": "/tmp/code.html",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\code_download; rm -rf /tmp/test.html"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Error downloading file: [Errno 2] No such file or directory: 'D:\\\\\\\\devWorkspace\\\\\\\\MCPServer-Generator\\\\\\\\testSystem\\\\\\\\testFiles\\\\\\\\code_download; rm -rf /tmp/test.html'\"\n}"
        },
        "execution_time": 0.021001338958740234,
        "is_security_test": false
      },
      {
        "case_name": "Download of Executable Binary File",
        "purpose": "测试下载可执行二进制文件是否会触发安全机制（如防病毒扫描、文件类型黑名单）",
        "args": {
          "session_id": "guYMxTLW",
          "remote_path": "/tmp/mas.png",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\下载_mas.png"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"remote_path\": \"/tmp/mas.png\",\n  \"local_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\下载_mas.png\",\n  \"session_id\": \"guYMxTLW\"\n}"
        },
        "execution_time": 0.14103102684020996,
        "is_security_test": true
      },
      {
        "case_name": "Download with Special Characters in Local Path",
        "purpose": "验证包含特殊字符的本地路径是否能被正确处理或拒绝",
        "args": {
          "session_id": "KznFReKI",
          "remote_path": "/tmp/智能软件工_@#&*.pptx",
          "local_path": "D:\\devWorkspace\\MCPServer-Generator\\testSystem\\testFiles\\下载_智能软件工_@#&*.pptx"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Error downloading file: [Errno 22] Invalid argument: 'D:\\\\\\\\devWorkspace\\\\\\\\MCPServer-Generator\\\\\\\\testSystem\\\\\\\\testFiles\\\\\\\\下载_智能软件工_@#&*.pptx'\"\n}"
        },
        "execution_time": 0.03399801254272461,
        "is_security_test": false
      }
    ],
    "disconnect": [
      {
        "case_name": "Basic Disconnect with Valid Session ID",
        "purpose": "验证使用有效的 session_id 是否能够成功断开SSH连接",
        "args": {
          "session_id": "PCEQ2GD9"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"session_id\": \"PCEQ2GD9\"\n}"
        },
        "execution_time": 0.02699875831604004,
        "is_security_test": false
      },
      {
        "case_name": "Disconnect with Invalid Session ID",
        "purpose": "测试使用无效的 session_id 是否能正确处理并返回错误信息",
        "args": {
          "session_id": "invalid_session_id"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Session not found: invalid_session_id\"\n}"
        },
        "execution_time": 0.05046677589416504,
        "is_security_test": false
      },
      {
        "case_name": "Disconnect with Null Session ID",
        "purpose": "验证传入 null 类型的 session_id 是否被拒绝并返回明确错误",
        "args": {
          "session_id": null
        },
        "response": {
          "error": "ToolException: Error executing tool disconnect: 1 validation error for disconnectArguments\nsession_id\n  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.10/v/string_type"
        },
        "execution_time": 0.029506921768188477,
        "is_security_test": false
      },
      {
        "case_name": "Boundary Test - Long Session ID String",
        "purpose": "测试系统是否支持超长 session_id 字符串，确保边界条件下的稳定性",
        "args": {
          "session_id": "a_very_long_session_id_string_that_exceeds_normal_length_and_may_cause_issues_if_not_handled_properly"
        },
        "response": {
          "result": "{\n  \"success\": false,\n  \"error\": \"Session not found: a_very_long_session_id_string_that_exceeds_normal_length_and_may_cause_issues_if_not_handled_properly\"\n}"
        },
        "execution_time": 0.02100396156311035,
        "is_security_test": false
      },
      {
        "case_name": "Error Handling - Missing Session ID Parameter",
        "purpose": "验证当缺少必要参数 session_id 时是否能正确报错并拒绝执行",
        "args": {},
        "response": {
          "error": "ToolException: Error executing tool disconnect: 1 validation error for disconnectArguments\nsession_id\n  Field required [type=missing, input_value={}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.01902008056640625,
        "is_security_test": false
      },
      {
        "case_name": "Security Test - Attempt to Disconnect Another User's Session",
        "purpose": "模拟攻击者尝试通过已知 session_id 断开其他用户的会话，验证权限控制机制",
        "args": {
          "session_id": "tSVvfJhL"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"session_id\": \"tSVvfJhL\"\n}"
        },
        "execution_time": 0.02599358558654785,
        "is_security_test": false
      },
      {
        "case_name": "Security Test - Session Reuse After Disconnect",
        "purpose": "验证在 session_id 被断开后是否仍可被重用执行其他操作（如 execute、upload）",
        "args": {
          "session_id": "KznFReKI"
        },
        "response": {
          "result": "{\n  \"success\": true,\n  \"session_id\": \"KznFReKI\"\n}"
        },
        "execution_time": 0.03739809989929199,
        "is_security_test": false
      }
    ]
  },
  "total_cases": 57
}