{
  "server_name": "server",
  "parent_dir": "refined",
  "report_name": "gemini-2.5-pro-mcp_outlook_manager",
  "server_path": "workspace/pipeline-output-servers/gemini-2.5-pro/mcp_outlook_manager/refined/server.py",
  "timestamp": "2025-07-13T00:47:51.469838",
  "tools": [
    {
      "name": "list_folders",
      "description": "\n    Retrieves and lists all accessible email folders from the user's main Outlook mailbox.\n    This function scans the default mailbox for top-level folders and their direct subfolders,\n    providing a comprehensive list for use in other email-related functions.\n\n    Returns:\n        str: A JSON string representing a sorted list of folder names.\n             Example: '[\"Inbox\", \"Sent Items\", \"Drafts\", \"My Project Folder\"]'\n    ",
      "args_schema": {
        "properties": {},
        "title": "list_foldersArguments",
        "type": "object"
      }
    },
    {
      "name": "list_recent_emails",
      "description": "\n    Fetches a list of email summaries from a specified folder received within a given number of days.\n    The results are cached, and each email is assigned a number for subsequent operations like 'get_email_by_number'.\n    The list is sorted with the most recent emails first and is limited to the top 100 results for performance.\n\n    Args:\n        days (int): The number of past days to search for emails. Must be a positive integer.\n        folder_name (str, optional): The name of the Outlook folder to search in. Defaults to \"Inbox\".\n\n    Returns:\n        str: A JSON string representing a list of dictionaries, where each dictionary contains the\n             assigned number, subject, sender, and received time of an email. Returns an empty list if no emails are found.\n             Example: '[{\"number\": 1, \"subject\": \"Project Update\", \"from\": \"John Doe\", \"received\": \"2023-10-27 10:30\"}]'\n    ",
      "args_schema": {
        "properties": {
          "days": {
            "title": "Days",
            "type": "integer"
          },
          "folder_name": {
            "default": "Inbox",
            "title": "Folder Name",
            "type": "string"
          }
        },
        "required": [
          "days"
        ],
        "title": "list_recent_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_emails",
      "description": "\n    Searches for emails based on a keyword within a specified date range and folder.\n    The search query is applied to the email's subject, body, and sender fields.\n    The results are cached, and each email is assigned a number for subsequent operations.\n    The list is sorted with the most recent emails first and is limited to the top 100 results.\n\n    Args:\n        query (str): The keyword or phrase to search for.\n        start_date (str): The start date for the search range, formatted as 'YYYY-MM-DD'.\n        end_date (str): The end date for the search range, formatted as 'YYYY-MM-DD'.\n        folder_name (str, optional): The name of the folder to search. Defaults to \"Inbox\".\n\n    Returns:\n        str: A JSON string representing a list of dictionaries, each containing the assigned number,\n             subject, sender, and received time of a matching email. Returns an empty list if no matches are found.\n             Example: '[{\"number\": 1, \"subject\": \"Re: Project Plan\", \"from\": \"Jane Smith\", \"received\": \"2023-10-26 15:00\"}]'\n    ",
      "args_schema": {
        "properties": {
          "query": {
            "title": "Query",
            "type": "string"
          },
          "start_date": {
            "title": "Start Date",
            "type": "string"
          },
          "end_date": {
            "title": "End Date",
            "type": "string"
          },
          "folder_name": {
            "default": "Inbox",
            "title": "Folder Name",
            "type": "string"
          }
        },
        "required": [
          "query",
          "start_date",
          "end_date"
        ],
        "title": "search_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_email_by_number",
      "description": "\n    Retrieves the full details of a specific email from the cache generated by\n    `list_recent_emails` or `search_emails`, using its assigned number.\n    This provides access to the sender, recipients, subject, full body, and attachments.\n\n    Args:\n        email_number (int): The number of the email as provided in the last list. Must be a positive integer.\n\n    Returns:\n        str: A JSON string representing a dictionary with the email's details, including sender,\n             recipients (To, CC), subject, body, received time, and a list of attachment filenames.\n             Returns an error message if the number is invalid or not found in the cache.\n             Example: '{\"from\": \"sender@example.com\", \"to\": \"you@example.com\", \"cc\": \"manager@example.com\", \"subject\": \"Project Update\", \"received\": \"2023-10-27 10:30:00\", \"body\": \"Here is the latest update...\", \"attachments\": [\"report.docx\", \"data.xlsx\"]}'\n    ",
      "args_schema": {
        "properties": {
          "email_number": {
            "title": "Email Number",
            "type": "integer"
          }
        },
        "required": [
          "email_number"
        ],
        "title": "get_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "reply_to_email_by_number",
      "description": "\n    Sends a 'Reply All' to a specific email from the cached list using its assigned number.\n    The provided reply text is prepended to the original email's body in the reply.\n\n    Args:\n        email_number (int): The number of the email to reply to, from the cached list.\n        reply_body (str): The content of the reply message. Cannot be empty.\n\n    Returns:\n        str: A JSON string containing a status message confirming the action.\n             Example: '{\"status\": \"Successfully replied to email number 1.\"}'\n    ",
      "args_schema": {
        "properties": {
          "email_number": {
            "title": "Email Number",
            "type": "integer"
          },
          "reply_body": {
            "title": "Reply Body",
            "type": "string"
          }
        },
        "required": [
          "email_number",
          "reply_body"
        ],
        "title": "reply_to_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "compose_email",
      "description": "\n    Composes and sends a new email with the specified subject, body, and recipients.\n\n    Args:\n        subject (str): The subject line of the new email. Cannot be empty.\n        body (str): The main content of the email. Cannot be empty.\n        recipients (List[str]): A list of one or more email addresses for the 'To' field.\n        cc_recipients (List[str], optional): A list of email addresses for the 'CC' field. Defaults to None.\n\n    Returns:\n        str: A JSON string containing a status message confirming that the email was sent.\n             Example: '{\"status\": \"Email with subject 'New Proposal' sent successfully.\"}'\n    ",
      "args_schema": {
        "properties": {
          "subject": {
            "title": "Subject",
            "type": "string"
          },
          "body": {
            "title": "Body",
            "type": "string"
          },
          "recipients": {
            "items": {
              "type": "string"
            },
            "title": "Recipients",
            "type": "array"
          },
          "cc_recipients": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Cc Recipients"
          }
        },
        "required": [
          "subject",
          "body",
          "recipients"
        ],
        "title": "compose_emailArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "list_folders": [
      {
        "case_name": "Basic Folder Listing",
        "purpose": "验证list_folders工具能够成功列出默认邮箱中的顶级文件夹及其直接子文件夹",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.458958625793457,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Mailbox Handling",
        "purpose": "验证当邮箱中没有任何文件夹时，list_folders工具是否能返回空列表",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.031909465789795,
        "is_functional_test": true
      },
      {
        "case_name": "Folder Name Sorting",
        "purpose": "验证返回的文件夹列表是否按字母顺序正确排序",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.2045986652374268,
        "is_functional_test": true
      },
      {
        "case_name": "Special Character Folder Names",
        "purpose": "验证包含特殊字符的文件夹名称能否被正确识别并返回",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.042076587677002,
        "is_functional_test": true
      },
      {
        "case_name": "Hidden System Folders Visibility",
        "purpose": "验证系统隐藏或内部使用的邮件文件夹（如'\\Inbox\\Rules'）是否出现在结果中",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.6872155666351318,
        "is_functional_test": true
      },
      {
        "case_name": "Access Denied to Subfolders",
        "purpose": "验证用户对某些子文件夹无访问权限时，这些文件夹是否不会出现在结果中",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.0639121532440186,
        "is_functional_test": true
      },
      {
        "case_name": "Mailbox Connection Failure",
        "purpose": "模拟无法连接到用户邮箱的情况，验证工具是否能优雅处理连接失败",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.15122389793396,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Credentials Handling",
        "purpose": "验证使用无效凭据尝试访问邮箱时，工具是否能安全拒绝访问并返回错误信息",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.2765767574310303,
        "is_functional_test": false
      }
    ],
    "list_recent_emails": [
      {
        "case_name": "Basic Email Listing",
        "purpose": "验证list_recent_emails工具能够成功列出Inbox中最近7天的邮件摘要",
        "args": {
          "days": 7
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.020532608032226562,
        "is_functional_test": true
      },
      {
        "case_name": "Custom Folder Search",
        "purpose": "验证list_recent_emails工具可以指定搜索非默认文件夹（如Sent Items）中的邮件",
        "args": {
          "days": 30,
          "folder_name": "Sent Items"
        },
        "response": {
          "result": "[{\"number\": 1, \"subject\": \"Meeting Reminder\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-13 00:44\"}, {\"number\": 2, \"subject\": \"Reminder\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-13 00:44\"}, {\"number\": 3, \"subject\": \"\\u4f1a\\u8bae\\u786e\\u8ba4\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:52\"}, {\"number\": 4, \"subject\": \"\\u9879\\u76ee\\u66f4\\u65b0\\u901a\\u77e5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:52\"}, {\"number\": 5, \"subject\": \"Test Email\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:45\"}, {\"number\": 6, \"subject\": \"Email with CC\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:45\"}, {\"number\": 7, \"subject\": \"Email with CC\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:39\"}, {\"number\": 8, \"subject\": \"Test Email\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:38\"}, {\"number\": 9, \"subject\": \"\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:19\"}, {\"number\": 10, \"subject\": \"\\u542bCC\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:19\"}, {\"number\": 11, \"subject\": \"Test Subject\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:18\"}, {\"number\": 12, \"subject\": \"\\u4e2d\\u6587\\u6d4b\\u8bd5\\u4e3b\\u9898\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:18\"}, {\"number\": 13, \"subject\": \"\\u90ae\\u4ef6\\u6d4b\\u8bd5 - \\u4e2d\\u6587\\u4e3b\\u9898\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:16\"}, {\"number\": 14, \"subject\": \"Test Subject\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计13213字符，剩余11713字符"
        },
        "execution_time": 6.65675687789917,
        "is_functional_test": true
      },
      {
        "case_name": "Zero Day Search",
        "purpose": "验证当days参数为0时，工具是否返回错误或合理提示",
        "args": {
          "days": 0
        },
        "response": {
          "result": "{\"error\": \"Parameter 'days' must be a positive integer.\"}"
        },
        "execution_time": 0.004000663757324219,
        "is_functional_test": false
      },
      {
        "case_name": "Negative Days Input",
        "purpose": "验证当days参数为负数时，工具是否进行参数校验并返回错误信息",
        "args": {
          "days": -5
        },
        "response": {
          "result": "{\"error\": \"Parameter 'days' must be a positive integer.\"}"
        },
        "execution_time": 0.0040225982666015625,
        "is_functional_test": false
      },
      {
        "case_name": "Special Character Folder",
        "purpose": "验证包含特殊字符的文件夹名称能否被正确识别并检索邮件",
        "args": {
          "days": 14,
          "folder_name": "测试文件夹\\u6d4b\\u8bd5\\u6587\\u4ef6\\u5939"
        },
        "response": {
          "result": "{\"error\": \"Folder '\\u6d4b\\u8bd5\\u6587\\u4ef6\\u5939\\\\u6d4b\\\\u8bd5\\\\u6587\\\\u4ef6\\\\u5939' not found in Outlook.\"}"
        },
        "execution_time": 1.4376327991485596,
        "is_functional_test": true
      },
      {
        "case_name": "No Emails in Time Range",
        "purpose": "验证在指定时间范围内没有邮件时，工具是否返回空列表",
        "args": {
          "days": 1
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.022272825241088867,
        "is_functional_test": true
      },
      {
        "case_name": "Maximum Days Limit",
        "purpose": "验证工具对最大天数限制的处理（如999天）",
        "args": {
          "days": 999
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: <unknown>.ReceivedTime\"}"
        },
        "execution_time": 0.021062135696411133,
        "is_functional_test": true
      },
      {
        "case_name": "Long Term Archive Search",
        "purpose": "验证工具是否能正确处理超过一年的邮件检索请求",
        "args": {
          "days": 365,
          "folder_name": "Archive"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.5424039363861084,
        "is_functional_test": true
      }
    ],
    "search_emails": [
      {
        "case_name": "Basic Email Search",
        "purpose": "验证使用基本关键词、日期范围和默认文件夹（Inbox）能否正确搜索到邮件",
        "args": {
          "query": "meeting",
          "start_date": "2023-10-01",
          "end_date": "2023-10-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.022508621215820312,
        "is_functional_test": true
      },
      {
        "case_name": "Search in Sent Items",
        "purpose": "验证能否在非默认文件夹（如Sent Items）中搜索邮件",
        "args": {
          "query": "report",
          "start_date": "2023-09-01",
          "end_date": "2023-09-30",
          "folder_name": "Sent Items"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.014637470245361328,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Search Result",
        "purpose": "验证当没有匹配邮件时工具是否返回空列表",
        "args": {
          "query": "nonexistentkeyword",
          "start_date": "2023-01-01",
          "end_date": "2023-01-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.020088911056518555,
        "is_functional_test": true
      },
      {
        "case_name": "Chinese Keyword Search",
        "purpose": "验证中文关键词能否正确搜索邮件",
        "args": {
          "query": "项目更新",
          "start_date": "2023-10-01",
          "end_date": "2023-10-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.015329837799072266,
        "is_functional_test": true
      },
      {
        "case_name": "Search with Special Characters",
        "purpose": "验证包含特殊字符的关键词能否正确搜索邮件",
        "args": {
          "query": "urgent!",
          "start_date": "2023-10-01",
          "end_date": "2023-10-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.016358613967895508,
        "is_functional_test": true
      },
      {
        "case_name": "Start Date Equals End Date",
        "purpose": "验证起始日期和结束日期相同时的搜索行为",
        "args": {
          "query": "reminder",
          "start_date": "2023-10-15",
          "end_date": "2023-10-15"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.016804218292236328,
        "is_functional_test": true
      },
      {
        "case_name": "Date Range Boundary Search",
        "purpose": "验证跨越日期边界的搜索是否正常工作",
        "args": {
          "query": "annual",
          "start_date": "2022-12-31",
          "end_date": "2023-01-01"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.016446352005004883,
        "is_functional_test": true
      },
      {
        "case_name": "SQL Injection Attempt",
        "purpose": "验证工具是否对SQL注入尝试进行安全处理",
        "args": {
          "query": "test'; DROP TABLE emails;",
          "start_date": "2023-01-01",
          "end_date": "2023-12-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u65e0\\u6cd5\\u5206\\u6790\\u6761\\u4ef6\\u3002\\u9519\\u8bef\\u4f4d\\u7f6e\\u5728\\u201c;\\u201d\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.015999555587768555,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Date Format",
        "purpose": "验证工具是否对错误日期格式进行参数校验并返回错误信息",
        "args": {
          "query": "error",
          "start_date": "2023/10/01",
          "end_date": "2023/10/31"
        },
        "response": {
          "result": "{\"error\": \"Invalid date format. Please use 'YYYY-MM-DD'.\"}"
        },
        "execution_time": 0.002998828887939453,
        "is_functional_test": false
      },
      {
        "case_name": "Missing Required Parameters",
        "purpose": "验证工具是否对缺失必填参数进行校验并返回错误信息",
        "args": {
          "query": "missing"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: 2 validation errors for search_emailsArguments\nstart_date\n  Field required [type=missing, input_value={'query': 'missing'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing\nend_date\n  Field required [type=missing, input_value={'query': 'missing'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.004000663757324219,
        "is_functional_test": false
      },
      {
        "case_name": "Empty Query",
        "purpose": "验证空搜索关键词是否被允许或返回错误信息",
        "args": {
          "query": "",
          "start_date": "2023-01-01",
          "end_date": "2023-01-31"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.01799464225769043,
        "is_functional_test": false
      },
      {
        "case_name": "End Date Before Start Date",
        "purpose": "验证结束日期早于开始日期时是否进行参数校验并返回错误信息",
        "args": {
          "query": "conflict",
          "start_date": "2023-10-31",
          "end_date": "2023-10-01"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.016002655029296875,
        "is_functional_test": false
      },
      {
        "case_name": "Search with Maximum Results",
        "purpose": "验证工具是否限制结果为最多100条",
        "args": {
          "query": "email",
          "start_date": "2020-01-01",
          "end_date": "2023-12-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.02069854736328125,
        "is_functional_test": true
      }
    ],
    "get_email_by_number": [
      {
        "case_name": "Basic Email Retrieval",
        "purpose": "验证get_email_by_number工具能够成功从缓存中检索指定编号的完整邮件详情",
        "args": {
          "email_number": 1
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.007508993148803711,
        "is_functional_test": true
      },
      {
        "case_name": "Invalid Email Number Handling",
        "purpose": "验证当提供负数作为邮件编号时，工具是否返回错误信息",
        "args": {
          "email_number": -1
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.007579326629638672,
        "is_functional_test": false
      },
      {
        "case_name": "Non-Existent Email Number",
        "purpose": "验证当请求不存在的邮件编号时，工具是否返回错误提示",
        "args": {
          "email_number": 99999
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 99999. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.009523153305053711,
        "is_functional_test": false
      },
      {
        "case_name": "Zero as Email Number",
        "purpose": "验证当邮件编号为0时，工具是否进行参数校验并返回错误信息",
        "args": {
          "email_number": 0
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.009001970291137695,
        "is_functional_test": false
      },
      {
        "case_name": "Email Cache Expiry Test",
        "purpose": "验证在邮件缓存过期后尝试获取邮件是否返回错误信息",
        "args": {
          "email_number": 2
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 2. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.00810861587524414,
        "is_functional_test": false
      },
      {
        "case_name": "Special Character in Email Content",
        "purpose": "验证包含特殊字符的邮件内容能否被正确解析并返回",
        "args": {
          "email_number": 3
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 3. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.009510040283203125,
        "is_functional_test": true
      },
      {
        "case_name": "Attachment Presence Check",
        "purpose": "验证带有附件的邮件能否被正确识别并列出附件文件名",
        "args": {
          "email_number": 4
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 4. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.01652383804321289,
        "is_functional_test": true
      },
      {
        "case_name": "Maximum Valid Email Number",
        "purpose": "验证工具对最大有效邮件编号的处理能力（如系统允许的最大整数值）",
        "args": {
          "email_number": 2147483647
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 2147483647. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.011125802993774414,
        "is_functional_test": false
      }
    ],
    "reply_to_email_by_number": [
      {
        "case_name": "Basic Reply All Functionality",
        "purpose": "验证reply_to_email_by_number工具能够成功向指定邮件发送Reply All",
        "args": {
          "email_number": 1,
          "reply_body": "This is a test reply to confirm the functionality."
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.008991479873657227,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Reply Body Handling",
        "purpose": "验证当reply_body为空时，工具是否返回错误提示",
        "args": {
          "email_number": 2,
          "reply_body": ""
        },
        "response": {
          "result": "{\"error\": \"Parameter 'reply_body' cannot be empty.\"}"
        },
        "execution_time": 0.004001617431640625,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Email Number Handling",
        "purpose": "验证当提供的email_number不存在或无效时，工具是否能正确处理",
        "args": {
          "email_number": 999,
          "reply_body": "This reply should not be sent due to invalid email number."
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 999. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.011000871658325195,
        "is_functional_test": false
      },
      {
        "case_name": "Special Characters in Reply Body",
        "purpose": "验证包含特殊字符的回复内容能否被正确发送",
        "args": {
          "email_number": 3,
          "reply_body": "This reply contains special characters: !@#$%^&*()_+{}[]|\\:\"<>?~`"
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 3. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.011594295501708984,
        "is_functional_test": true
      },
      {
        "case_name": "Negative Email Number Handling",
        "purpose": "验证当email_number为负数时，工具是否进行参数校验并返回错误信息",
        "args": {
          "email_number": -1,
          "reply_body": "This reply should not be sent due to negative email number."
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.005311012268066406,
        "is_functional_test": false
      },
      {
        "case_name": "Non-Integer Email Number Handling",
        "purpose": "验证当email_number不是整数时，工具是否拒绝执行",
        "args": {
          "email_number": 2.5,
          "reply_body": "This reply should not be sent due to non-integer email number."
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 1 validation error for reply_to_email_by_numberArguments\nemail_number\n  Input should be a valid integer, got a number with a fractional part [type=int_from_float, input_value=2.5, input_type=float]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_from_float"
        },
        "execution_time": 0.00400233268737793,
        "is_functional_test": false
      },
      {
        "case_name": "Security Check for Sensitive Data Exposure",
        "purpose": "验证工具在回复邮件时不会泄露敏感系统数据或内部结构",
        "args": {
          "email_number": 5,
          "reply_body": "This reply should not expose any internal or sensitive data."
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 5. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.016531944274902344,
        "is_functional_test": true
      }
    ],
    "compose_email": [
      {
        "case_name": "Basic Email Composition",
        "purpose": "验证compose_email工具能正常发送一封包含主题、正文和收件人的邮件",
        "args": {
          "subject": "Test Email",
          "body": "This is a test email body.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"status\": \"Email with subject 'Test Email' sent successfully.\"}"
        },
        "execution_time": 6.222223997116089,
        "is_functional_test": true
      },
      {
        "case_name": "Email with CC Recipients",
        "purpose": "验证compose_email工具能正确添加CC收件人",
        "args": {
          "subject": "Email with CC",
          "body": "This email includes a CC recipient.",
          "recipients": [
            "test@example.com"
          ],
          "cc_recipients": [
            "cc@example.com"
          ]
        },
        "response": {
          "error": "Tool call 'compose_email' was cancelled."
        },
        "execution_time": 39.99051642417908,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Subject Validation",
        "purpose": "验证compose_email工具对空主题的参数校验",
        "args": {
          "subject": "",
          "body": "This email has an empty subject.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Parameter 'subject' cannot be empty.\"}"
        },
        "execution_time": 4.342953205108643,
        "is_functional_test": false
      },
      {
        "case_name": "Empty Body Validation",
        "purpose": "验证compose_email工具对空正文的参数校验",
        "args": {
          "subject": "Test Email",
          "body": "",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Parameter 'body' cannot be empty.\"}"
        },
        "execution_time": 0.004999876022338867,
        "is_functional_test": false
      },
      {
        "case_name": "No Recipients Validation",
        "purpose": "验证compose_email工具对空收件人列表的参数校验",
        "args": {
          "subject": "Test Email",
          "body": "This email has no recipients.",
          "recipients": []
        },
        "response": {
          "result": "{\"error\": \"Parameter 'recipients' list cannot be empty.\"}"
        },
        "execution_time": 0.007237911224365234,
        "is_functional_test": false
      },
      {
        "case_name": "Special Characters in Subject",
        "purpose": "验证compose_email工具是否能正确处理包含特殊字符的主题",
        "args": {
          "subject": "测试邮件 - Test Email @2025",
          "body": "This email contains special characters in the subject line.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"status\": \"Email with subject '\\u6d4b\\u8bd5\\u90ae\\u4ef6 - Test Email @2025' sent successfully.\"}"
        },
        "execution_time": 6.14377498626709,
        "is_functional_test": true
      },
      {
        "case_name": "Long Subject Line",
        "purpose": "验证compose_email工具对超长主题行的处理能力",
        "args": {
          "subject": "A very long subject line that exceeds the typical length limits of most email clients and servers to test how the system handles it.",
          "body": "Testing long subject line handling.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.5007061958312988,
        "is_functional_test": true
      },
      {
        "case_name": "Multiple Recipients",
        "purpose": "验证compose_email工具是否能正确发送给多个收件人",
        "args": {
          "subject": "Email to Multiple Recipients",
          "body": "This email is sent to multiple recipients.",
          "recipients": [
            "user1@example.com",
            "user2@example.com",
            "user3@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.403073787689209,
        "is_functional_test": true
      }
    ]
  },
  "total_cases": 52
}