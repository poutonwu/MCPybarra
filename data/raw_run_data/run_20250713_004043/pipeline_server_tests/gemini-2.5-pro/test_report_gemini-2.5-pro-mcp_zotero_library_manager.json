{
  "server_name": "server",
  "parent_dir": "refined",
  "report_name": "gemini-2.5-pro-mcp_zotero_library_manager",
  "server_path": "workspace/pipeline-output-servers/gemini-2.5-pro/mcp_zotero_library_manager/refined/server.py",
  "timestamp": "2025-07-13T00:50:14.505703",
  "tools": [
    {
      "name": "get_item_metadata",
      "description": "Retrieves the complete metadata for a single item in the Zotero library using its unique item key.\n\n    This function fetches all available metadata for a given Zotero item,\n    including title, authors, publication date, abstract, tags, and other\n    bibliographic details. The result is returned as a formatted JSON string.\n\n    Args:\n        item_key (str): The unique identifier for the Zotero item.\n                        Example: \"ABCDE123\"\n\n    Returns:\n        str: A JSON string containing the detailed metadata of the specified\n             Zotero item. If the item is not found, an error will be raised.\n    ",
      "args_schema": {
        "properties": {
          "item_key": {
            "title": "Item Key",
            "type": "string"
          }
        },
        "required": [
          "item_key"
        ],
        "title": "get_item_metadataArguments",
        "type": "object"
      }
    },
    {
      "name": "get_item_fulltext",
      "description": "Extracts and returns the full text content from the primary PDF attachment of a specified Zotero item.\n\n    This function locates the first PDF attachment associated with the given\n    Zotero item key, downloads it, and extracts all text content from its pages.\n    It is useful for obtaining the complete text of an article or document for\n    analysis or summarization.\n\n    Args:\n        item_key (str): The unique identifier for the Zotero item.\n                        Example: \"ABCDE123\"\n\n    Returns:\n        str: A string containing the complete, extracted plain text from the\n             item's PDF attachment. Returns a message if no PDF attachment\n             or full text is available.\n    ",
      "args_schema": {
        "properties": {
          "item_key": {
            "title": "Item Key",
            "type": "string"
          }
        },
        "required": [
          "item_key"
        ],
        "title": "get_item_fulltextArguments",
        "type": "object"
      }
    },
    {
      "name": "search_items",
      "description": "Performs a flexible search within the Zotero library and returns key metadata.\n\n    This function searches the Zotero library based on a query string. It can\n    search across all fields ('everything') or be restricted to specific fields\n    like 'title', 'creator' (author), or 'year'. The results are formatted\n    into a concise JSON list, each entry containing the item key, title,\n    creators, and publication year.\n\n    Args:\n        query (str): The search term or phrase to look for.\n                     Example: \"machine learning\"\n        search_field (str, optional): The specific field to search within.\n                                      Accepted values are 'title', 'creator',\n                                      'year', or 'everything'.\n                                      Defaults to 'everything'.\n                                      Example: \"title\"\n        limit (int, optional): The maximum number of search results to return.\n                               Defaults to 25.\n                               Example: 50\n\n    Returns:\n        str: A JSON string representing a list of found Zotero items with their\n             key metadata. Returns an empty list if no items are found.\n    ",
      "args_schema": {
        "properties": {
          "query": {
            "title": "Query",
            "type": "string"
          },
          "search_field": {
            "default": "everything",
            "title": "Search Field",
            "type": "string"
          },
          "limit": {
            "default": 25,
            "title": "Limit",
            "type": "integer"
          }
        },
        "required": [
          "query"
        ],
        "title": "search_itemsArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "search_items": [
      {
        "case_name": "Basic Search Everything",
        "purpose": "验证使用默认参数搜索所有字段时是否能正确返回结果",
        "args": {
          "query": "machine learning"
        },
        "response": {
          "result": "[\n  {\n    \"item_key\": \"NZ26PJJX\",\n    \"title\": \"Preprint PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"KRR7MFVP\",\n    \"title\": \"Snapshot\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"LMA2MAZI\",\n    \"title\": \"Preprint PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"2KZXQ6VA\",\n    \"title\": \"Preprint PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"B3NCUKMS\",\n    \"title\": \"Full Text PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"A5E93YJH\",\n    \"title\": \"Preprint PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"Z77YLWKR\",\n    \"title\": \"Paper2Code: Automating Code Generation from Scientific Papers in Machine Learning\",\n    \"creators\": \"Minju Seo, Jinheon Baek, Seongyun Lee, Sung Ju Hwang\",\n    \"year\": \"2025\"\n  },\n  {\n    \"item_key\": \"SX53YT7P\",\n    \"title\": \"Snapshot\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"622TDTIG\",\n    \"title\": \"Preprint PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"Z4JH5ZDJ\",\n    \"title\": \"Full Text PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"GTC98IZM\",\n    \"title\": \"Full Text PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"3YA8V4DU\",\n    \"title\": \"Full Text PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"WBY49UCP\",\n    \"title\": \"PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"9CGWNRQN\",\n    \"title\": \"PDF...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计2664字符，剩余1164字符"
        },
        "execution_time": 22.058675289154053,
        "is_functional_test": true
      },
      {
        "case_name": "Search By Title",
        "purpose": "验证指定在标题字段中搜索是否有效",
        "args": {
          "query": "machine learning",
          "search_field": "title"
        },
        "response": {
          "result": "[\n  {\n    \"item_key\": \"Z77YLWKR\",\n    \"title\": \"Paper2Code: Automating Code Generation from Scientific Papers in Machine Learning\",\n    \"creators\": \"Minju Seo, Jinheon Baek, Seongyun Lee, Sung Ju Hwang\",\n    \"year\": \"2025\"\n  }\n]"
        },
        "execution_time": 1.1556458473205566,
        "is_functional_test": true
      },
      {
        "case_name": "Search By Creator",
        "purpose": "验证指定在作者字段中搜索是否有效",
        "args": {
          "query": "John Doe",
          "search_field": "creator"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.5639047622680664,
        "is_functional_test": true
      },
      {
        "case_name": "Search By Year",
        "purpose": "验证按年份字段搜索是否有效",
        "args": {
          "query": "2021",
          "search_field": "year"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.4873778820037842,
        "is_functional_test": true
      },
      {
        "case_name": "Limit Results",
        "purpose": "验证限制返回结果数量的参数是否生效",
        "args": {
          "query": "AI",
          "limit": 5
        },
        "response": {
          "result": "[\n  {\n    \"item_key\": \"NZ26PJJX\",\n    \"title\": \"Preprint PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"2KZXQ6VA\",\n    \"title\": \"Preprint PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"B3NCUKMS\",\n    \"title\": \"Full Text PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  },\n  {\n    \"item_key\": \"RVDXBR5Q\",\n    \"title\": \"ChatDev: Communicative Agents for Software Development\",\n    \"creators\": \"Chen Qian, Wei Liu, Hongzhang Liu, Nuo Chen, Yufan Dang, Jiahao Li, Cheng Yang, Weize Chen, Yusheng Su, Xin Cong, Juyuan Xu, Dahai Li, Zhiyuan Liu, Maosong Sun\",\n    \"year\": \"2024\"\n  },\n  {\n    \"item_key\": \"A5E93YJH\",\n    \"title\": \"Preprint PDF\",\n    \"creators\": \"\",\n    \"year\": null\n  }\n]"
        },
        "execution_time": 3.639857530593872,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Query",
        "purpose": "验证空查询是否安全处理并返回空列表",
        "args": {
          "query": ""
        },
        "response": {
          "error": "ToolException: Error executing tool search_items: Parameter 'query' must be a non-empty string."
        },
        "execution_time": 0.004001140594482422,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Search Field",
        "purpose": "验证无效的搜索字段是否被安全处理",
        "args": {
          "query": "test",
          "search_field": "invalid_field"
        },
        "response": {
          "error": "ToolException: Error executing tool search_items: Parameter 'search_field' must be one of 'title', 'creator', 'year', or 'everything'."
        },
        "execution_time": 0.010000228881835938,
        "is_functional_test": false
      },
      {
        "case_name": "Special Characters In Query",
        "purpose": "验证包含特殊字符的查询是否能正常处理",
        "args": {
          "query": "quantum@computing!<>{}[]"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 4.588993310928345,
        "is_functional_test": true
      }
    ],
    "get_item_metadata": [
      {
        "case_name": "Get Metadata For Valid Item",
        "purpose": "验证使用有效的item_key能否正确获取Zotero条目的完整元数据",
        "args": {
          "item_key": "Z77YLWKR"
        },
        "response": {
          "result": "{\n  \"key\": \"Z77YLWKR\",\n  \"version\": 641,\n  \"library\": {\n    \"type\": \"user\",\n    \"id\": 16026771,\n    \"name\": \"zhihutangjiang\",\n    \"links\": {\n      \"alternate\": {\n        \"href\": \"https://www.zotero.org/zhihutangjiang\",\n        \"type\": \"text/html\"\n      }\n    }\n  },\n  \"links\": {\n    \"self\": {\n      \"href\": \"https://api.zotero.org/users/16026771/items/Z77YLWKR\",\n      \"type\": \"application/json\"\n    },\n    \"alternate\": {\n      \"href\": \"https://www.zotero.org/zhihutangjiang/items/Z77YLWKR\",\n      \"type\": \"text/html\"\n    },\n    \"attachment\": {\n      \"href\": \"https://api.zotero.org/users/16026771/items/UUQAMGR2\",\n      \"type\": \"application/json\",\n      \"attachmentType\": \"application/pdf\",\n      \"attachmentSize\": 2741809\n    }\n  },\n  \"meta\": {\n    \"creatorSummary\": \"Seo et al.\",\n    \"parsedDate\": \"2025-05-18\",\n    \"numChildren\": 2\n  },\n  \"data\": {\n    \"key\": \"Z77YLWKR\",\n    \"version\": 641,\n    \"itemType\": \"preprint\",\n    \"title\": \"Paper2Code: Automating Code Generation from Scientific Papers in Machine Learning\",\n    \"creators\": [\n      {\n        \"creatorType\": \"author\",\n        \"firstName\": \"Minju\",\n        \"lastName\": \"Seo\"\n      },\n      {\n        \"creatorType\": \"author\",\n        \"firstName\": \"Jinheon\",\n        \"lastName\": \"Baek\"\n      },\n      {\n        \"creatorType\": \"author\",\n        \"firstName\": \"Seongyun\",\n        \"lastName\": \"Lee\"\n      },\n      {\n        \"creatorType\": \"author\",\n        \"firstName\": \"Sung Ju\",\n        \"lastName\": \"Hwang\"\n      }\n    ],\n    \"abstractNote\": ...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计3830字符，剩余2330字符"
        },
        "execution_time": 7.1920905113220215,
        "is_functional_test": true
      },
      {
        "case_name": "Get Metadata With Invalid Item Key",
        "purpose": "验证提供无效的item_key时是否能正确抛出错误",
        "args": {
          "item_key": "INVALIDKEY123"
        },
        "response": {
          "error": "ToolException: Error executing tool get_item_metadata: An error occurred while fetching item metadata: \nCode: 404\nURL: https://api.zotero.org/users/16026771/items/INVALIDKEY123?locale=en-US&format=json&limit=100\nMethod: GET\nResponse: Not found"
        },
        "execution_time": 0.4348416328430176,
        "is_functional_test": false
      },
      {
        "case_name": "Get Metadata For Nonexistent Item",
        "purpose": "验证当提供的item_key不存在于库中时是否能安全处理并返回错误信息",
        "args": {
          "item_key": "XYZ987654"
        },
        "response": {
          "error": "ToolException: Error executing tool get_item_metadata: An error occurred while fetching item metadata: \nCode: 404\nURL: https://api.zotero.org/users/16026771/items/XYZ987654?locale=en-US&format=json&limit=100\nMethod: GET\nResponse: Not found"
        },
        "execution_time": 0.4704854488372803,
        "is_functional_test": false
      },
      {
        "case_name": "Get Metadata With Empty Item Key",
        "purpose": "验证空字符串作为item_key输入时是否被正确拒绝",
        "args": {
          "item_key": ""
        },
        "response": {
          "error": "ToolException: Error executing tool get_item_metadata: Parameter 'item_key' must be a non-empty string."
        },
        "execution_time": 0.0039997100830078125,
        "is_functional_test": false
      },
      {
        "case_name": "Get Metadata With Special Characters In Key",
        "purpose": "验证包含特殊字符的item_key是否被安全处理",
        "args": {
          "item_key": "SPECIAL@#KEY!"
        },
        "response": {
          "error": "ToolException: Error executing tool get_item_metadata: An error occurred while fetching item metadata: \nCode: 404\nURL: https://api.zotero.org/users/16026771/items/SPECIAL%40%23KEY%21?locale=en-US&format=json&limit=100\nMethod: GET\nResponse: Not found"
        },
        "execution_time": 0.46234822273254395,
        "is_functional_test": false
      },
      {
        "case_name": "Get Metadata From Large Library",
        "purpose": "验证在大型库中获取一个条目元数据的性能和准确性",
        "args": {
          "item_key": "NZ26PJJX"
        },
        "response": {
          "result": "{\n  \"key\": \"NZ26PJJX\",\n  \"version\": 724,\n  \"library\": {\n    \"type\": \"user\",\n    \"id\": 16026771,\n    \"name\": \"zhihutangjiang\",\n    \"links\": {\n      \"alternate\": {\n        \"href\": \"https://www.zotero.org/zhihutangjiang\",\n        \"type\": \"text/html\"\n      }\n    }\n  },\n  \"links\": {\n    \"self\": {\n      \"href\": \"https://api.zotero.org/users/16026771/items/NZ26PJJX\",\n      \"type\": \"application/json\"\n    },\n    \"alternate\": {\n      \"href\": \"https://www.zotero.org/zhihutangjiang/items/NZ26PJJX\",\n      \"type\": \"text/html\"\n    },\n    \"up\": {\n      \"href\": \"https://api.zotero.org/users/16026771/items/K78DMKPD\",\n      \"type\": \"application/json\"\n    },\n    \"enclosure\": {\n      \"type\": \"application/pdf\",\n      \"href\": \"https://api.zotero.org/users/16026771/items/NZ26PJJX/file/view\",\n      \"title\": \"Islam \\u7b49 - 2025 - CODESIM Multi-Agent Code Generation and Problem Solving through Simulation-Driven Planning and Debu.pdf\",\n      \"length\": 2203164\n    }\n  },\n  \"meta\": {\n    \"numChildren\": false\n  },\n  \"data\": {\n    \"key\": \"NZ26PJJX\",\n    \"version\": 724,\n    \"parentItem\": \"K78DMKPD\",\n    \"itemType\": \"attachment\",\n    \"linkMode\": \"imported_url\",\n    \"title\": \"Preprint PDF\",\n    \"accessDate\": \"2025-07-05T04:35:14Z\",\n    \"url\": \"http://arxiv.org/pdf/2502.05664v1\",\n    \"note\": \"\",\n    \"contentType\": \"application/pdf\",\n    \"charset\": \"\",\n    \"filename\": \"Islam \\u7b49 - 2025 - CODESIM Multi-Agent Code Generation and Problem Solving through Simulation-Driven Planning and Debu.pdf\",\n    \"md5\": \"a5a4...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1685字符，剩余185字符"
        },
        "execution_time": 0.591486930847168,
        "is_functional_test": true
      },
      {
        "case_name": "Get Metadata When Server Is Down",
        "purpose": "验证当Zotero服务器不可达时工具是否能优雅地处理连接失败情况",
        "args": {
          "item_key": "KRR7MFVP"
        },
        "response": {
          "result": "{\n  \"key\": \"KRR7MFVP\",\n  \"version\": 725,\n  \"library\": {\n    \"type\": \"user\",\n    \"id\": 16026771,\n    \"name\": \"zhihutangjiang\",\n    \"links\": {\n      \"alternate\": {\n        \"href\": \"https://www.zotero.org/zhihutangjiang\",\n        \"type\": \"text/html\"\n      }\n    }\n  },\n  \"links\": {\n    \"self\": {\n      \"href\": \"https://api.zotero.org/users/16026771/items/KRR7MFVP\",\n      \"type\": \"application/json\"\n    },\n    \"alternate\": {\n      \"href\": \"https://www.zotero.org/zhihutangjiang/items/KRR7MFVP\",\n      \"type\": \"text/html\"\n    },\n    \"up\": {\n      \"href\": \"https://api.zotero.org/users/16026771/items/2VCDLWBG\",\n      \"type\": \"application/json\"\n    },\n    \"enclosure\": {\n      \"type\": \"text/html\",\n      \"href\": \"https://api.zotero.org/users/16026771/items/KRR7MFVP/file/view\"\n    }\n  },\n  \"meta\": {},\n  \"data\": {\n    \"key\": \"KRR7MFVP\",\n    \"version\": 725,\n    \"parentItem\": \"2VCDLWBG\",\n    \"itemType\": \"attachment\",\n    \"linkMode\": \"imported_url\",\n    \"title\": \"Snapshot\",\n    \"accessDate\": \"2025-07-05T04:35:07Z\",\n    \"url\": \"http://arxiv.org/abs/2404.02183\",\n    \"note\": \"\",\n    \"contentType\": \"text/html\",\n    \"charset\": \"utf-8\",\n    \"filename\": \"2404.html\",\n    \"md5\": \"fde77d8501cff3b639b6a2093577e028\",\n    \"mtime\": 1751690107090,\n    \"tags\": [],\n    \"relations\": {},\n    \"dateAdded\": \"2025-07-05T04:35:07Z\",\n    \"dateModified\": \"2025-07-05T04:35:07Z\"\n  }\n}"
        },
        "execution_time": 0.5854208469390869,
        "is_functional_test": false
      },
      {
        "case_name": "Get Metadata With Very Long Key",
        "purpose": "验证超长item_key边界条件下的处理能力",
        "args": {
          "item_key": "A_VERY_LONG_ITEM_KEY_THAT_EXCEEDS_TYPICAL_LENGTH_1234567890"
        },
        "response": {
          "error": "ToolException: Error executing tool get_item_metadata: An error occurred while fetching item metadata: \nCode: 404\nURL: https://api.zotero.org/users/16026771/items/A_VERY_LONG_ITEM_KEY_THAT_EXCEEDS_TYPICAL_LENGTH_1234567890?locale=en-US&format=json&limit=100\nMethod: GET\nResponse: Not found"
        },
        "execution_time": 1.496246337890625,
        "is_functional_test": false
      }
    ],
    "get_item_fulltext": [
      {
        "case_name": "Basic PDF Text Extraction",
        "purpose": "验证工具能否从指定Zotero条目的主PDF附件中正确提取全文文本",
        "args": {
          "item_key": "NZ26PJJX"
        },
        "response": {
          "result": "No PDF attachment found for this item."
        },
        "execution_time": 7.671038389205933,
        "is_functional_test": true
      },
      {
        "case_name": "Extract Text From Item With No PDF",
        "purpose": "验证当指定的Zotero条目没有PDF附件时是否返回适当提示信息",
        "args": {
          "item_key": "KRR7MFVP"
        },
        "response": {
          "result": "No PDF attachment found for this item."
        },
        "execution_time": 0.5328505039215088,
        "is_functional_test": true
      },
      {
        "case_name": "Text Extraction With Special Characters In PDF",
        "purpose": "验证包含特殊字符的PDF文件是否能被正确提取文本",
        "args": {
          "item_key": "LMA2MAZI"
        },
        "response": {
          "result": "No PDF attachment found for this item."
        },
        "execution_time": 1.0954766273498535,
        "is_functional_test": true
      },
      {
        "case_name": "Invalid Zotero Item Key",
        "purpose": "验证提供无效的Zotero item_key时是否能正确抛出错误",
        "args": {
          "item_key": "INVALIDKEY123"
        },
        "response": {
          "error": "ToolException: Error executing tool get_item_fulltext: An error occurred while extracting full text: \nCode: 404\nURL: https://api.zotero.org/users/16026771/items/INVALIDKEY123/children?locale=en-US&format=json&limit=100\nMethod: GET\nResponse: Item not found"
        },
        "execution_time": 0.6811883449554443,
        "is_functional_test": false
      },
      {
        "case_name": "Empty Item Key Input",
        "purpose": "验证空字符串作为item_key输入时是否被正确拒绝",
        "args": {
          "item_key": ""
        },
        "response": {
          "error": "ToolException: Error executing tool get_item_fulltext: Parameter 'item_key' must be a non-empty string."
        },
        "execution_time": 0.0036468505859375,
        "is_functional_test": false
      },
      {
        "case_name": "Extract Text From Large PDF",
        "purpose": "验证大型PDF文件的文本提取性能和稳定性",
        "args": {
          "item_key": "Z77YLWKR"
        },
        "response": {
          "error": "Tool call 'get_item_fulltext' was cancelled."
        },
        "execution_time": 40.00180220603943,
        "is_functional_test": true
      },
      {
        "case_name": "Special Characters In Item Key",
        "purpose": "验证包含特殊字符的item_key是否被安全处理",
        "args": {
          "item_key": "SPECIAL@#KEY!"
        },
        "response": {
          "error": "ToolException: Error executing tool get_item_fulltext: An error occurred while extracting full text: \nCode: 500\nURL: https://api.zotero.org/users/16026771/items/SPECIAL%40%23KEY%21/children?locale=en-US&format=json&limit=100\nMethod: GET\nResponse: An error occurred"
        },
        "execution_time": 38.916664123535156,
        "is_functional_test": false
      },
      {
        "case_name": "Very Long Item Key",
        "purpose": "验证超长item_key边界条件下的处理能力",
        "args": {
          "item_key": "A_VERY_LONG_ITEM_KEY_THAT_EXCEEDS_TYPICAL_LENGTH_1234567890"
        },
        "response": {
          "error": "ToolException: Error executing tool get_item_fulltext: An error occurred while extracting full text: \nCode: 404\nURL: https://api.zotero.org/users/16026771/items/A_VERY_LONG_ITEM_KEY_THAT_EXCEEDS_TYPICAL_LENGTH_1234567890/children?locale=en-US&format=json&limit=100\nMethod: GET\nResponse: Item not found"
        },
        "execution_time": 0.42778921127319336,
        "is_functional_test": false
      }
    ]
  },
  "total_cases": 24
}