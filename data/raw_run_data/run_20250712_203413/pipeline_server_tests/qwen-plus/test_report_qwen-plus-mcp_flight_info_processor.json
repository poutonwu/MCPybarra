{
  "server_name": "server",
  "parent_dir": "refined",
  "report_name": "qwen-plus-mcp_flight_info_processor",
  "server_path": "workspace/pipeline-output-servers/qwen-plus/mcp_flight_info_processor/refined/server.py",
  "timestamp": "2025-07-12T20:45:01.677099",
  "tools": [
    {
      "name": "search_flights",
      "description": "\n    根据出发地、目的地、日期、舱位等参数查询航班信息，支持单程、往返和多程航班查询。\n\n    Args:\n        origin: 出发地机场代码 (IATA格式，3个字母)。\n        destination: 目的地机场代码 (IATA格式，3个字母)。\n        departure_date: 出发日期 (格式: YYYY-MM-DD)。\n        return_date: 返回日期 (格式: YYYY-MM-DD)，仅往返航班需要。\n        cabin_class: 航位等级 ('economy', 'premium_economy', 'business', 'first')。\n        trip_type: 航班类型 ('one_way', 'round_trip', 'multi_city')。\n        max_results: 最大返回结果数 (默认: 5, 最大: 20)。\n\n    Returns:\n        JSON 格式字符串，包含以下字段的航班信息列表：\n        - flight_number: 航班号\n        - airline: 航空公司名称\n        - departure_time: 出发时间 (ISO 8601 格式)\n        - arrival_time: 到达时间 (ISO 8601 格式)\n        - duration: 航班时长 (分钟)\n        - price: 价格 (货币单位根据出发地自动确定)\n        - stops: 经停次数\n        - cabin_class: 航位等级\n\n    Raises:\n        ValueError: 如果参数验证失败。\n        httpx.HTTPStatusError: 如果API请求失败。\n    ",
      "args_schema": {
        "properties": {
          "origin": {
            "title": "Origin",
            "type": "string"
          },
          "destination": {
            "title": "Destination",
            "type": "string"
          },
          "departure_date": {
            "title": "Departure Date",
            "type": "string"
          },
          "return_date": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Return Date"
          },
          "cabin_class": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Cabin Class"
          },
          "trip_type": {
            "default": "one_way",
            "title": "Trip Type",
            "type": "string"
          },
          "max_results": {
            "default": 5,
            "title": "Max Results",
            "type": "integer"
          }
        },
        "required": [
          "origin",
          "destination",
          "departure_date"
        ],
        "title": "search_flightsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_offer_details",
      "description": "\n    获取特定航班报价的详细信息。\n\n    Args:\n        offer_id: 航班报价唯一标识符 (从 search_flights 结果中获取)。\n\n    Returns:\n        JSON 格式字符串，包含以下字段的详细信息：\n        - offer_id: 报价ID\n        - flight_number: 航班号\n        - airline: 航空公司信息 (名称、IATA代码)\n        - segments: 航段详细信息 (出发地、目的地、出发时间、到达时间)\n        - price_breakdown: 价格明细 (基础票价、税费、手续费等)\n        - baggage_allowance: 行李额度 (手提行李和托运行李限制)\n        - booking_conditions: 预订条件 (改签政策、退票政策)\n\n    Raises:\n        ValueError: 如果参数验证失败。\n        httpx.HTTPStatusError: 如果API请求失败。\n    ",
      "args_schema": {
        "properties": {
          "offer_id": {
            "title": "Offer Id",
            "type": "string"
          }
        },
        "required": [
          "offer_id"
        ],
        "title": "get_offer_detailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_multi_city",
      "description": "\n    处理多城市航班查询，支持复杂的行程规划。\n\n    Args:\n        itinerary: 包含多个行程段的列表，每个行程段为一个字典，包含：\n                   - origin: 出发地机场代码 (IATA格式)\n                   - destination: 目的地机场代码 (IATA格式)\n                   - date: 出发日期 (格式: YYYY-MM-DD)\n        cabin_class: 航班舱位等级。\n        max_results: 最大返回结果数 (默认: 5, 最大: 20)。\n\n    Returns:\n        JSON 格式字符串，包含以下字段的航班信息列表：\n        - journey_id: 行程唯一标识\n        - total_price: 总价格\n        - segments: 各航段详细信息 (航班号、航空公司、出发时间、到达时间)\n        - travel_duration: 总旅行时间 (分钟)\n        - layover_info: 中转停留信息 (各中转地停留时间)\n\n    Raises:\n        ValueError: 如果参数验证失败。\n        httpx.HTTPStatusError: 如果API请求失败。\n    ",
      "args_schema": {
        "properties": {
          "itinerary": {
            "items": {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            "title": "Itinerary",
            "type": "array"
          },
          "cabin_class": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Cabin Class"
          },
          "max_results": {
            "default": 5,
            "title": "Max Results",
            "type": "integer"
          }
        },
        "required": [
          "itinerary"
        ],
        "title": "search_multi_cityArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "search_flights": [
      {
        "case_name": "Basic One-way Flight Search",
        "purpose": "验证基本的单程航班查询功能是否正常工作，使用默认参数获取结果",
        "args": {
          "origin": "JFK",
          "destination": "LAX",
          "departure_date": "2025-04-05"
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offer_requests'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBsonOLSaTKwUEfsaB\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 1.2195732593536377,
        "is_functional_test": true
      },
      {
        "case_name": "Round-trip Flight Search with Business Class",
        "purpose": "验证往返航班查询功能，并指定商务舱位等级",
        "args": {
          "origin": "LHR",
          "destination": "CDG",
          "departure_date": "2025-05-10",
          "return_date": "2025-05-17",
          "cabin_class": "business",
          "trip_type": "round_trip"
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offer_requests'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBsqeOrll6a9oEH2yC\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.48305535316467285,
        "is_functional_test": true
      },
      {
        "case_name": "Multi-city Flight Search with Max Results",
        "purpose": "验证多程航班查询功能并测试最大返回结果数限制",
        "args": {
          "origin": "SFO",
          "destination": "CHI",
          "departure_date": "2025-06-01",
          "trip_type": "multi_city",
          "max_results": 15
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offer_requests'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBssRLvWUwNLMDeQPE\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.48266100883483887,
        "is_functional_test": true
      },
      {
        "case_name": "Flight Search with Invalid Origin Code",
        "purpose": "验证出发地机场代码格式不正确时能否正确抛出错误",
        "args": {
          "origin": "XYZ",
          "destination": "LAX",
          "departure_date": "2025-04-05"
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offer_requests'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBsuCz7daekm4EH3GC\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.4681875705718994,
        "is_functional_test": false
      },
      {
        "case_name": "Flight Search with Missing Required Parameters",
        "purpose": "验证缺少必填参数时能否正确抛出异常",
        "args": {
          "origin": "JFK"
        },
        "response": {
          "error": "ToolException: Error executing tool search_flights: 2 validation errors for search_flightsArguments\ndestination\n  Field required [type=missing, input_value={'origin': 'JFK'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing\ndeparture_date\n  Field required [type=missing, input_value={'origin': 'JFK'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.009999513626098633,
        "is_functional_test": false
      },
      {
        "case_name": "Flight Search with SQL Injection Attempt in Origin",
        "purpose": "验证工具是否安全处理包含特殊字符（如SQL注入）的输入",
        "args": {
          "origin": "JFK'; DROP TABLE flights;--",
          "destination": "LAX",
          "departure_date": "2025-04-05"
        },
        "response": {
          "result": "{\"error\": \"搜索航班时发生错误: 无效的出发地机场代码: 'JFK'; DROP TABLE flights;--'。必须是3个字母的大写IATA代码。\"}"
        },
        "execution_time": 0.009998083114624023,
        "is_functional_test": false
      },
      {
        "case_name": "Flight Search with Maximum Allowed Results",
        "purpose": "验证最大结果数达到上限（20）时的行为",
        "args": {
          "origin": "ORD",
          "destination": "MIA",
          "departure_date": "2025-03-20",
          "max_results": 20
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offer_requests'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBswKMNTKCub8DDbYF\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.533771276473999,
        "is_functional_test": true
      },
      {
        "case_name": "Flight Search with Special Characters in Airport Codes",
        "purpose": "验证包含非法字符的机场代码是否被正确拒绝",
        "args": {
          "origin": "A@B",
          "destination": "C#D",
          "departure_date": "2025-04-05"
        },
        "response": {
          "result": "{\"error\": \"搜索航班时发生错误: 无效的出发地机场代码: 'A@B'。必须是3个字母的大写IATA代码。\"}"
        },
        "execution_time": 0.009507179260253906,
        "is_functional_test": false
      }
    ],
    "get_offer_details": [
      {
        "case_name": "Basic Offer Details Retrieval",
        "purpose": "验证能够成功获取一个有效offer_id的完整报价详情，使用正常参数测试基本功能路径",
        "args": {
          "offer_id": "OFFER123456"
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offers/OFFER123456'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBuM3ql5hYIXwDxsRD\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 1.4145498275756836,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Offer ID Input",
        "purpose": "验证当提供空字符串作为offer_id时能否正确抛出参数验证错误",
        "args": {
          "offer_id": ""
        },
        "response": {
          "result": "{\"error\": \"获取报价详细信息时发生错误: 无效的报价ID。报价ID不能为空或仅包含空白字符。\"}"
        },
        "execution_time": 0.007005453109741211,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Format Offer ID",
        "purpose": "验证当提供格式不正确的offer_id（如包含特殊字符）时能否正确拒绝请求",
        "args": {
          "offer_id": "OFFER@#123"
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offers/OFFER@'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBuOqib1NAx60EfypB\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.4706428050994873,
        "is_functional_test": false
      },
      {
        "case_name": "SQL Injection Attempt in Offer ID",
        "purpose": "验证工具是否安全处理包含潜在SQL注入攻击的offer_id输入",
        "args": {
          "offer_id": "OFFER123'; DROP TABLE offers;--"
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offers/OFFER123';%20DROP%20TABLE%20offers;--'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBuQbwd1OvJyYEH8RC\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.46731042861938477,
        "is_functional_test": false
      },
      {
        "case_name": "Non-existent Offer ID",
        "purpose": "验证当提供一个不存在的offer_id时API是否能返回适当的错误或空结果",
        "args": {
          "offer_id": "NONEXISTENT_OFFER"
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offers/NONEXISTENT_OFFER'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBuSSQoMJIGiUDDelF\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.488950252532959,
        "is_functional_test": true
      },
      {
        "case_name": "Longest Valid Offer ID",
        "purpose": "验证最大长度的合法offer_id是否能被正确处理（边界测试）",
        "args": {
          "offer_id": "A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6Q7R8S9T0U1V2W3X4Y5Z6E7R8T9Y0U1I2O3P4A5S6D7F8G9H0J1K2L3ZXCASD"
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offers/A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6Q7R8S9T0U1V2W3X4Y5Z6E7R8T9Y0U1I2O3P4A5S6D7F8G9H0J1K2L3ZXCASD'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBuUEl0VE9Am8DDerF\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.46391987800598145,
        "is_functional_test": true
      },
      {
        "case_name": "Missing Required Offer ID Parameter",
        "purpose": "验证未提供offer_id参数时能否正确抛出参数缺失错误",
        "args": {},
        "response": {
          "error": "ToolException: Error executing tool get_offer_details: 1 validation error for get_offer_detailsArguments\noffer_id\n  Field required [type=missing, input_value={}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.008175373077392578,
        "is_functional_test": false
      },
      {
        "case_name": "Offer Details with Special Unicode Characters in ID",
        "purpose": "验证包含Unicode特殊字符的offer_id是否能被正确拒绝（安全性与边界混合测试）",
        "args": {
          "offer_id": "OFFER\u0000\u001f​"
        },
        "response": {
          "result": "{\"error\": \"获取报价详细信息时发生错误: Invalid non-printable ASCII character in URL, '\\\\x00' at position 12.\"}"
        },
        "execution_time": 0.010137081146240234,
        "is_functional_test": false
      }
    ],
    "search_multi_city": [
      {
        "case_name": "Basic Multi-city Flight Search",
        "purpose": "验证基本的多城市航班查询功能是否正常工作，使用默认参数获取结果",
        "args": {
          "itinerary": [
            {
              "origin": "JFK",
              "destination": "LAX",
              "date": "2025-04-05"
            },
            {
              "origin": "LAX",
              "destination": "ORD",
              "date": "2025-04-07"
            }
          ]
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offer_requests'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBwldChpz-jWMDea8E\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 1.3293869495391846,
        "is_functional_test": true
      },
      {
        "case_name": "Multi-city Flight Search with Business Class",
        "purpose": "验证多城市航班查询功能并指定商务舱位等级",
        "args": {
          "itinerary": [
            {
              "origin": "LHR",
              "destination": "CDG",
              "date": "2025-05-10"
            },
            {
              "origin": "CDG",
              "destination": "AMS",
              "date": "2025-05-12"
            }
          ],
          "cabin_class": "business"
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offer_requests'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBwnRtRsgAyvQDxyhD\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.4786977767944336,
        "is_functional_test": true
      },
      {
        "case_name": "Multi-city Flight Search with Max Results",
        "purpose": "验证最大返回结果数限制是否生效（默认为5）",
        "args": {
          "itinerary": [
            {
              "origin": "SFO",
              "destination": "CHI",
              "date": "2025-06-01"
            },
            {
              "origin": "CHI",
              "destination": "MIA",
              "date": "2025-06-03"
            }
          ],
          "max_results": 5
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offer_requests'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBwpDry1GeTq0Cm65G\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.6892776489257812,
        "is_functional_test": true
      },
      {
        "case_name": "Multi-city Flight Search with Maximum Allowed Results",
        "purpose": "验证最大结果数达到上限（20）时的行为",
        "args": {
          "itinerary": [
            {
              "origin": "ORD",
              "destination": "MIA",
              "date": "2025-03-20"
            },
            {
              "origin": "MIA",
              "destination": "JFK",
              "date": "2025-03-22"
            }
          ],
          "max_results": 20
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offer_requests'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBwrn5P712LTAEIDoC\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.48590087890625,
        "is_functional_test": true
      },
      {
        "case_name": "Flight Search with Invalid Origin Code",
        "purpose": "验证出发地机场代码格式不正确时能否正确抛出错误",
        "args": {
          "itinerary": [
            {
              "origin": "XYZ",
              "destination": "LAX",
              "date": "2025-04-05"
            },
            {
              "origin": "LAX",
              "destination": "ORD",
              "date": "2025-04-07"
            }
          ]
        },
        "response": {
          "result": "{\"error\": \"Duffel API请求失败: Client error '400 Bad Request' for url 'https://api.duffel.com/air/offer_requests'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\\n状态码: 400\\n响应内容: {\\\"errors\\\":[{\\\"documentation_url\\\":\\\"https://duffel.com/docs/api/overview/response-handling\\\",\\\"title\\\":\\\"Unsupported version\\\",\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"The version set in the 'Duffel-Version' header is no longer supported by the API. Please upgrade.\\\",\\\"code\\\":\\\"unsupported_version\\\"}],\\\"meta\\\":{\\\"request_id\\\":\\\"GFGBwtdwZTbcLskDxywD\\\",\\\"status\\\":400}}\"}"
        },
        "execution_time": 0.4769623279571533,
        "is_functional_test": false
      },
      {
        "case_name": "Flight Search with Missing Required Itinerary",
        "purpose": "验证缺少必填的itinerary参数时能否正确抛出异常",
        "args": {},
        "response": {
          "error": "ToolException: Error executing tool search_multi_city: 1 validation error for search_multi_cityArguments\nitinerary\n  Field required [type=missing, input_value={}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.010759353637695312,
        "is_functional_test": false
      },
      {
        "case_name": "Flight Search with SQL Injection Attempt in Origin",
        "purpose": "验证工具是否安全处理包含SQL注入尝试的输入",
        "args": {
          "itinerary": [
            {
              "origin": "JFK'; DROP TABLE flights;--",
              "destination": "LAX",
              "date": "2025-04-05"
            },
            {
              "origin": "LAX",
              "destination": "ORD",
              "date": "2025-04-07"
            }
          ]
        },
        "response": {
          "result": "{\"error\": \"搜索多城市行程时发生错误: 无效的出发地机场代码: 'JFK'; DROP TABLE flights;--'（第1个行程段）。必须是3个字母的大写IATA代码。\"}"
        },
        "execution_time": 0.00966334342956543,
        "is_functional_test": false
      },
      {
        "case_name": "Flight Search with Special Characters in Airport Codes",
        "purpose": "验证包含非法字符的机场代码是否被正确拒绝",
        "args": {
          "itinerary": [
            {
              "origin": "A@B",
              "destination": "C#D",
              "date": "2025-04-05"
            },
            {
              "origin": "XYZ",
              "destination": "ABC",
              "date": "2025-04-07"
            }
          ]
        },
        "response": {
          "result": "{\"error\": \"搜索多城市行程时发生错误: 无效的出发地机场代码: 'A@B'（第1个行程段）。必须是3个字母的大写IATA代码。\"}"
        },
        "execution_time": 0.011309623718261719,
        "is_functional_test": false
      }
    ]
  },
  "total_cases": 24
}