{
  "server_name": "server",
  "parent_dir": "refined",
  "report_name": "gemini-2.5-pro-mcp_outlook_manager",
  "server_path": "workspace/pipeline-output-servers/gemini-2.5-pro/mcp_outlook_manager/refined/server.py",
  "timestamp": "2025-07-12T20:42:59.884383",
  "tools": [
    {
      "name": "list_folders",
      "description": "\n    Retrieves and lists all accessible email folders from the user's main Outlook mailbox.\n    This function scans the default mailbox for top-level folders and their direct subfolders,\n    providing a comprehensive list for use in other email-related functions.\n\n    Returns:\n        str: A JSON string representing a sorted list of folder names.\n             Example: '[\"Inbox\", \"Sent Items\", \"Drafts\", \"My Project Folder\"]'\n    ",
      "args_schema": {
        "properties": {},
        "title": "list_foldersArguments",
        "type": "object"
      }
    },
    {
      "name": "list_recent_emails",
      "description": "\n    Fetches a list of email summaries from a specified folder received within a given number of days.\n    The results are cached, and each email is assigned a number for subsequent operations like 'get_email_by_number'.\n    The list is sorted with the most recent emails first and is limited to the top 100 results for performance.\n\n    Args:\n        days (int): The number of past days to search for emails. Must be a positive integer.\n        folder_name (str, optional): The name of the Outlook folder to search in. Defaults to \"Inbox\".\n\n    Returns:\n        str: A JSON string representing a list of dictionaries, where each dictionary contains the\n             assigned number, subject, sender, and received time of an email. Returns an empty list if no emails are found.\n             Example: '[{\"number\": 1, \"subject\": \"Project Update\", \"from\": \"John Doe\", \"received\": \"2023-10-27 10:30\"}]'\n    ",
      "args_schema": {
        "properties": {
          "days": {
            "title": "Days",
            "type": "integer"
          },
          "folder_name": {
            "default": "Inbox",
            "title": "Folder Name",
            "type": "string"
          }
        },
        "required": [
          "days"
        ],
        "title": "list_recent_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_emails",
      "description": "\n    Searches for emails based on a keyword within a specified date range and folder.\n    The search query is applied to the email's subject, body, and sender fields.\n    The results are cached, and each email is assigned a number for subsequent operations.\n    The list is sorted with the most recent emails first and is limited to the top 100 results.\n\n    Args:\n        query (str): The keyword or phrase to search for.\n        start_date (str): The start date for the search range, formatted as 'YYYY-MM-DD'.\n        end_date (str): The end date for the search range, formatted as 'YYYY-MM-DD'.\n        folder_name (str, optional): The name of the folder to search. Defaults to \"Inbox\".\n\n    Returns:\n        str: A JSON string representing a list of dictionaries, each containing the assigned number,\n             subject, sender, and received time of a matching email. Returns an empty list if no matches are found.\n             Example: '[{\"number\": 1, \"subject\": \"Re: Project Plan\", \"from\": \"Jane Smith\", \"received\": \"2023-10-26 15:00\"}]'\n    ",
      "args_schema": {
        "properties": {
          "query": {
            "title": "Query",
            "type": "string"
          },
          "start_date": {
            "title": "Start Date",
            "type": "string"
          },
          "end_date": {
            "title": "End Date",
            "type": "string"
          },
          "folder_name": {
            "default": "Inbox",
            "title": "Folder Name",
            "type": "string"
          }
        },
        "required": [
          "query",
          "start_date",
          "end_date"
        ],
        "title": "search_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_email_by_number",
      "description": "\n    Retrieves the full details of a specific email from the cache generated by\n    `list_recent_emails` or `search_emails`, using its assigned number.\n    This provides access to the sender, recipients, subject, full body, and attachments.\n\n    Args:\n        email_number (int): The number of the email as provided in the last list. Must be a positive integer.\n\n    Returns:\n        str: A JSON string representing a dictionary with the email's details, including sender,\n             recipients (To, CC), subject, body, received time, and a list of attachment filenames.\n             Returns an error message if the number is invalid or not found in the cache.\n             Example: '{\"from\": \"sender@example.com\", \"to\": \"you@example.com\", \"cc\": \"manager@example.com\", \"subject\": \"Project Update\", \"received\": \"2023-10-27 10:30:00\", \"body\": \"Here is the latest update...\", \"attachments\": [\"report.docx\", \"data.xlsx\"]}'\n    ",
      "args_schema": {
        "properties": {
          "email_number": {
            "title": "Email Number",
            "type": "integer"
          }
        },
        "required": [
          "email_number"
        ],
        "title": "get_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "reply_to_email_by_number",
      "description": "\n    Sends a 'Reply All' to a specific email from the cached list using its assigned number.\n    The provided reply text is prepended to the original email's body in the reply.\n\n    Args:\n        email_number (int): The number of the email to reply to, from the cached list.\n        reply_body (str): The content of the reply message. Cannot be empty.\n\n    Returns:\n        str: A JSON string containing a status message confirming the action.\n             Example: '{\"status\": \"Successfully replied to email number 1.\"}'\n    ",
      "args_schema": {
        "properties": {
          "email_number": {
            "title": "Email Number",
            "type": "integer"
          },
          "reply_body": {
            "title": "Reply Body",
            "type": "string"
          }
        },
        "required": [
          "email_number",
          "reply_body"
        ],
        "title": "reply_to_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "compose_email",
      "description": "\n    Composes and sends a new email with the specified subject, body, and recipients.\n\n    Args:\n        subject (str): The subject line of the new email. Cannot be empty.\n        body (str): The main content of the email. Cannot be empty.\n        recipients (List[str]): A list of one or more email addresses for the 'To' field.\n        cc_recipients (List[str], optional): A list of email addresses for the 'CC' field. Defaults to None.\n\n    Returns:\n        str: A JSON string containing a status message confirming that the email was sent.\n             Example: '{\"status\": \"Email with subject 'New Proposal' sent successfully.\"}'\n    ",
      "args_schema": {
        "properties": {
          "subject": {
            "title": "Subject",
            "type": "string"
          },
          "body": {
            "title": "Body",
            "type": "string"
          },
          "recipients": {
            "items": {
              "type": "string"
            },
            "title": "Recipients",
            "type": "array"
          },
          "cc_recipients": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Cc Recipients"
          }
        },
        "required": [
          "subject",
          "body",
          "recipients"
        ],
        "title": "compose_emailArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "list_folders": [
      {
        "case_name": "ListFolders_BasicFunctionality",
        "purpose": "验证 list_folders 工具能够正确检索并返回用户主邮箱中的所有可访问文件夹列表。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.354356288909912,
        "is_functional_test": true
      },
      {
        "case_name": "ListFolders_EmptyMailbox",
        "purpose": "验证当用户邮箱中没有任何文件夹时，list_folders 工具是否能优雅处理并返回空数组。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.1015043258666992,
        "is_functional_test": true
      },
      {
        "case_name": "ListFolders_WithSubfolders",
        "purpose": "验证 list_folders 是否能正确列出顶层文件夹及其直接子文件夹。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.0177075862884521,
        "is_functional_test": true
      },
      {
        "case_name": "ListFolders_UnauthorizedAccess",
        "purpose": "验证在无权限访问邮箱的情况下，工具是否能拒绝访问并返回适当的错误信息。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.133218765258789,
        "is_functional_test": false
      },
      {
        "case_name": "ListFolders_ServerDown",
        "purpose": "验证当邮件服务器不可用时，工具是否能妥善处理连接失败的情况。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.0268197059631348,
        "is_functional_test": false
      },
      {
        "case_name": "ListFolders_SpecialCharactersInFolderNames",
        "purpose": "验证包含特殊字符的文件夹名称能否被正确识别和返回。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.0976231098175049,
        "is_functional_test": true
      },
      {
        "case_name": "ListFolders_PerformanceWithLargeFolderCount",
        "purpose": "验证工具在存在大量文件夹时的表现，确保不会出现性能问题或超时。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.1124038696289062,
        "is_functional_test": true
      },
      {
        "case_name": "ListFolders_CaseInsensitiveSorting",
        "purpose": "验证返回的文件夹列表是否按字母顺序排序（不区分大小写）。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.1027960777282715,
        "is_functional_test": true
      }
    ],
    "list_recent_emails": [
      {
        "case_name": "ListRecentEmails_BasicFunctionality",
        "purpose": "验证 list_recent_emails 工具在默认参数下能否正确获取最近邮件列表。",
        "args": {
          "days": 7
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.02951836585998535,
        "is_functional_test": true
      },
      {
        "case_name": "ListRecentEmails_CustomFolder",
        "purpose": "验证工具能否指定非默认文件夹（如 'Sent Items'）并正确检索其中的邮件。",
        "args": {
          "days": 7,
          "folder_name": "Sent Items"
        },
        "response": {
          "result": "[{\"number\": 1, \"subject\": \"Email with CC\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:39\"}, {\"number\": 2, \"subject\": \"Test Email\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:38\"}, {\"number\": 3, \"subject\": \"\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:19\"}, {\"number\": 4, \"subject\": \"\\u542bCC\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:19\"}, {\"number\": 5, \"subject\": \"Test Subject\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:18\"}, {\"number\": 6, \"subject\": \"\\u4e2d\\u6587\\u6d4b\\u8bd5\\u4e3b\\u9898\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:18\"}, {\"number\": 7, \"subject\": \"\\u90ae\\u4ef6\\u6d4b\\u8bd5 - \\u4e2d\\u6587\\u4e3b\\u9898\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:16\"}, {\"number\": 8, \"subject\": \"Test Subject\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:15\"}, {\"number\": 9, \"subject\": \"Meeting Agenda\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-11 21:15\"}]"
        },
        "execution_time": 8.379008531570435,
        "is_functional_test": true
      },
      {
        "case_name": "ListRecentEmails_SingleDay",
        "purpose": "验证工具在 days=1 时是否仅返回过去一天内的邮件。",
        "args": {
          "days": 1
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.024825334548950195,
        "is_functional_test": true
      },
      {
        "case_name": "ListRecentEmails_MaxLimit",
        "purpose": "验证工具是否最多返回100封邮件，即使匹配结果超过该数量。",
        "args": {
          "days": 30
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: <unknown>.ReceivedTime\"}"
        },
        "execution_time": 0.03340315818786621,
        "is_functional_test": true
      },
      {
        "case_name": "ListRecentEmails_NoResults",
        "purpose": "验证当没有符合条件的邮件时，工具是否返回空数组。",
        "args": {
          "days": 1,
          "folder_name": "Drafts"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.1136007308959961,
        "is_functional_test": true
      },
      {
        "case_name": "ListRecentEmails_UnauthorizedAccess",
        "purpose": "验证在无权限访问邮箱时，工具是否能拒绝访问并返回适当错误信息。",
        "args": {
          "days": 7,
          "folder_name": "Inbox"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.020508527755737305,
        "is_functional_test": false
      },
      {
        "case_name": "ListRecentEmails_ServerDown",
        "purpose": "验证当邮件服务器不可用时，工具是否能妥善处理连接失败的情况。",
        "args": {
          "days": 7
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.0207977294921875,
        "is_functional_test": false
      },
      {
        "case_name": "ListRecentEmails_FolderWithSpecialChars",
        "purpose": "验证包含特殊字符的文件夹名称能否被正确识别和检索。",
        "args": {
          "days": 7,
          "folder_name": "收件箱"
        },
        "response": {
          "result": "[{\"number\": 1, \"subject\": \"2025\\u201c\\u4e07\\u65b9\\u6570\\u636e\\u676f\\u201d\\u667a\\u80fd\\u4f53\\u5927\\u8d5b\\u62a5\\u540d\\u6210\\u529f\", \"from\": \"\\u4e07\\u65b9\\u6570\\u636e\", \"received\": \"2025-07-06 18:54\"}]"
        },
        "execution_time": 0.5681383609771729,
        "is_functional_test": true
      }
    ],
    "search_emails": [
      {
        "case_name": "SearchEmails_BasicFunctionality",
        "purpose": "验证 search_emails 工具在默认参数下能否正确搜索邮件并返回结果列表。",
        "args": {
          "query": "test",
          "start_date": "2025-07-01",
          "end_date": "2025-07-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.023781776428222656,
        "is_functional_test": true
      },
      {
        "case_name": "SearchEmails_CustomFolder",
        "purpose": "验证工具能否指定非默认文件夹（如 'Sent Items'）并正确检索其中的邮件。",
        "args": {
          "query": "project",
          "start_date": "2025-07-01",
          "end_date": "2025-07-31",
          "folder_name": "Sent Items"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.026089191436767578,
        "is_functional_test": true
      },
      {
        "case_name": "SearchEmails_NoResults",
        "purpose": "验证当没有匹配关键词的邮件时，工具是否返回空数组。",
        "args": {
          "query": "nonexistentkeyword",
          "start_date": "2025-07-01",
          "end_date": "2025-07-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.01999688148498535,
        "is_functional_test": true
      },
      {
        "case_name": "SearchEmails_InvalidDateRange",
        "purpose": "验证工具在开始日期晚于结束日期时是否能正确处理错误日期范围。",
        "args": {
          "query": "report",
          "start_date": "2025-08-01",
          "end_date": "2025-07-01"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.01747918128967285,
        "is_functional_test": false
      },
      {
        "case_name": "SearchEmails_SpecialCharactersInQuery",
        "purpose": "验证包含特殊字符的搜索关键词能否被正确处理。",
        "args": {
          "query": "café@2025",
          "start_date": "2025-07-01",
          "end_date": "2025-07-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.01722860336303711,
        "is_functional_test": true
      },
      {
        "case_name": "SearchEmails_ServerDown",
        "purpose": "验证当邮件服务器不可用时，工具是否能妥善处理连接失败的情况。",
        "args": {
          "query": "urgent",
          "start_date": "2025-07-01",
          "end_date": "2025-07-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.019008874893188477,
        "is_functional_test": false
      },
      {
        "case_name": "SearchEmails_UnauthorizedAccess",
        "purpose": "验证在无权限访问邮箱时，工具是否拒绝访问并返回适当错误信息。",
        "args": {
          "query": "confidential",
          "start_date": "2025-07-01",
          "end_date": "2025-07-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.017520904541015625,
        "is_functional_test": false
      },
      {
        "case_name": "SearchEmails_MaxResultsLimit",
        "purpose": "验证工具是否最多返回100封邮件，即使匹配结果超过该数量。",
        "args": {
          "query": "*",
          "start_date": "2024-01-01",
          "end_date": "2025-12-31"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.01861858367919922,
        "is_functional_test": true
      }
    ],
    "get_email_by_number": [
      {
        "case_name": "GetEmailByNumber_BasicFunctionality",
        "purpose": "验证 get_email_by_number 工具在提供有效邮件编号时能否正确检索并返回完整的邮件详细信息。",
        "args": {
          "email_number": 1
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.02288341522216797,
        "is_functional_test": true
      },
      {
        "case_name": "GetEmailByNumber_InvalidNumber",
        "purpose": "验证当提供无效的邮件编号（如负数）时，工具是否能返回适当的错误信息。",
        "args": {
          "email_number": -1
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.012998819351196289,
        "is_functional_test": false
      },
      {
        "case_name": "GetEmailByNumber_NonExistentNumber",
        "purpose": "验证当提供一个不存在的邮件编号时，工具是否能优雅处理并返回错误信息。",
        "args": {
          "email_number": 9999
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 9999. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.01207590103149414,
        "is_functional_test": false
      },
      {
        "case_name": "GetEmailByNumber_ZeroValue",
        "purpose": "验证当邮件编号为0时，工具是否能正确拒绝该请求并返回错误信息。",
        "args": {
          "email_number": 0
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.00900411605834961,
        "is_functional_test": false
      },
      {
        "case_name": "GetEmailByNumber_CachedEmailAccess",
        "purpose": "验证 get_email_by_number 是否能够从 list_recent_emails 或 search_emails 的缓存中正确获取邮件详情。",
        "args": {
          "email_number": 2
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 2. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.014016151428222656,
        "is_functional_test": true
      },
      {
        "case_name": "GetEmailByNumber_AttachmentPresence",
        "purpose": "验证包含附件的邮件能否被正确识别并列出所有附件文件名。",
        "args": {
          "email_number": 3
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 3. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.015999794006347656,
        "is_functional_test": true
      },
      {
        "case_name": "GetEmailByNumber_SpecialCharactersInContent",
        "purpose": "验证邮件内容（如主题、发件人、收件人）中包含特殊字符时能否被正确解析和返回。",
        "args": {
          "email_number": 4
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 4. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.012000799179077148,
        "is_functional_test": true
      },
      {
        "case_name": "GetEmailByNumber_UnauthorizedAccess",
        "purpose": "验证在无权限访问邮箱的情况下，get_email_by_number 是否会拒绝访问并返回适当错误信息。",
        "args": {
          "email_number": 1
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.01061558723449707,
        "is_functional_test": false
      }
    ],
    "reply_to_email_by_number": [
      {
        "case_name": "ReplyToEmailByNumber_BasicFunctionality",
        "purpose": "验证 reply_to_email_by_number 工具能否正确向缓存列表中指定编号的邮件执行 Reply All 操作，并将回复内容前置到原始邮件正文。",
        "args": {
          "email_number": 1,
          "reply_body": "这是测试回复内容。"
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.010133504867553711,
        "is_functional_test": true
      },
      {
        "case_name": "ReplyToEmailByNumber_EmptyReplyBody",
        "purpose": "验证当 reply_body 参数为空时，工具是否返回参数验证错误。",
        "args": {
          "email_number": 1,
          "reply_body": ""
        },
        "response": {
          "result": "{\"error\": \"Parameter 'reply_body' cannot be empty.\"}"
        },
        "execution_time": 0.010001897811889648,
        "is_functional_test": false
      },
      {
        "case_name": "ReplyToEmailByNumber_InvalidEmailNumber",
        "purpose": "验证当 email_number 参数为负数或超出缓存邮件范围时是否返回错误。",
        "args": {
          "email_number": -1,
          "reply_body": "这是测试回复内容。"
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.008995771408081055,
        "is_functional_test": false
      },
      {
        "case_name": "ReplyToEmailByNumber_MissingEmailNumber",
        "purpose": "验证当 email_number 参数缺失时工具是否返回参数验证错误。",
        "args": {
          "reply_body": "这是测试回复内容。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 1 validation error for reply_to_email_by_numberArguments\nemail_number\n  Field required [type=missing, input_value={'reply_body': '这是测试回复内容。'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.009114265441894531,
        "is_functional_test": false
      },
      {
        "case_name": "ReplyToEmailByNumber_MissingReplyBody",
        "purpose": "验证当 reply_body 参数缺失时工具是否返回参数验证错误。",
        "args": {
          "email_number": 1
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 1 validation error for reply_to_email_by_numberArguments\nreply_body\n  Field required [type=missing, input_value={'email_number': 1}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.01618814468383789,
        "is_functional_test": false
      },
      {
        "case_name": "ReplyToEmailByNumber_SpecialCharactersInReply",
        "purpose": "验证 reply_body 中包含特殊字符（如中文、标点、表情符号）时是否能正常处理。",
        "args": {
          "email_number": 1,
          "reply_body": "这是一条包含特殊字符的回复：😊，测试中文、标点和表情符号。"
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.015020132064819336,
        "is_functional_test": true
      },
      {
        "case_name": "ReplyToEmailByNumber_UnauthorizedAccess",
        "purpose": "验证在无权限发送邮件时，工具是否返回适当的权限错误信息。",
        "args": {
          "email_number": 1,
          "reply_body": "这是测试回复内容。"
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.012005329132080078,
        "is_functional_test": false
      },
      {
        "case_name": "ReplyToEmailByNumber_ServerDown",
        "purpose": "验证当邮件服务器不可用时，工具是否能妥善处理连接失败的情况。",
        "args": {
          "email_number": 1,
          "reply_body": "这是测试回复内容。"
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.011041641235351562,
        "is_functional_test": false
      }
    ],
    "compose_email": [
      {
        "case_name": "ComposeEmail_BasicFunctionality",
        "purpose": "验证 compose_email 工具在提供必要参数时能否成功发送一封邮件。",
        "args": {
          "subject": "Test Email",
          "body": "This is a test email body.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"status\": \"Email with subject 'Test Email' sent successfully.\"}"
        },
        "execution_time": 6.836451768875122,
        "is_functional_test": true
      },
      {
        "case_name": "ComposeEmail_WithCC",
        "purpose": "验证 compose_email 工具在提供 CC 收件人时能否正确发送邮件。",
        "args": {
          "subject": "Email with CC",
          "body": "This email includes a CC recipient.",
          "recipients": [
            "test@example.com"
          ],
          "cc_recipients": [
            "cc@example.com"
          ]
        },
        "response": {
          "result": "{\"status\": \"Email with subject 'Email with CC' sent successfully.\"}"
        },
        "execution_time": 6.120729207992554,
        "is_functional_test": true
      },
      {
        "case_name": "ComposeEmail_MissingSubject",
        "purpose": "验证当未提供邮件主题时，工具是否能返回错误信息。",
        "args": {
          "subject": "",
          "body": "This email is missing a subject.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Parameter 'subject' cannot be empty.\"}"
        },
        "execution_time": 0.008802413940429688,
        "is_functional_test": false
      },
      {
        "case_name": "ComposeEmail_MissingBody",
        "purpose": "验证当未提供邮件正文时，工具是否能返回错误信息。",
        "args": {
          "subject": "Test Email",
          "body": "",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Parameter 'body' cannot be empty.\"}"
        },
        "execution_time": 0.015338659286499023,
        "is_functional_test": false
      },
      {
        "case_name": "ComposeEmail_NoRecipients",
        "purpose": "验证当未提供收件人时，工具是否能返回错误信息。",
        "args": {
          "subject": "Test Email",
          "body": "This email is missing recipients.",
          "recipients": []
        },
        "response": {
          "result": "{\"error\": \"Parameter 'recipients' list cannot be empty.\"}"
        },
        "execution_time": 0.007311344146728516,
        "is_functional_test": false
      },
      {
        "case_name": "ComposeEmail_SpecialCharacters",
        "purpose": "验证 compose_email 工具能否正确处理包含特殊字符的主题和正文。",
        "args": {
          "subject": "测试邮件 - 中文主题 & 特殊字符",
          "body": "这是一封包含特殊字符的邮件，例如：!@#$%^&*()_+{}|:\"<>?~。",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.4471890926361084,
        "is_functional_test": true
      },
      {
        "case_name": "ComposeEmail_UnauthorizedAccess",
        "purpose": "验证在无权限发送邮件时，工具是否能拒绝操作并返回适当错误信息。",
        "args": {
          "subject": "Unauthorized Test",
          "body": "This email should not be sent due to unauthorized access.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.4830753803253174,
        "is_functional_test": false
      }
    ]
  },
  "total_cases": 47
}