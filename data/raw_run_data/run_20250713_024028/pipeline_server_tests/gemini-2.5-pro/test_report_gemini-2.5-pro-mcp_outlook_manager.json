{
  "server_name": "server",
  "parent_dir": "refined",
  "report_name": "gemini-2.5-pro-mcp_outlook_manager",
  "server_path": "workspace/pipeline-output-servers/gemini-2.5-pro/mcp_outlook_manager/refined/server.py",
  "timestamp": "2025-07-13T02:55:51.790338",
  "tools": [
    {
      "name": "list_folders",
      "description": "\n    Retrieves and lists all accessible email folders from the user's main Outlook mailbox.\n    This function scans the default mailbox for top-level folders and their direct subfolders,\n    providing a comprehensive list for use in other email-related functions.\n\n    Returns:\n        str: A JSON string representing a sorted list of folder names.\n             Example: '[\"Inbox\", \"Sent Items\", \"Drafts\", \"My Project Folder\"]'\n    ",
      "args_schema": {
        "properties": {},
        "title": "list_foldersArguments",
        "type": "object"
      }
    },
    {
      "name": "list_recent_emails",
      "description": "\n    Fetches a list of email summaries from a specified folder received within a given number of days.\n    The results are cached, and each email is assigned a number for subsequent operations like 'get_email_by_number'.\n    The list is sorted with the most recent emails first and is limited to the top 100 results for performance.\n\n    Args:\n        days (int): The number of past days to search for emails. Must be a positive integer.\n        folder_name (str, optional): The name of the Outlook folder to search in. Defaults to \"Inbox\".\n\n    Returns:\n        str: A JSON string representing a list of dictionaries, where each dictionary contains the\n             assigned number, subject, sender, and received time of an email. Returns an empty list if no emails are found.\n             Example: '[{\"number\": 1, \"subject\": \"Project Update\", \"from\": \"John Doe\", \"received\": \"2023-10-27 10:30\"}]'\n    ",
      "args_schema": {
        "properties": {
          "days": {
            "title": "Days",
            "type": "integer"
          },
          "folder_name": {
            "default": "Inbox",
            "title": "Folder Name",
            "type": "string"
          }
        },
        "required": [
          "days"
        ],
        "title": "list_recent_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_emails",
      "description": "\n    Searches for emails based on a keyword within a specified date range and folder.\n    The search query is applied to the email's subject, body, and sender fields.\n    The results are cached, and each email is assigned a number for subsequent operations.\n    The list is sorted with the most recent emails first and is limited to the top 100 results.\n\n    Args:\n        query (str): The keyword or phrase to search for.\n        start_date (str): The start date for the search range, formatted as 'YYYY-MM-DD'.\n        end_date (str): The end date for the search range, formatted as 'YYYY-MM-DD'.\n        folder_name (str, optional): The name of the folder to search. Defaults to \"Inbox\".\n\n    Returns:\n        str: A JSON string representing a list of dictionaries, each containing the assigned number,\n             subject, sender, and received time of a matching email. Returns an empty list if no matches are found.\n             Example: '[{\"number\": 1, \"subject\": \"Re: Project Plan\", \"from\": \"Jane Smith\", \"received\": \"2023-10-26 15:00\"}]'\n    ",
      "args_schema": {
        "properties": {
          "query": {
            "title": "Query",
            "type": "string"
          },
          "start_date": {
            "title": "Start Date",
            "type": "string"
          },
          "end_date": {
            "title": "End Date",
            "type": "string"
          },
          "folder_name": {
            "default": "Inbox",
            "title": "Folder Name",
            "type": "string"
          }
        },
        "required": [
          "query",
          "start_date",
          "end_date"
        ],
        "title": "search_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_email_by_number",
      "description": "\n    Retrieves the full details of a specific email from the cache generated by\n    `list_recent_emails` or `search_emails`, using its assigned number.\n    This provides access to the sender, recipients, subject, full body, and attachments.\n\n    Args:\n        email_number (int): The number of the email as provided in the last list. Must be a positive integer.\n\n    Returns:\n        str: A JSON string representing a dictionary with the email's details, including sender,\n             recipients (To, CC), subject, body, received time, and a list of attachment filenames.\n             Returns an error message if the number is invalid or not found in the cache.\n             Example: '{\"from\": \"sender@example.com\", \"to\": \"you@example.com\", \"cc\": \"manager@example.com\", \"subject\": \"Project Update\", \"received\": \"2023-10-27 10:30:00\", \"body\": \"Here is the latest update...\", \"attachments\": [\"report.docx\", \"data.xlsx\"]}'\n    ",
      "args_schema": {
        "properties": {
          "email_number": {
            "title": "Email Number",
            "type": "integer"
          }
        },
        "required": [
          "email_number"
        ],
        "title": "get_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "reply_to_email_by_number",
      "description": "\n    Sends a 'Reply All' to a specific email from the cached list using its assigned number.\n    The provided reply text is prepended to the original email's body in the reply.\n\n    Args:\n        email_number (int): The number of the email to reply to, from the cached list.\n        reply_body (str): The content of the reply message. Cannot be empty.\n\n    Returns:\n        str: A JSON string containing a status message confirming the action.\n             Example: '{\"status\": \"Successfully replied to email number 1.\"}'\n    ",
      "args_schema": {
        "properties": {
          "email_number": {
            "title": "Email Number",
            "type": "integer"
          },
          "reply_body": {
            "title": "Reply Body",
            "type": "string"
          }
        },
        "required": [
          "email_number",
          "reply_body"
        ],
        "title": "reply_to_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "compose_email",
      "description": "\n    Composes and sends a new email with the specified subject, body, and recipients.\n\n    Args:\n        subject (str): The subject line of the new email. Cannot be empty.\n        body (str): The main content of the email. Cannot be empty.\n        recipients (List[str]): A list of one or more email addresses for the 'To' field.\n        cc_recipients (List[str], optional): A list of email addresses for the 'CC' field. Defaults to None.\n\n    Returns:\n        str: A JSON string containing a status message confirming that the email was sent.\n             Example: '{\"status\": \"Email with subject 'New Proposal' sent successfully.\"}'\n    ",
      "args_schema": {
        "properties": {
          "subject": {
            "title": "Subject",
            "type": "string"
          },
          "body": {
            "title": "Body",
            "type": "string"
          },
          "recipients": {
            "items": {
              "type": "string"
            },
            "title": "Recipients",
            "type": "array"
          },
          "cc_recipients": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Cc Recipients"
          }
        },
        "required": [
          "subject",
          "body",
          "recipients"
        ],
        "title": "compose_emailArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "list_folders": [
      {
        "case_name": "Basic Folder Listing",
        "purpose": "验证 list_folders 工具能正确列出默认邮箱中的顶级文件夹及其子文件夹。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.3497827053070068,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Mailbox Handling",
        "purpose": "验证当邮箱中没有任何文件夹时，工具返回空数组。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.0959644317626953,
        "is_functional_test": true
      },
      {
        "case_name": "Folder Name Sorting",
        "purpose": "验证返回的文件夹列表是否按字母顺序排序。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.0610404014587402,
        "is_functional_test": true
      },
      {
        "case_name": "Special Character Folder Names",
        "purpose": "验证包含特殊字符的文件夹名称能否被正确处理和返回。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.1416926383972168,
        "is_functional_test": true
      },
      {
        "case_name": "Security Check - No Unauthorized Access",
        "purpose": "确保该工具不会访问或暴露非授权用户的邮箱数据。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.0248019695281982,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Invalid Credentials",
        "purpose": "测试在提供错误认证信息时，工具是否能优雅地失败并返回有意义的错误信息。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.0507702827453613,
        "is_functional_test": false
      },
      {
        "case_name": "Error Handling - Network Failure",
        "purpose": "模拟网络中断情况，验证工具是否能处理连接失败并给出适当反馈。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.022571086883545,
        "is_functional_test": false
      },
      {
        "case_name": "Boundary Test - Maximum Folder Depth",
        "purpose": "验证工具能否处理具有最大允许层级深度的嵌套文件夹结构。",
        "args": {},
        "response": {
          "result": "[\"1291980381@qq.com\", \"Archive\", \"Calendar\", \"Companies\", \"Contacts\", \"Conversation Action Settings\", \"Conversation History\", \"Deleted Items\", \"Drafts\", \"ExternalContacts\", \"Feeds\", \"Files\", \"GAL Contacts\", \"Inbound\", \"Inbox\", \"Journal\", \"Junk Email\", \"Notes\", \"Organizational Contacts\", \"Outbound\", \"Outbox\", \"PeopleCentricConversation Buddies\", \"RSS \\u6e90\", \"Recipient Cache\", \"Sent Items\", \"Tasks\", \"Team Chat\", \"Yammer Root\", \"Yammer \\u6839\\u76ee\\u5f55\", \"npx @modelcontextprotocol/inspector\", \"outformcptest@outlook.com\", \"zhihutangjiang@126.com\", \"{06967759-274D-40B2-A3EB-D7F9E73727D7}\", \"{A9E2BC46-B3A0-4243-B315-60D991004455}\", \"\\u4efb\\u52a1\", \"\\u4f20\\u5165\", \"\\u4f20\\u51fa\", \"\\u516c\\u53f8\", \"\\u51b2\\u7a81\", \"\\u53d1\\u4ef6\\u7bb1\", \"\\u540c\\u6b65\\u95ee\\u9898\", \"\\u540c\\u6b65\\u95ee\\u9898 (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u5783\\u573e\\u90ae\\u4ef6\", \"\\u5927\\u8ba1\\u57fa\", \"\\u5b58\\u6863\", \"\\u5bf9\\u8bdd\\u5386\\u53f2\\u8bb0\\u5f55\", \"\\u5bf9\\u8bdd\\u64cd\\u4f5c\\u8bbe\\u7f6e\", \"\\u5c0f\\u7ec4\\u804a\\u5929\", \"\\u5df2\\u5220\\u9664\", \"\\u5df2\\u5220\\u9664\\u90ae\\u4ef6\", \"\\u5df2\\u53d1\\u9001\", \"\\u5df2\\u53d1\\u9001\\u90ae\\u4ef6\", \"\\u5e7f\\u544a\\u90ae\\u4ef6\", \"\\u5feb\\u901f\\u6b65\\u9aa4\\u8bbe\\u7f6e\", \"\\u63d0\\u9192\", \"\\u6536\\u4ef6\\u7bb1\", \"\\u6587\\u4ef6\", \"\\u65e5\\u5386\", \"\\u65e5\\u8bb0\", \"\\u670d\\u52a1\\u5668\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c\", \"\\u672c\\u5730\\u6545\\u969c (\\u4ec5\\u9650\\u4e8e\\u6b64\\u8ba1\\u7b97\\u673a)\", \"\\u6ce8\\u91ca\", \"\\u6e90\", \"\\u75c5\\u6bd2\\u90ae\\u4ef6\", \"\\u8054\\u7cfb\\u4eba\", \"\\u8349\\...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计1529字符，剩余29字符"
        },
        "execution_time": 1.0538406372070312,
        "is_functional_test": false
      }
    ],
    "list_recent_emails": [
      {
        "case_name": "Basic Email Listing",
        "purpose": "验证 list_recent_emails 工具能正确列出默认文件夹 'Inbox' 中最近10天内的邮件摘要。",
        "args": {
          "days": 10
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.013999700546264648,
        "is_functional_test": true
      },
      {
        "case_name": "Custom Folder Email Listing",
        "purpose": "验证工具能正确列出指定文件夹（如 'Sent Items'）中最近5天的邮件摘要。",
        "args": {
          "days": 5,
          "folder_name": "Sent Items"
        },
        "response": {
          "result": "[{\"number\": 1, \"subject\": \"Test Email\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-13 02:47\"}, {\"number\": 2, \"subject\": \"Email with CC\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-13 02:47\"}, {\"number\": 3, \"subject\": \"\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-13 00:59\"}, {\"number\": 4, \"subject\": \"\\u5e26 CC \\u7684\\u6d4b\\u8bd5\\u90ae\\u4ef6\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-13 00:59\"}, {\"number\": 5, \"subject\": \"Email with CC\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-13 00:51\"}, {\"number\": 6, \"subject\": \"\\u6d4b\\u8bd5\\u90ae\\u4ef6 - Test Email @2025\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-13 00:51\"}, {\"number\": 7, \"subject\": \"Test Email\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-13 00:50\"}, {\"number\": 8, \"subject\": \"Meeting Reminder\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-13 00:44\"}, {\"number\": 9, \"subject\": \"Reminder\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-13 00:44\"}, {\"number\": 10, \"subject\": \"\\u4f1a\\u8bae\\u786e\\u8ba4\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:52\"}, {\"number\": 11, \"subject\": \"\\u9879\\u76ee\\u66f4\\u65b0\\u901a\\u77e5\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:52\"}, {\"number\": 12, \"subject\": \"Test Email\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:45\"}, {\"number\": 13, \"subject\": \"Email with CC\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:45\"}, {\"number\": 14, \"subject\": \"Email with CC\", \"from\": \"Bocheng Peng\", \"received\": \"2025-07-12 20:39\"}, {\"number\": 15, \"s...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计2369字符，剩余869字符"
        },
        "execution_time": 10.342597723007202,
        "is_functional_test": true
      },
      {
        "case_name": "Zero Days Input",
        "purpose": "测试输入 days=0 时是否返回当天收到的所有邮件。",
        "args": {
          "days": 0
        },
        "response": {
          "result": "{\"error\": \"Parameter 'days' must be a positive integer.\"}"
        },
        "execution_time": 0.0061054229736328125,
        "is_functional_test": true
      },
      {
        "case_name": "No Emails Found",
        "purpose": "验证当指定时间段内无邮件时，工具是否返回空数组。",
        "args": {
          "days": 1
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.06082606315612793,
        "is_functional_test": true
      },
      {
        "case_name": "Email Sorting - Most Recent First",
        "purpose": "验证返回的邮件列表是否按接收时间从新到旧排序。",
        "args": {
          "days": 7
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.024007081985473633,
        "is_functional_test": true
      },
      {
        "case_name": "Result Limit Check - Top 100 Emails",
        "purpose": "验证工具最多只返回100封邮件，即使匹配结果超过该数量。",
        "args": {
          "days": 365
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: <unknown>.ReceivedTime\"}"
        },
        "execution_time": 0.04551267623901367,
        "is_functional_test": true
      },
      {
        "case_name": "Special Characters in Folder Name",
        "purpose": "验证包含特殊字符的文件夹名称（如 '测试文件夹'）能否被正确处理并列出邮件。",
        "args": {
          "days": 3,
          "folder_name": "测试文件夹"
        },
        "response": {
          "result": "{\"error\": \"Folder '\\u6d4b\\u8bd5\\u6587\\u4ef6\\u5939' not found in Outlook.\"}"
        },
        "execution_time": 1.419839859008789,
        "is_functional_test": true
      },
      {
        "case_name": "Security Check - Unauthorized Access Attempt",
        "purpose": "确保工具不会访问非授权用户的邮箱数据或越权读取其他用户邮件。",
        "args": {
          "days": 5,
          "folder_name": "Inbox"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.019000530242919922,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Days Parameter",
        "purpose": "测试输入非法天数（如负数）时，工具是否返回错误信息。",
        "args": {
          "days": -1
        },
        "response": {
          "result": "{\"error\": \"Parameter 'days' must be a positive integer.\"}"
        },
        "execution_time": 0.0029964447021484375,
        "is_functional_test": false
      },
      {
        "case_name": "Non-Existent Folder",
        "purpose": "验证工具在请求不存在的文件夹时是否能优雅地失败并返回提示信息。",
        "args": {
          "days": 2,
          "folder_name": "InvalidFolderName"
        },
        "response": {
          "result": "{\"error\": \"Folder 'InvalidFolderName' not found in Outlook.\"}"
        },
        "execution_time": 1.1903619766235352,
        "is_functional_test": false
      },
      {
        "case_name": "Network Failure Handling",
        "purpose": "模拟网络中断情况，验证工具是否能处理连接失败并给出适当反馈。",
        "args": {
          "days": 7
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.014000177383422852,
        "is_functional_test": false
      },
      {
        "case_name": "Maximum Days Boundary",
        "purpose": "测试输入最大有效天数（如999）时工具是否能正常工作。",
        "args": {
          "days": 999
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: <unknown>.ReceivedTime\"}"
        },
        "execution_time": 0.024517297744750977,
        "is_functional_test": false
      }
    ],
    "search_emails": [
      {
        "case_name": "Basic Email Search",
        "purpose": "验证在指定日期范围内搜索关键词邮件的基本功能是否正常工作。",
        "args": {
          "query": "test",
          "start_date": "2025-07-01",
          "end_date": "2025-07-15"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.01800394058227539,
        "is_functional_test": true
      },
      {
        "case_name": "Email Search with Default Folder",
        "purpose": "验证使用默认文件夹 'Inbox' 进行邮件搜索是否按预期工作。",
        "args": {
          "query": "meeting",
          "start_date": "2025-07-10",
          "end_date": "2025-07-14"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.018512248992919922,
        "is_functional_test": true
      },
      {
        "case_name": "Search in Custom Folder",
        "purpose": "验证工具能否在指定的非默认文件夹中正确搜索邮件。",
        "args": {
          "query": "report",
          "start_date": "2025-07-01",
          "end_date": "2025-07-15",
          "folder_name": "Sent Items"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.018999814987182617,
        "is_functional_test": true
      },
      {
        "case_name": "No Matching Emails Found",
        "purpose": "验证当没有匹配搜索条件的邮件时，工具是否返回空数组。",
        "args": {
          "query": "nonexistentkeyword",
          "start_date": "2025-07-01",
          "end_date": "2025-07-15"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.016011953353881836,
        "is_functional_test": true
      },
      {
        "case_name": "Security Check - Unauthorized Folder Access",
        "purpose": "确保工具不会访问未授权用户的文件夹或越权读取其他用户邮件。",
        "args": {
          "query": "confidential",
          "start_date": "2025-07-01",
          "end_date": "2025-07-15",
          "folder_name": "PrivateFolder"
        },
        "response": {
          "result": "{\"error\": \"Folder 'PrivateFolder' not found in Outlook.\"}"
        },
        "execution_time": 0.9886670112609863,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Start Date Format",
        "purpose": "测试开始日期格式不正确时，工具是否返回错误信息。",
        "args": {
          "query": "error",
          "start_date": "2025/07/01",
          "end_date": "2025-07-15"
        },
        "response": {
          "result": "{\"error\": \"Invalid date format. Please use 'YYYY-MM-DD'.\"}"
        },
        "execution_time": 0.0029997825622558594,
        "is_functional_test": false
      },
      {
        "case_name": "Start Date After End Date",
        "purpose": "验证当开始日期晚于结束日期时，工具是否能处理并返回错误提示。",
        "args": {
          "query": "project",
          "start_date": "2025-07-15",
          "end_date": "2025-07-01"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6761\\u4ef6\\u65e0\\u6548\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.01350855827331543,
        "is_functional_test": false
      },
      {
        "case_name": "Special Characters in Query",
        "purpose": "验证包含特殊字符的查询字符串是否被正确处理。",
        "args": {
          "query": "!@#$%^&*()_+{}|:\"<>?`~-=[]\\;',./",
          "start_date": "2025-07-01",
          "end_date": "2025-07-15"
        },
        "response": {
          "result": "{\"error\": \"An unexpected error occurred: (-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u65e0\\u6cd5\\u5206\\u6790\\u6761\\u4ef6\\u3002\\u9519\\u8bef\\u4f4d\\u7f6e\\u5728\\u201c.\\u201d\\u3002', None, 0, -2147352567), None)\"}"
        },
        "execution_time": 0.018001317977905273,
        "is_functional_test": true
      }
    ],
    "get_email_by_number": [
      {
        "case_name": "Basic Email Retrieval",
        "purpose": "验证 get_email_by_number 工具能正确从缓存中检索指定编号的邮件完整信息。",
        "args": {
          "email_number": 1
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.01500248908996582,
        "is_functional_test": true
      },
      {
        "case_name": "Retrieve Email with Invalid Number",
        "purpose": "验证当提供无效或不存在的邮件编号时，工具返回错误提示信息。",
        "args": {
          "email_number": 0
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.010995626449584961,
        "is_functional_test": false
      },
      {
        "case_name": "Negative Email Number Handling",
        "purpose": "测试输入负数作为邮件编号时，工具是否返回参数校验错误。",
        "args": {
          "email_number": -1
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.005001068115234375,
        "is_functional_test": false
      },
      {
        "case_name": "Non-Integer Email Number",
        "purpose": "测试使用非整数类型作为邮件编号时，工具是否拒绝请求并返回错误。",
        "args": {
          "email_number": "one"
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 1 validation error for get_email_by_numberArguments\nemail_number\n  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value='one', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing"
        },
        "execution_time": 0.006998777389526367,
        "is_functional_test": false
      },
      {
        "case_name": "Security Check - Unauthorized Access Attempt",
        "purpose": "确保该工具不会访问非授权用户的邮箱数据或越权读取其他用户邮件。",
        "args": {
          "email_number": 1
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.008002042770385742,
        "is_functional_test": false
      },
      {
        "case_name": "Boundary Test - Minimum Valid Email Number",
        "purpose": "验证最小有效邮件编号（1）能否被正确处理。",
        "args": {
          "email_number": 1
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.010997772216796875,
        "is_functional_test": true
      },
      {
        "case_name": "Boundary Test - Large Email Number",
        "purpose": "测试极大邮件编号（如999999）时工具是否返回错误或合理提示。",
        "args": {
          "email_number": 999999
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 999999. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.006999969482421875,
        "is_functional_test": false
      },
      {
        "case_name": "Special Character in Email Cache",
        "purpose": "验证包含特殊字符的邮件内容能否被正确解析和返回。",
        "args": {
          "email_number": 3
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 3. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.011006355285644531,
        "is_functional_test": true
      }
    ],
    "reply_to_email_by_number": [
      {
        "case_name": "Basic Reply Functionality",
        "purpose": "验证 reply_to_email_by_number 工具能正确向缓存列表中指定编号的邮件发送'回复全部'，并前置自定义内容。",
        "args": {
          "email_number": 1,
          "reply_body": "This is a test reply content."
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 1. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.006999969482421875,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Reply Body Handling",
        "purpose": "测试当提供空字符串作为 reply_body 参数时，工具是否返回参数验证错误。",
        "args": {
          "email_number": 2,
          "reply_body": ""
        },
        "response": {
          "result": "{\"error\": \"Parameter 'reply_body' cannot be empty.\"}"
        },
        "execution_time": 0.00400090217590332,
        "is_functional_test": false
      },
      {
        "case_name": "Non-Existent Email Number",
        "purpose": "验证工具在尝试回复不存在的邮件编号时能否优雅失败并返回提示信息。",
        "args": {
          "email_number": 999,
          "reply_body": "This reply should not be sent due to invalid email number."
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 999. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.009999990463256836,
        "is_functional_test": false
      },
      {
        "case_name": "Special Characters in Reply Body",
        "purpose": "测试包含特殊字符（如中文、标点符号）的回复内容是否能被正确发送。",
        "args": {
          "email_number": 3,
          "reply_body": "这是一个包含中文和特殊符号 @#￥%……& 的测试回复。"
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 3. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.007999420166015625,
        "is_functional_test": true
      },
      {
        "case_name": "Negative Email Number Handling",
        "purpose": "测试使用负数作为邮件编号时，工具是否能正确拒绝请求。",
        "args": {
          "email_number": -1,
          "reply_body": "This reply should not be sent due to negative email number."
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.0069997310638427734,
        "is_functional_test": false
      },
      {
        "case_name": "Zero Email Number Handling",
        "purpose": "测试使用0作为邮件编号时，工具是否能正确拒绝请求。",
        "args": {
          "email_number": 0,
          "reply_body": "This reply should not be sent due to zero email number."
        },
        "response": {
          "result": "{\"error\": \"Parameter 'email_number' must be a positive integer.\"}"
        },
        "execution_time": 0.003000974655151367,
        "is_functional_test": false
      },
      {
        "case_name": "Security Check - Unauthorized Email Access",
        "purpose": "确保该工具不会访问或回复非授权用户的邮件，即使提供了合法编号。",
        "args": {
          "email_number": 4,
          "reply_body": "This reply should not be sent due to unauthorized access attempt."
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 4. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.009003639221191406,
        "is_functional_test": false
      },
      {
        "case_name": "Network Failure Handling During Reply",
        "purpose": "模拟网络中断情况，验证工具是否能处理连接失败并给出适当反馈。",
        "args": {
          "email_number": 5,
          "reply_body": "This reply should fail gracefully due to network issues."
        },
        "response": {
          "result": "{\"error\": \"Invalid email number: 5. Please run list_recent_emails or search_emails first.\"}"
        },
        "execution_time": 0.006001949310302734,
        "is_functional_test": false
      }
    ],
    "compose_email": [
      {
        "case_name": "Basic Email Composition",
        "purpose": "验证 compose_email 工具能否使用基本参数成功发送一封邮件。",
        "args": {
          "subject": "Test Email",
          "body": "This is a test email body.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"status\": \"Email with subject 'Test Email' sent successfully.\"}"
        },
        "execution_time": 35.0746374130249,
        "is_functional_test": true
      },
      {
        "case_name": "Email With CC Recipients",
        "purpose": "验证工具是否能正确处理包含抄送（CC）收件人的邮件发送。",
        "args": {
          "subject": "Email with CC",
          "body": "This email includes a CC recipient.",
          "recipients": [
            "main@example.com"
          ],
          "cc_recipients": [
            "cc@example.com"
          ]
        },
        "response": {
          "result": "{\"status\": \"Email with subject 'Email with CC' sent successfully.\"}"
        },
        "execution_time": 7.509338617324829,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Subject Handling",
        "purpose": "测试当 subject 参数为空时，工具是否返回错误信息。",
        "args": {
          "subject": "",
          "body": "This email has an empty subject.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Parameter 'subject' cannot be empty.\"}"
        },
        "execution_time": 0.00700831413269043,
        "is_functional_test": false
      },
      {
        "case_name": "Empty Body Handling",
        "purpose": "测试当 body 参数为空时，工具是否拒绝发送邮件并返回错误。",
        "args": {
          "subject": "Test Empty Body",
          "body": "",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Parameter 'body' cannot be empty.\"}"
        },
        "execution_time": 0.005998849868774414,
        "is_functional_test": false
      },
      {
        "case_name": "Multiple Recipients",
        "purpose": "验证工具是否支持多个主收件人。",
        "args": {
          "subject": "Multiple Recipients Test",
          "body": "This email is sent to multiple recipients.",
          "recipients": [
            "user1@example.com",
            "user2@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.7821223735809326,
        "is_functional_test": true
      },
      {
        "case_name": "Special Characters in Subject",
        "purpose": "验证主题行中包含特殊字符的邮件是否能被正确发送。",
        "args": {
          "subject": "测试邮件 - Test Mail!@#$%^&*()",
          "body": "This email contains special characters in the subject.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.44194579124450684,
        "is_functional_test": true
      },
      {
        "case_name": "Long Recipient List",
        "purpose": "测试发送给大量收件人时工具的行为。",
        "args": {
          "subject": "Bulk Email Test",
          "body": "This is a test for sending emails to a large list of recipients.",
          "recipients": [
            "user1@example.com",
            "user2@example.com",
            "user3@example.com",
            "user4@example.com",
            "user5@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.29667067527770996,
        "is_functional_test": true
      },
      {
        "case_name": "Missing Required Parameters",
        "purpose": "测试缺少必填参数时工具是否能优雅地失败并提示错误。",
        "args": {
          "body": "This email is missing the subject and recipients.",
          "cc_recipients": [
            "cc@example.com"
          ]
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: 2 validation errors for compose_emailArguments\nsubject\n  Field required [type=missing, input_value={'body': 'This email is m...ts': ['cc@example.com']}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing\nrecipients\n  Field required [type=missing, input_value={'body': 'This email is m...ts': ['cc@example.com']}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.00584721565246582,
        "is_functional_test": false
      },
      {
        "case_name": "Security Check - Unauthorized Email Sending",
        "purpose": "确保该工具不能用于向未经授权的地址发送邮件（如系统管理员邮箱）。",
        "args": {
          "subject": "Unauthorized Email Attempt",
          "body": "Attempt to send email to restricted address.",
          "recipients": [
            "admin@companyinternal.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.4727144241333008,
        "is_functional_test": false
      },
      {
        "case_name": "Network Failure Simulation",
        "purpose": "模拟网络中断情况，验证工具是否能处理连接失败并给出适当反馈。",
        "args": {
          "subject": "Network Failure Test",
          "body": "This email should fail due to simulated network issues.",
          "recipients": [
            "test@example.com"
          ]
        },
        "response": {
          "result": "{\"error\": \"Failed to send email. Details: (-2147467260, '\\u5df2\\u4e2d\\u6b62\\u64cd\\u4f5c', None, None)\"}"
        },
        "execution_time": 0.3409698009490967,
        "is_functional_test": false
      }
    ]
  },
  "total_cases": 54
}