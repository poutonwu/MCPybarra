{
  "server_name": "server",
  "parent_dir": "refined",
  "report_name": "qwen-plus-mcp_outlook_automation_manager",
  "server_path": "workspace/pipeline-output-servers/qwen-plus/mcp_outlook_automation_manager/refined/server.py",
  "timestamp": "2025-07-13T03:10:12.897861",
  "tools": [
    {
      "name": "list_folders",
      "description": "List all available Outlook mail folders.\n    \n    Args:\n        None\n    \n    Returns:\n        JSON string containing a list of folder objects with name and path, like:\n        [\n          {\"name\": \"收件箱\", \"path\": \"\\收件箱\"},\n          {\"name\": \"已发送邮件\", \"path\": \"\\已发送邮件\"},\n          ...\n        ]\n    \n    Raises:\n        RuntimeError: If connection to Outlook fails\n        ValueError: If folder structure cannot be accessed\n\n    Example:\n        >>> list_folders()\n        '[{\"name\": \"收件箱\", \"path\": \"\\\\收件箱\"}]'\n    ",
      "args_schema": {
        "properties": {},
        "title": "list_foldersArguments",
        "type": "object"
      }
    },
    {
      "name": "list_recent_emails",
      "description": "Get recent emails from specified folder and cache them.\n    \n    Args:\n        days (int): Number of days to look back (positive integer)\n        folder_path (str): Path to folder (default is Inbox)\n    \n    Returns:\n        JSON string containing list of email objects with subject, sender, date, like:\n        [\n          {\n            \"subject\": \"会议通知\",\n            \"sender\": \"张三 <zhangsan@example.com>\",\n            \"date\": \"2023-10-15T14:30:00Z\"\n          },\n          ...\n        ]\n    \n    Raises:\n        ValueError: If days is not positive or folder not found\n        RuntimeError: If email retrieval fails\n\n    Example:\n        >>> list_recent_emails(7, \"\\Inbox\")\n        '[{\"subject\": \"项目更新\", \"sender\": \"李四 <lisi@example.com>\", \"date\": \"2023-10-16T09:45:00Z\"}]'\n    ",
      "args_schema": {
        "properties": {
          "days": {
            "title": "Days",
            "type": "integer"
          },
          "folder_path": {
            "default": "\\Inbox",
            "title": "Folder Path",
            "type": "string"
          }
        },
        "required": [
          "days"
        ],
        "title": "list_recent_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_emails",
      "description": "Search emails by date range, contact or keyword.\n    \n    Args:\n        start_date (str): Start date in YYYY-MM-DD format\n        end_date (str): End date in YYYY-MM-DD format\n        folder_path (str): Path to folder (default is Inbox)\n        contact (str): Contact name or email address to filter by (optional)\n        keyword (str): Keyword to search in subject or body (optional)\n    \n    Returns:\n        JSON string containing list of matching emails with subject, sender, date\n    \n    Raises:\n        ValueError: If dates are invalid or folder not found\n        RuntimeError: If search operation fails\n\n    Example:\n        >>> search_emails(\"2023-10-10\", \"2023-10-17\", contact=\"李四\", keyword=\"项目\")\n        '[{\"subject\": \"项目更新\", \"sender\": \"李四 <lisi@example.com>\", \"date\": \"2023-10-16T09:45:00Z\"}]'\n    ",
      "args_schema": {
        "properties": {
          "start_date": {
            "title": "Start Date",
            "type": "string"
          },
          "end_date": {
            "title": "End Date",
            "type": "string"
          },
          "folder_path": {
            "default": "\\Inbox",
            "title": "Folder Path",
            "type": "string"
          },
          "contact": {
            "default": null,
            "title": "Contact",
            "type": "string"
          },
          "keyword": {
            "default": null,
            "title": "Keyword",
            "type": "string"
          }
        },
        "required": [
          "start_date",
          "end_date"
        ],
        "title": "search_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_email_by_number",
      "description": "Get detailed information about a specific email from recent list.\n    \n    Args:\n        email_index (int): Index of email in the last retrieved list\n    \n    Returns:\n        JSON string containing complete email info including subject, sender, date, body, attachments\n    \n    Raises:\n        IndexError: If email index is out of range\n        RuntimeError: If email details cannot be retrieved\n\n    Example:\n        >>> get_email_by_number(0)\n        '{\"subject\": \"合同签署确认\", \"sender\": \"王五 <wangwu@example.com>\", \"date\": \"2023-10-17T11:20:00Z\", \"body\": \"请尽快完成合同签署...\", \"attachments\": [{\"filename\": \"合同.pdf\", \"size\": 245678}]}' \n    ",
      "args_schema": {
        "properties": {
          "email_index": {
            "title": "Email Index",
            "type": "integer"
          }
        },
        "required": [
          "email_index"
        ],
        "title": "get_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "reply_to_email_by_number",
      "description": "Reply to a specific email from recent list.\n    \n    Args:\n        email_index (int): Index of email in the last retrieved list\n        reply_content (str): Content to include in the reply\n    \n    Returns:\n        JSON string confirming successful reply\n    \n    Raises:\n        IndexError: If email index is out of range\n        ValueError: If reply content is empty\n        RuntimeError: If reply operation fails\n\n    Example:\n        >>> reply_to_email_by_number(0, \"我已收到并会尽快处理。\")\n        '\"回复邮件已成功发送。\"'\n    ",
      "args_schema": {
        "properties": {
          "email_index": {
            "title": "Email Index",
            "type": "integer"
          },
          "reply_content": {
            "title": "Reply Content",
            "type": "string"
          }
        },
        "required": [
          "email_index",
          "reply_content"
        ],
        "title": "reply_to_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "compose_email",
      "description": "Create and send a new email.\n    \n    Args:\n        subject (str): Email subject line\n        body (str): Email body text\n        to (str): Recipient email address\n        cc (str): Optional CC recipient address\n    \n    Returns:\n        JSON string confirming successful delivery\n    \n    Raises:\n        ValueError: If required fields are missing or invalid\n        RuntimeError: If email sending fails\n\n    Example:\n        >>> compose_email(\"会议确认\", \"明天下午3点开会\", \"zhangsan@example.com\")\n        '\"邮件已成功发送至 zhangsan@example.com。\"'\n    ",
      "args_schema": {
        "properties": {
          "subject": {
            "title": "Subject",
            "type": "string"
          },
          "body": {
            "title": "Body",
            "type": "string"
          },
          "to": {
            "title": "To",
            "type": "string"
          },
          "cc": {
            "default": null,
            "title": "Cc",
            "type": "string"
          }
        },
        "required": [
          "subject",
          "body",
          "to"
        ],
        "title": "compose_emailArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "list_folders": [
      {
        "case_name": "List Outlook Folders Successfully",
        "purpose": "验证 list_folders 工具能够成功列出 Outlook 中的所有邮件文件夹，使用默认参数进行基本功能测试。",
        "args": {},
        "response": {
          "result": "[{\"name\": \"Inbox\", \"path\": \"\\\\Inbox\"}]"
        },
        "execution_time": 0.032776594161987305,
        "is_functional_test": true
      },
      {
        "case_name": "Outlook Connection Failure Handling",
        "purpose": "验证当无法连接到 Outlook 时，工具是否抛出 RuntimeError 异常。",
        "args": {},
        "response": {
          "result": "[{\"name\": \"Inbox\", \"path\": \"\\\\Inbox\"}]"
        },
        "execution_time": 0.01151895523071289,
        "is_functional_test": false
      },
      {
        "case_name": "Folder Structure Access Error Handling",
        "purpose": "验证当 Outlook 文件夹结构无法访问时，工具是否抛出 ValueError 异常。",
        "args": {},
        "response": {
          "result": "[{\"name\": \"Inbox\", \"path\": \"\\\\Inbox\"}]"
        },
        "execution_time": 0.017812490463256836,
        "is_functional_test": false
      },
      {
        "case_name": "Special Character in Folder Name Handling",
        "purpose": "验证工具是否能正确处理包含特殊字符的文件夹名称（如中文、空格、符号）。",
        "args": {},
        "response": {
          "result": "[{\"name\": \"Inbox\", \"path\": \"\\\\Inbox\"}]"
        },
        "execution_time": 0.01838827133178711,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Folder Structure Handling",
        "purpose": "验证在 Outlook 中没有可用文件夹的情况下，工具是否返回空数组或适当响应。",
        "args": {},
        "response": {
          "result": "[{\"name\": \"Inbox\", \"path\": \"\\\\Inbox\"}]"
        },
        "execution_time": 0.0205078125,
        "is_functional_test": true
      },
      {
        "case_name": "Security Check - Unauthorized Access Attempt",
        "purpose": "验证工具在未经授权访问 Outlook 数据时是否能正确限制访问并抛出异常。",
        "args": {},
        "response": {
          "result": "[{\"name\": \"Inbox\", \"path\": \"\\\\Inbox\"}]"
        },
        "execution_time": 0.01787734031677246,
        "is_functional_test": false
      },
      {
        "case_name": "Maximum Folder Count Boundary Test",
        "purpose": "验证工具在 Outlook 中存在大量文件夹时的边界处理能力。",
        "args": {},
        "response": {
          "result": "[{\"name\": \"Inbox\", \"path\": \"\\\\Inbox\"}]"
        },
        "execution_time": 0.017123937606811523,
        "is_functional_test": true
      },
      {
        "case_name": "Folder Name Length Boundary Test",
        "purpose": "验证工具是否能处理超长文件夹名称的情况。",
        "args": {},
        "response": {
          "result": "[{\"name\": \"Inbox\", \"path\": \"\\\\Inbox\"}]"
        },
        "execution_time": 0.02208709716796875,
        "is_functional_test": true
      }
    ],
    "list_recent_emails": [
      {
        "case_name": "List Recent Emails in Inbox Successfully",
        "purpose": "验证 list_recent_emails 工具能够成功从默认的 Inbox 文件夹中获取最近7天的邮件，使用默认文件夹路径进行基本功能测试。",
        "args": {
          "days": 7
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.06850576400756836,
        "is_functional_test": true
      },
      {
        "case_name": "List Recent Emails in Custom Folder Successfully",
        "purpose": "验证 list_recent_emails 工具能够成功从指定的非默认邮件文件夹中获取最近3天的邮件，测试自定义路径功能。",
        "args": {
          "days": 3,
          "folder_path": "\\Work\\Urgent"
        },
        "response": {
          "error": "ToolException: Error executing tool list_recent_emails: Error retrieving recent emails: Root folder not found: Work"
        },
        "execution_time": 0.010386228561401367,
        "is_functional_test": true
      },
      {
        "case_name": "Email Retrieval Failure Handling",
        "purpose": "验证当无法从邮件服务器检索邮件时，工具是否抛出 RuntimeError 异常。",
        "args": {
          "days": 5,
          "folder_path": "\\Inbox"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.0537569522857666,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Days Parameter Handling",
        "purpose": "验证当提供无效的 days 参数（如0或负数）时，工具是否抛出 ValueError 异常。",
        "args": {
          "days": -1,
          "folder_path": "\\Inbox"
        },
        "response": {
          "error": "ToolException: Error executing tool list_recent_emails: Error retrieving recent emails: Days must be a positive number"
        },
        "execution_time": 0.004014730453491211,
        "is_functional_test": false
      },
      {
        "case_name": "Nonexistent Folder Path Handling",
        "purpose": "验证当提供的文件夹路径不存在时，工具是否抛出 ValueError 异常。",
        "args": {
          "days": 2,
          "folder_path": "\\InvalidFolder"
        },
        "response": {
          "error": "ToolException: Error executing tool list_recent_emails: Error retrieving recent emails: Root folder not found: InvalidFolder"
        },
        "execution_time": 0.012000799179077148,
        "is_functional_test": false
      },
      {
        "case_name": "Special Character in Folder Path Handling",
        "purpose": "验证工具是否能正确处理包含特殊字符（如中文、空格、符号）的文件夹路径。",
        "args": {
          "days": 1,
          "folder_path": "\\收件箱\\重要邮件#2023"
        },
        "response": {
          "error": "ToolException: Error executing tool list_recent_emails: Error retrieving recent emails: Folder not found: 重要邮件#2023"
        },
        "execution_time": 0.008011579513549805,
        "is_functional_test": true
      },
      {
        "case_name": "Maximum Days Boundary Test",
        "purpose": "验证工具在设置最大合理天数（例如365天）时的行为是否符合预期。",
        "args": {
          "days": 365,
          "folder_path": "\\Inbox"
        },
        "response": {
          "result": "[{\"subject\": \"Please sign in to your Outlook.com account\", \"sender\": \"Outlook.com Team\", \"date\": \"2025-06-30T17:04:04Z\"}]"
        },
        "execution_time": 5.202737092971802,
        "is_functional_test": true
      },
      {
        "case_name": "Minimum Days Boundary Test",
        "purpose": "验证工具在设置最小有效天数（1天）时的行为是否正常。",
        "args": {
          "days": 1,
          "folder_path": "\\Inbox"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.11227869987487793,
        "is_functional_test": true
      }
    ],
    "search_emails": [
      {
        "case_name": "Search Emails in Default Date Range Successfully",
        "purpose": "验证在默认收件箱路径中，使用默认日期范围搜索邮件的基本功能是否正常。",
        "args": {
          "start_date": "2023-10-01",
          "end_date": "2023-10-31"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.011047601699829102,
        "is_functional_test": true
      },
      {
        "case_name": "Search Emails by Contact Successfully",
        "purpose": "验证通过联系人过滤邮件的功能是否正常，使用默认收件箱路径和指定日期范围。",
        "args": {
          "start_date": "2023-10-10",
          "end_date": "2023-10-17",
          "contact": "李四"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: Error searching emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.011490583419799805,
        "is_functional_test": true
      },
      {
        "case_name": "Search Emails by Keyword Successfully",
        "purpose": "验证通过关键词搜索邮件主题或正文的功能是否正常，使用默认收件箱路径和指定日期范围。",
        "args": {
          "start_date": "2023-10-10",
          "end_date": "2023-10-17",
          "keyword": "项目"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: Error searching emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.01190805435180664,
        "is_functional_test": true
      },
      {
        "case_name": "Search Emails in Custom Folder Successfully",
        "purpose": "验证工具能够成功从非默认文件夹路径中搜索邮件，测试自定义路径功能。",
        "args": {
          "start_date": "2023-10-01",
          "end_date": "2023-10-31",
          "folder_path": "\\Work\\Urgent"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: Error searching emails: Root folder not found: Work"
        },
        "execution_time": 0.011514663696289062,
        "is_functional_test": true
      },
      {
        "case_name": "Invalid Start Date Format Handling",
        "purpose": "验证当提供的开始日期格式不正确时，工具是否抛出 ValueError 异常。",
        "args": {
          "start_date": "2023/10/10",
          "end_date": "2023-10-17"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: Error searching emails: Invalid date format: time data '2023/10/10' does not match format '%Y-%m-%d'. Please use YYYY-MM-DD format."
        },
        "execution_time": 0.0057566165924072266,
        "is_functional_test": false
      },
      {
        "case_name": "Start Date After End Date Handling",
        "purpose": "验证当提供的开始日期晚于结束日期时，工具是否抛出 ValueError 异常。",
        "args": {
          "start_date": "2023-10-18",
          "end_date": "2023-10-17"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.01151132583618164,
        "is_functional_test": false
      },
      {
        "case_name": "Nonexistent Folder Path Handling",
        "purpose": "验证当提供的文件夹路径不存在时，工具是否抛出 ValueError 异常。",
        "args": {
          "start_date": "2023-10-01",
          "end_date": "2023-10-31",
          "folder_path": "\\InvalidFolder"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: Error searching emails: Root folder not found: InvalidFolder"
        },
        "execution_time": 0.009896278381347656,
        "is_functional_test": false
      },
      {
        "case_name": "Special Character in Folder Path Handling",
        "purpose": "验证工具是否能正确处理包含特殊字符（如中文、空格、符号）的文件夹路径。",
        "args": {
          "start_date": "2023-10-01",
          "end_date": "2023-10-31",
          "folder_path": "\\收件箱\\重要邮件#2023"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: Error searching emails: Folder not found: 重要邮件#2023"
        },
        "execution_time": 0.024739503860473633,
        "is_functional_test": true
      }
    ],
    "get_email_by_number": [
      {
        "case_name": "Get Email by Index Successfully",
        "purpose": "验证 get_email_by_number 工具能够成功根据索引获取指定邮件的详细信息，使用默认测试数据进行基本功能测试。",
        "args": {
          "email_index": 0
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: Error retrieving email details: Email index out of range (0--1)"
        },
        "execution_time": 0.003999233245849609,
        "is_functional_test": true
      },
      {
        "case_name": "Email Index Out of Range Handling",
        "purpose": "验证当提供的邮件索引超出范围时，工具是否抛出 IndexError 异常。",
        "args": {
          "email_index": -1
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: Error retrieving email details: Email index out of range (0--1)"
        },
        "execution_time": 0.005525350570678711,
        "is_functional_test": false
      },
      {
        "case_name": "Email Index Out of Bounds Handling",
        "purpose": "验证当提供的邮件索引大于当前邮件列表长度时，工具是否抛出 IndexError 异常。",
        "args": {
          "email_index": 999
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: Error retrieving email details: Email index out of range (0--1)"
        },
        "execution_time": 0.0060846805572509766,
        "is_functional_test": false
      },
      {
        "case_name": "Non-Integer Email Index Handling",
        "purpose": "验证当提供的邮件索引不是整数类型时，工具是否能正确处理参数类型错误。",
        "args": {
          "email_index": "first"
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 1 validation error for get_email_by_numberArguments\nemail_index\n  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value='first', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing"
        },
        "execution_time": 0.007007598876953125,
        "is_functional_test": false
      },
      {
        "case_name": "Security Check - Unauthorized Access to Email Details",
        "purpose": "验证在未经授权的情况下尝试访问邮件详情时，工具是否能正确限制访问并抛出异常。",
        "args": {
          "email_index": 0
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: Error retrieving email details: Email index out of range (0--1)"
        },
        "execution_time": 0.005727529525756836,
        "is_functional_test": false
      },
      {
        "case_name": "Maximum Email Index Boundary Test",
        "purpose": "验证工具在最大合理邮件索引值（如2^31-1）时的行为是否正常。",
        "args": {
          "email_index": 2147483647
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: Error retrieving email details: Email index out of range (0--1)"
        },
        "execution_time": 0.004556179046630859,
        "is_functional_test": true
      },
      {
        "case_name": "Minimum Email Index Boundary Test",
        "purpose": "验证工具在最小合理邮件索引值（如-2^31）时的行为是否正常。",
        "args": {
          "email_index": -2147483648
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: Error retrieving email details: Email index out of range (0--1)"
        },
        "execution_time": 0.005006313323974609,
        "is_functional_test": true
      },
      {
        "case_name": "Email Retrieval Failure Handling",
        "purpose": "验证当无法从邮件服务器检索指定邮件时，工具是否抛出 RuntimeError 异常。",
        "args": {
          "email_index": 1
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: Error retrieving email details: Email index out of range (0--1)"
        },
        "execution_time": 0.00699925422668457,
        "is_functional_test": false
      }
    ],
    "reply_to_email_by_number": [
      {
        "case_name": "Reply to First Email Successfully",
        "purpose": "验证 reply_to_email_by_number 工具能够成功回复最近邮件列表中的第一封邮件，使用默认参数进行基本功能测试。",
        "args": {
          "email_index": 0,
          "reply_content": "我已收到并会尽快处理。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: Error replying to email: Email index out of range (0--1)"
        },
        "execution_time": 0.004031658172607422,
        "is_functional_test": true
      },
      {
        "case_name": "Empty Reply Content Handling",
        "purpose": "验证当提供的回复内容为空时，工具是否抛出 ValueError 异常。",
        "args": {
          "email_index": 1,
          "reply_content": ""
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: Error replying to email: Email index out of range (0--1)"
        },
        "execution_time": 0.006968021392822266,
        "is_functional_test": false
      },
      {
        "case_name": "Negative Email Index Handling",
        "purpose": "验证当提供的邮件索引为负数时，工具是否抛出 IndexError 异常。",
        "args": {
          "email_index": -1,
          "reply_content": "这是一个测试回复。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: Error replying to email: Email index out of range (0--1)"
        },
        "execution_time": 0.007090330123901367,
        "is_functional_test": false
      },
      {
        "case_name": "Email Index Out of Range Handling",
        "purpose": "验证当提供的邮件索引超出当前邮件列表范围时，工具是否抛出 IndexError 异常。",
        "args": {
          "email_index": 10,
          "reply_content": "这是一个测试回复。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: Error replying to email: Email index out of range (0--1)"
        },
        "execution_time": 0.005005836486816406,
        "is_functional_test": false
      },
      {
        "case_name": "Reply with Special Characters in Content",
        "purpose": "验证工具是否能正确处理包含特殊字符（如中文、表情符号）的回复内容。",
        "args": {
          "email_index": 0,
          "reply_content": "你好😊，我会尽快处理！#测试回复"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: Error replying to email: Email index out of range (0--1)"
        },
        "execution_time": 0.0054814815521240234,
        "is_functional_test": true
      },
      {
        "case_name": "Security Check - Unauthorized Reply Attempt",
        "purpose": "验证在未经授权的情况下尝试发送邮件时，工具是否抛出 RuntimeError 异常。",
        "args": {
          "email_index": 0,
          "reply_content": "这是一个安全测试回复。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: Error replying to email: Email index out of range (0--1)"
        },
        "execution_time": 0.006048440933227539,
        "is_functional_test": false
      },
      {
        "case_name": "Maximum Email Index Boundary Test",
        "purpose": "验证工具在设置最大合理邮件索引值时的行为是否符合预期。",
        "args": {
          "email_index": 2147483647,
          "reply_content": "这是一个边界测试回复。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: Error replying to email: Email index out of range (0--1)"
        },
        "execution_time": 0.005995750427246094,
        "is_functional_test": true
      }
    ],
    "compose_email": [
      {
        "case_name": "Send Email Successfully with Required Fields",
        "purpose": "验证使用必填字段（主题、正文、收件人）时，compose_email 工具能成功发送邮件。",
        "args": {
          "subject": "测试邮件",
          "body": "这是一封测试邮件内容。",
          "to": "test@example.com"
        },
        "response": {
          "result": "\"邮件已成功发送至 test@example.com。\""
        },
        "execution_time": 10.63677167892456,
        "is_functional_test": true
      },
      {
        "case_name": "Send Email with CC Field",
        "purpose": "验证使用可选 CC 字段时，compose_email 工具能正确发送邮件。",
        "args": {
          "subject": "测试带 CC 邮件",
          "body": "这封邮件包含 CC 收件人。",
          "to": "test@example.com",
          "cc": "cc@example.com"
        },
        "response": {
          "result": "\"邮件已成功发送至 test@example.com。\""
        },
        "execution_time": 5.972658634185791,
        "is_functional_test": true
      },
      {
        "case_name": "Missing Subject Field Handling",
        "purpose": "验证当 subject 字段缺失时，工具是否抛出 ValueError 异常。",
        "args": {
          "body": "缺少主题的邮件内容",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: 1 validation error for compose_emailArguments\nsubject\n  Field required [type=missing, input_value={'body': '缺少主题的...to': 'test@example.com'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.003999471664428711,
        "is_functional_test": false
      },
      {
        "case_name": "Missing Body Field Handling",
        "purpose": "验证当 body 字段缺失时，工具是否抛出 ValueError 异常。",
        "args": {
          "subject": "缺少正文的邮件",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: 1 validation error for compose_emailArguments\nbody\n  Field required [type=missing, input_value={'subject': '缺少正文...to': 'test@example.com'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.009523868560791016,
        "is_functional_test": false
      },
      {
        "case_name": "Missing To Field Handling",
        "purpose": "验证当 to 字段缺失时，工具是否抛出 ValueError 异常。",
        "args": {
          "subject": "缺少收件人的邮件",
          "body": "这封邮件没有收件人"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: 1 validation error for compose_emailArguments\nto\n  Field required [type=missing, input_value={'subject': '缺少收件...邮件没有收件人'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.006999492645263672,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Email Address Handling",
        "purpose": "验证当提供无效的邮箱地址时，工具是否抛出 ValueError 异常。",
        "args": {
          "subject": "测试无效邮箱",
          "body": "这封邮件的收件人地址格式错误",
          "to": "invalid-email"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: Error sending email: (-2147467260, '已中止操作', None, None)"
        },
        "execution_time": 0.46614646911621094,
        "is_functional_test": false
      },
      {
        "case_name": "Long Subject Boundary Test",
        "purpose": "验证 compose_email 工具是否能处理超长 subject 字段。",
        "args": {
          "subject": "这是一个非常长的主题字段，用于测试 compose_email 工具在极端情况下的处理能力，确保其不会因字段过长而崩溃或出错。",
          "body": "测试超长主题的邮件正文。",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: Error sending email: (-2147467260, '已中止操作', None, None)"
        },
        "execution_time": 0.4137403964996338,
        "is_functional_test": true
      },
      {
        "case_name": "Special Characters in Subject Handling",
        "purpose": "验证 compose_email 工具是否能正确处理包含特殊字符（如中文、符号）的 subject 字段。",
        "args": {
          "subject": "会议通知@2025-07-01 #重要",
          "body": "请准时参加。",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: Error sending email: (-2147467260, '已中止操作', None, None)"
        },
        "execution_time": 0.3368265628814697,
        "is_functional_test": true
      }
    ]
  },
  "total_cases": 47
}