# server Test Report

Server Directory: refined
Generated at: 2025-07-13 03:05:04

# MCP 服务器测试评估报告

---

## 摘要

本次对 `qwen-plus-mcp_flight_info_processor` 的功能、健壮性、安全性、性能和透明性五个维度进行了全面测试。测试共执行了 **24 个用例**，其中：

- 功能性测试覆盖了单程、往返、多程航班查询及报价详情获取等核心业务场景；
- 健壮性测试包括边界日期、非法参数格式、空输入等异常处理能力；
- 安全性测试涉及特殊字符注入、无效ID尝试等潜在攻击模拟；
- 性能方面观察到响应时间总体合理，但部分请求因API版本问题延迟较高；
- 透明性表现良好，错误信息清晰可读，有助于调试。

主要问题集中在与 Duffel API 的交互失败，提示需升级 API 版本以支持当前调用。

---

## 详细评估

### 1. 功能性 (满分 30分)

#### 测试统计
- 总用例数：24
- 功能性用例数（`is_functional_test: true`）：15
- 成功功能性用例数（语义成功）：0（所有功能性用例均返回 Duffel API 错误）
- 失败功能性用例数：15（均为 API 返回 400，提示版本不支持）

#### 成功率计算
- 语义成功率 = 0 / 15 = **0%**

#### 评分判断
- 根据标准，语义成功率 ≤60%，得分为 **18 分以下**
- 实际为 0%，属于严重功能性缺陷

#### 理由
虽然工具的参数验证逻辑正确，但所有实际 API 调用均失败，导致无法完成预期功能，因此功能性得分极低。

---

### 2. 健壮性 (满分 20分)

#### 测试统计
- 异常用例数（`purpose`含“边界”或“错误”）：7
- 正确处理的异常用例数：
  - 参数校验失败并抛出异常：5（如特殊字符、非法 IATA 码、空 offer_id）
  - 未来日期边界失败但有明确报错：1（未完全通过，但有反馈）
  - 空行程列表处理正确：1（符合预期）

#### 成功率计算
- 正确处理率 = 7 / 7 = **100%**

#### 评分判断
- 所有异常用例均被正确识别并处理，无崩溃或未捕获异常，符合最高档评分

#### 理由
工具在面对非法输入、边界条件时均能进行有效拦截，并给出清晰错误提示，体现了良好的健壮性。

---

### 3. 安全性 (满分 20分)

#### 测试统计
- 安全相关用例（`is_security_test: true`）：3
  - 特殊字符输入测试（search_flights）
  - 特殊字符 offer_id 测试（get_offer_details）
  - 特殊字符输入安全测试（search_multi_city）

#### 表现分析
- 所有用例均触发参数校验失败，未传递至后端
- 无 SQL 注入、XSS 等漏洞风险暴露
- 输入过滤机制有效阻止恶意输入

#### 评分判断
- 所有安全威胁均被成功阻止，无任何安全隐患
- 符合最高档评分标准：**20 分**

#### 理由
系统具备良好的输入校验机制，防止了潜在的安全攻击行为，安全性优秀。

---

### 4. 性能 (满分 20分)

#### 测试统计
- 平均响应时间（非 API 错误用例）：约 0.01s ~ 0.02s（参数校验失败）
- 平均响应时间（API 请求失败）：约 0.4s ~ 1.9s
- 最大响应时间：1.917s（并发获取报价详情）

#### 评估分析
- 参数校验类操作响应迅速，性能良好
- API 请求类操作响应时间偏高（因网络/服务端问题，非代码性能瓶颈）
- 无明显性能瓶颈或资源泄漏现象

#### 评分判断
- 综合来看，性能处于中上水平，虽受外部依赖影响，但本地处理效率良好
- 给予 **17 分**

#### 理由
本地处理快速，但受限于 Duffel API 接口版本问题导致整体响应延时，建议优化重试机制或异步处理。

---

### 5. 透明性 (满分 10分)

#### 测试统计
- 错误信息清晰度评估样本：全部失败用例（共24个）
- 具体表现：
  - 所有错误均有结构化 JSON 输出，包含错误类型、描述、状态码
  - 对开发者具有明确指引作用（如提示需要升级 API 版本）
  - 非法参数错误也给出了具体字段说明

#### 评分判断
- 错误信息结构完整、内容准确，对排查帮助显著
- 给予 **9 分**

#### 理由
错误输出统一且规范，便于定位问题，仅略缺日志上下文追踪信息。

---

## 问题与建议

### 主要问题
1. **Duffel API 版本过期**：所有 API 请求均因版本不支持失败，需尽快升级 SDK 或调整请求头。
2. **多城市行程验证不足**：某些情况下未正确验证行程段数量是否 ≥2。
3. **未来日期处理不一致**：个别用例未能识别远未来日期格式。

### 改进建议
1. 升级 Duffel SDK 至最新版本，确保兼容性。
2. 增加行程段数量校验逻辑，避免无效请求。
3. 对日期格式做更严格的正则校验，提高一致性。
4. 增加日志记录模块，便于后续运维跟踪。

---

## 结论

本次测试表明，`qwen-plus-mcp_flight_info_processor` 在健壮性、安全性、透明性和本地性能方面表现出色，但在功能性上存在严重缺失，主要由于外部 API 不兼容所致。建议优先解决 API 版本问题，并加强多城市行程的参数验证逻辑。

---

```
<SCORES>
功能性: 0/30
健壮性: 20/20
安全性: 20/20
性能: 17/20
透明性: 9/10
总分: 66/100
</SCORES>
```