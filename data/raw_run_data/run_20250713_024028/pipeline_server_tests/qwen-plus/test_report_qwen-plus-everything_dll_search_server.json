{
  "server_name": "server",
  "parent_dir": "refined",
  "report_name": "qwen-plus-everything_dll_search_server",
  "server_path": "workspace/pipeline-output-servers/qwen-plus/everything_dll_search_server/refined/server.py",
  "timestamp": "2025-07-13T03:05:01.871443",
  "tools": [
    {
      "name": "search_files",
      "description": "\n    Executes a file search on the local Windows system using the loaded `everything.dll` with the specified query parameters.\n\n    Args:\n        query: The search query string (non-empty).\n        sort_by: Sorting criteria ('name', 'path', 'size', 'date'). Defaults to 'name'.\n        max_results: Maximum number of results to return (positive integer). Defaults to 100.\n        case_sensitive: Whether the search should be case-sensitive. Defaults to False.\n        match_whole_word: Whether to match whole words only. Defaults to False.\n        use_regex: Whether to interpret the query as a regular expression. Defaults to False.\n\n    Returns:\n        A JSON-formatted string containing the search results or an error message.\n\n    Example:\n        >>> search_files(query=\"file.txt\", sort_by=\"name\", max_results=10)\n        '[{\"filename\": \"file.txt\", \"full_path\": \"D:\\tmp\\file.txt\", \"size\": 1024}]'\n\n    Raises:\n        ValueError: If any input parameter is invalid.\n        RuntimeError: If the Everything query fails.\n    ",
      "args_schema": {
        "properties": {
          "query": {
            "title": "Query",
            "type": "string"
          },
          "sort_by": {
            "default": "name",
            "title": "Sort By",
            "type": "string"
          },
          "max_results": {
            "default": 100,
            "title": "Max Results",
            "type": "integer"
          },
          "case_sensitive": {
            "default": false,
            "title": "Case Sensitive",
            "type": "boolean"
          },
          "match_whole_word": {
            "default": false,
            "title": "Match Whole Word",
            "type": "boolean"
          },
          "use_regex": {
            "default": false,
            "title": "Use Regex",
            "type": "boolean"
          }
        },
        "required": [
          "query"
        ],
        "title": "search_filesArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "search_files": [
      {
        "case_name": "Basic File Search by Name",
        "purpose": "验证使用默认参数按文件名搜索的基本功能是否正常工作",
        "args": {
          "query": "saved_document.docx"
        },
        "response": {
          "result": "[{\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\workspace\\\\pipeline-output-servers\\\\qwen-plus\\\\mcp_word_document_automation\\\\refined\\\\custom_saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\.git\\\\hidden_saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\$RECYCLE.BIN\\\\S-1-5-21-3980691320-1577971525-2302641607-1001\\\\$R1ZJCBF\\\\saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\nonexistent_dir\\\\saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\workspace\\\\pipeline-output-servers\\\\gpt-4o\\\\mcp_word_document_automation\\\\refined\\\\saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\workspace\\\\pipeline-output-servers\\\\gpt-4o\\\\mcp_word_document_processor\\\\refined\\\\saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\workspace\\\\pipeline-output-servers\\\\qwen-plus\\\\mcp_word_document_automation\\\\refined\\\\saved_document.docx\", \"size\": 0}]"
        },
        "execution_time": 0.07666945457458496,
        "is_functional_test": true
      },
      {
        "case_name": "Search with Case Sensitivity",
        "purpose": "验证启用大小写敏感搜索时能否正确匹配文件",
        "args": {
          "query": "Saved_Document.docx",
          "case_sensitive": true
        },
        "response": {
          "result": "[{\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\workspace\\\\pipeline-output-servers\\\\qwen-plus\\\\mcp_word_document_automation\\\\refined\\\\custom_saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\.git\\\\hidden_saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\$RECYCLE.BIN\\\\S-1-5-21-3980691320-1577971525-2302641607-1001\\\\$R1ZJCBF\\\\saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\nonexistent_dir\\\\saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\workspace\\\\pipeline-output-servers\\\\gpt-4o\\\\mcp_word_document_automation\\\\refined\\\\saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\workspace\\\\pipeline-output-servers\\\\gpt-4o\\\\mcp_word_document_processor\\\\refined\\\\saved_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\workspace\\\\pipeline-output-servers\\\\qwen-plus\\\\mcp_word_document_automation\\\\refined\\\\saved_document.docx\", \"size\": 0}]"
        },
        "execution_time": 0.06832695007324219,
        "is_functional_test": true
      },
      {
        "case_name": "Search Sorted by Date",
        "purpose": "验证按修改时间排序的搜索结果是否正确",
        "args": {
          "query": ".docx",
          "sort_by": "date"
        },
        "response": {
          "result": "[{\"filename\": \"\", \"full_path\": \"D:\\\\tmp\\\\发明人专利抽取数据\\\\华夏重工集团 2024 年度研发与知识产权综合报告.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\tmp\\\\public-mcp-servers\\\\Office-Word-MCP-Server-main\\\\sdsd.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\tmp\\\\MCPServer-Generator-7-5-修改gen流程前\\\\workspace\\\\refinement\\\\mcp_word_processor_refined\\\\temp_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\tmp\\\\MCPServer-Generator-7-5-修改gen流程前\\\\workspace\\\\refinement\\\\mcp_server_word_operations_refined\\\\invalid_path\\\\new_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\tmp\\\\MCPServer-Generator-7-5-修改gen流程前\\\\workspace\\\\refinement\\\\mcp_server_word_operations_refined\\\\invalid\\\\path\\\\to\\\\file.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\tmp\\\\MCPServer-Generator-7-5-修改gen流程前\\\\workspace\\\\refinement\\\\mcp_server_word_operations_refined\\\\invalid\\\\path\\\\document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\tmp\\\\MCPServer-Generator-7-5-修改gen流程前\\\\workspace\\\\public-mcp-servers\\\\Office-Word-MCP-Server-main\\\\中文文档.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\tmp\\\\MCPServer-Generator-7-5-修改gen流程前\\\\workspace\\\\public-mcp-servers\\\\Office-Word-MCP-Server-main\\\\null_title_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\tmp\\\\MCPServer-Generator-7-5-修改gen流程前\\\\workspace\\\\public-mcp-servers\\\\Office-Word-MCP-Server-main\\\\null_author_document.docx\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\tmp\\\\MCPServer-Generator-7-5-修改gen流程前\\\\workspace\\\\public-mcp-...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计17099字符，剩余15599字符"
        },
        "execution_time": 0.1437215805053711,
        "is_functional_test": true
      },
      {
        "case_name": "Limit Results to 5",
        "purpose": "验证最大返回结果数限制是否生效",
        "args": {
          "query": ".png",
          "max_results": 5
        },
        "response": {
          "result": "[{\"filename\": \"\", \"full_path\": \"D:\\\\software\\\\LR2024\\\\Adobe Photoshop Lightroom Classic 2024\\\\安装教程\\\\#文章底部的广告帮忙点一下哦！ 公众号：Win软件管家.png\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\software\\\\PS2024\\\\Adobe Photoshop 2024\\\\安装教程\\\\#文章底部的广告帮忙点一下哦！ 公众号：Win软件管家.png\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\$RECYCLE.BIN\\\\S-1-5-21-3980691320-1577971525-2302641607-1001\\\\$I02Q9UJ.png\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\$RECYCLE.BIN\\\\S-1-5-21-3980691320-1577971525-2302641607-1001\\\\$I0AA6MX.png\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\$RECYCLE.BIN\\\\S-1-5-21-3980691320-1577971525-2302641607-1001\\\\$I0BB8PN.png\", \"size\": 0}]"
        },
        "execution_time": 0.2149207592010498,
        "is_functional_test": true
      },
      {
        "case_name": "Match Whole Word Only",
        "purpose": "验证全词匹配搜索是否排除部分匹配项",
        "args": {
          "query": "hit",
          "match_whole_word": true
        },
        "response": {
          "result": "[{\"filename\": \"\", \"full_path\": \"C:\\\\Users\\\\PS\\\\AppData\\\\Roaming\\\\kingsoft\\\\wps\\\\addons\\\\pool\\\\win-i386\\\\qing_3.1.0.7251\\\\wpsbox\\\\res\\\\subtheme\\\\res\\\\2018white\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Users\\\\PS\\\\AppData\\\\Roaming\\\\kingsoft\\\\wps\\\\addons\\\\pool\\\\win-i386\\\\qing_3.1.0.7643\\\\wpsbox\\\\res\\\\subtheme\\\\res\\\\2018white\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\software\\\\wps\\\\WPS Office\\\\12.1.0.21541\\\\office6\\\\addons\\\\kcooperatearea\\\\mui\\\\default\\\\subtheme\\\\res\\\\2018white\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\software\\\\wps\\\\WPS Office\\\\12.1.0.21541\\\\office6\\\\addons\\\\wpsbox\\\\res\\\\subtheme\\\\res\\\\2018white\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\software\\\\wps\\\\WPS Office\\\\12.1.0.21915\\\\office6\\\\addons\\\\kcooperatearea\\\\mui\\\\default\\\\subtheme\\\\res\\\\2018white\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"D:\\\\software\\\\wps\\\\WPS Office\\\\12.1.0.21915\\\\office6\\\\addons\\\\wpsbox\\\\res\\\\subtheme\\\\res\\\\2018white\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Users\\\\PS\\\\AppData\\\\Roaming\\\\kingsoft\\\\wps\\\\addons\\\\pool\\\\win-i386\\\\kappessframework_3.1.0.1325\\\\mui\\\\default\\\\theme\\\\res\\\\2018white_dark\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Users\\\\PS\\\\AppData\\\\Roaming\\\\kingsoft\\\\wps\\\\addons\\\\pool\\\\win-i386\\\\kappessframework_3.1.0.1735\\\\mui\\\\default\\\\theme\\\\res\\\\2018white_dark\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Users\\\\PS\\\\AppData\\\\Roaming\\\\kingsoft\\\\wps\\\\addons\\\\pool\\\\win-i386\\\\khyperion_3.1.0.5492\\\\mui\\\\default\\\\subtheme\\\\res\\\\2018white_dar...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计17985字符，剩余16485字符"
        },
        "execution_time": 0.10299825668334961,
        "is_functional_test": true
      },
      {
        "case_name": "Regex Search for Special Characters",
        "purpose": "验证正则表达式搜索是否能正确识别特殊字符命名的文件",
        "args": {
          "query": ".*_.*\\.docx",
          "use_regex": true
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.15078186988830566,
        "is_functional_test": true
      },
      {
        "case_name": "Search Hidden Files in .git",
        "purpose": "验证工具是否能够搜索到隐藏在.git目录中的文件",
        "args": {
          "query": "hidden_saved_document.docx"
        },
        "response": {
          "result": "[{\"filename\": \"\", \"full_path\": \"D:\\\\devWorkspace\\\\MCPServer-Generator\\\\testSystem\\\\testFiles\\\\.git\\\\hidden_saved_document.docx\", \"size\": 0}]"
        },
        "execution_time": 0.059998273849487305,
        "is_functional_test": true
      },
      {
        "case_name": "Invalid Query Parameter",
        "purpose": "验证空查询参数是否被拒绝并抛出错误",
        "args": {
          "query": ""
        },
        "response": {
          "result": "{\"error\": \"An error occurred: 'query' must be a non-empty string.\"}"
        },
        "execution_time": 0.003998756408691406,
        "is_functional_test": false
      },
      {
        "case_name": "Invalid Sort Criteria",
        "purpose": "验证无效的排序字段是否触发参数验证错误",
        "args": {
          "query": "test",
          "sort_by": "invalid_sort"
        },
        "response": {
          "result": "{\"error\": \"An error occurred: Invalid 'sort_by' value 'invalid_sort'. Must be one of ['name', 'path', 'size', 'date'].\"}"
        },
        "execution_time": 0.004002094268798828,
        "is_functional_test": false
      },
      {
        "case_name": "Negative Max Results",
        "purpose": "验证负值作为最大结果数是否被拒绝",
        "args": {
          "query": "test",
          "max_results": -10
        },
        "response": {
          "result": "{\"error\": \"An error occurred: 'max_results' must be a positive integer.\"}"
        },
        "execution_time": 0.004956722259521484,
        "is_functional_test": false
      },
      {
        "case_name": "Very Long File Name Search",
        "purpose": "验证超长文件名搜索是否处理正常",
        "args": {
          "query": "this_is_a_very_long_file_name_that_exceeds_the_typical_limit_of_255_characters_and_might_cause_issues_in_some_systems_or_applications_but_should_be_handled_properly_by_this_tool.docx"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.026500940322875977,
        "is_functional_test": true
      },
      {
        "case_name": "Special Characters in Regex",
        "purpose": "验证包含特殊字符的正则表达式是否正确解析",
        "args": {
          "query": "\\w+@#\\$_test",
          "use_regex": true
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.39335012435913086,
        "is_functional_test": true
      },
      {
        "case_name": "Search for Non-Existent File",
        "purpose": "验证搜索不存在的文件是否返回空结果而非报错",
        "args": {
          "query": "nonexistentfile.xyz"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.0705263614654541,
        "is_functional_test": true
      },
      {
        "case_name": "Security Test - Restricted Directory Access",
        "purpose": "验证工具是否阻止访问受限系统目录（如 C:\\Windows）",
        "args": {
          "query": "C:\\Windows\\system32\\*.dll"
        },
        "response": {
          "result": "[{\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\07409496-a423-4a3e-b620-2cfb01a9318d_HyperV-ComputeNetwork.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\0ae3b998-9a38-4b72-a4c4-06849441518d_Servicing-Stack.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\4545ffe2-0dc4-4df4-9d02-299ef204635e_hvsocket.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\69fe178f-26e7-43a9-aa7d-2b616b672dde_eventlogservice.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\6bea57fb-8dfb-4177-9ae8-42e8b3529933_RuntimeDeviceInstall.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\aadauthhelper.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\aadcloudap.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\aadjcsp.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\aadtb.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\aadWamExtension.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\AarSvc.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\AboutSettingsHandlers.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\AboveLockAppHost.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\accessibilitycpl.dll\", \"size\": 0}, {\"filename\": \"\", \"full_path\": \"C:\\\\Windows\\\\System32\\\\accountaccessor.dll\", \"size\": 0}, {\"filename\": \"\",...[截断]，输出已被MCP适配器截断，这是适配器的限制而非工具本身的问题。共计9728字符，剩余8228字符"
        },
        "execution_time": 0.15672063827514648,
        "is_functional_test": false
      },
      {
        "case_name": "Security Test - Path Traversal Attempt",
        "purpose": "验证是否阻止路径穿越攻击尝试（如 ../ 或 ..\\）",
        "args": {
          "query": "..\\testFiles\\"
        },
        "response": {
          "result": "[]"
        },
        "execution_time": 0.3781442642211914,
        "is_functional_test": false
      }
    ]
  },
  "total_cases": 15
}