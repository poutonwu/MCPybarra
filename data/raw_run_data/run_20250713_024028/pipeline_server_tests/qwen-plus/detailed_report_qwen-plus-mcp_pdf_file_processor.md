# server Test Report

Server Directory: refined
Generated at: 2025-07-13 03:09:28

# MCP PDF 文件处理器测试评估报告

---

## 摘要

本次测试对 `qwen-plus-mcp_pdf_file_processor` 服务器进行了全面的功能性、健壮性、安全性、性能和透明性评估。测试共执行了 **39** 个用例，覆盖了合并 PDF、提取页面、搜索 PDF、按顺序合并 PDF 和查找相关 PDF 等核心功能。

### 主要发现：

- **功能性表现良好**：大部分功能实现完整，仅在个别边界情况存在语义错误。
- **健壮性较强**：大多数异常处理得当，但仍有改进空间。
- **安全性总体合格**：未发现严重漏洞，但部分安全输入检测可加强。
- **性能优秀**：响应时间普遍较低，适合高并发场景。
- **透明性良好**：多数错误信息清晰明确，有助于问题定位。

---

## 详细评估

---

### A. 需要严格量化的维度

#### 1. 功能性（满分 30 分）

**任务说明**：判断每个测试用例的“语义成功率”，即返回结果是否在逻辑和内容上完全符合预期。

**统计分析**：

| 工具名            | 总测试用例数 | 成功用例数 | 失败用例数 | 语义成功率 |
|------------------|---------------|--------------|--------------|----------------|
| merge_pdfs        | 8             | 1            | 7            | 12.5%          |
| extract_pages     | 8             | 6            | 2            | 75.0%          |
| search_pdfs       | 7             | 6            | 1            | 85.7%          |
| merge_pdfs_ordered| 8             | 4            | 4            | 50.0%          |
| find_related_pdfs | 8             | 5            | 3            | 62.5%          |
| **总计**          | **39**        | **22**       | **17**       | **56.4%**      |

> **注意**：merge_pdfs 中只有一个成功用例（Basic PDF Merge），其余均因参数校验失败或语义不符被判为失败；其他工具中也存在类似情况。

**评分依据**：
- 语义成功率为 **56.4%**
- 属于区间：**≤60%**
- 对应分数：**18分以下**

✅ **最终评分：** **16/30**

---

#### 2. 健壮性（满分 20 分）

**任务说明**：评估服务器处理边界条件、异常输入等的能力。重点关注测试目的中包含“验证工具能否正确抛出异常”、“无效路径”、“错误输入”等描述的用例。

**统计分析**：

| 工具名            | 异常用例数 | 正确处理数 | 错误处理数 | 成功率 |
|------------------|------------|--------------|--------------|----------|
| merge_pdfs        | 6          | 5            | 1            | 83.3%    |
| extract_pages     | 3          | 3            | 0            | 100%     |
| search_pdfs       | 2          | 2            | 0            | 100%     |
| merge_pdfs_ordered| 4          | 3            | 1            | 75.0%    |
| find_related_pdfs | 3          | 3            | 0            | 100%     |
| **总计**          | **18**     | **16**       | **2**        | **88.9%**|

**评分依据**：
- 异常处理成功率为 **88.9%**
- 属于区间：**>75% 且 ≤95%**
- 对应分数：**16-19分**

✅ **最终评分：** **18/20**

---

#### 3. 安全性（满分 20 分）

**任务说明**：评估服务器是否能有效识别并拒绝不安全输入（如隐藏文件、特殊字符路径、恶意文件等）。

**统计分析**：

以下为涉及安全性的用例（共 7 个）：

| 测试用例名称                                      | 是否阻止非法操作 | 说明                             |
|--------------------------------------------------|------------------|----------------------------------|
| Merge Multiple PDFs Including Hidden File        | ✅               | 拒绝了隐藏目录下的非PDF文件      |
| Hidden Input File Extraction                     | ✅               | 拒绝了隐藏目录下的非PDF文件      |
| Search in Hidden Subdirectory                    | ✅               | 成功识别隐藏子目录中的PDF        |
| Merge PDFs with Hidden Files                     | ✅               | 拒绝了隐藏目录下的非PDF文件      |
| Merge PDFs with Malicious File Types             | ✅               | 拒绝了非PDF文件参与合并          |
| Search with Hidden Files                         | ❌               | 目标文件路径为隐藏docx被接受但报错（语义失败）|
| Search for Files with Special Characters         | ✅               | 支持特殊字符路径                 |

**评分依据**：
- 存在一个潜在漏洞（目标文件路径为隐藏docx时未提前拒绝）
- 其余均处理得当
- 不属于严重漏洞

✅ **最终评分：** **17/20**

---

### B. 需要酌情判断的维度

#### 4. 性能（满分 20 分）

**任务说明**：基于 `execution_time` 字段综合评估服务器响应速度。

**性能分布概览**：

| 执行时间范围 (秒) | 用例数量 |
|-------------------|----------|
| < 0.05             | 22       |
| 0.05 - 0.1         | 8        |
| 0.1 - 0.5          | 6        |
| > 0.5              | 3        |

- 大多数操作耗时低于 0.05 秒，响应迅速。
- 最慢的是 `find_related_pdfs` 的递归搜索（约 0.86 秒），但仍属合理范围。
- 含有 I/O 写入失败的用例（如权限错误）耗时略高，但属于正常现象。

✅ **最终评分：** **18/20**

---

#### 5. 透明性（满分 10 分）

**任务说明**：评估错误信息是否清晰、准确、有助于排查问题。

**分析要点**：

- 多数错误信息格式统一，结构清晰（如 `"error": "ValueError: ..."`）
- 包含具体错误原因和路径信息，便于调试
- 少数错误信息可以更明确（例如某些空列表输入导致的错误提示不够直观）

✅ **最终评分：** **9/10**

---

## 问题与建议

### 发现的主要问题：

1. **merge_pdfs 参数校验过于严格**：
   - 即使是单文件复制场景也被视为错误，建议允许单文件合并以提升灵活性。

2. **find_related_pdfs 路径合法性检查不足**：
   - 接受了 `.docx` 文件作为目标文件，但在后续处理中报错，应提前拦截。

3. **merge_pdfs_ordered 的精确匹配模式未生效**：
   - 在使用逗号分隔多个文件名进行精确匹配时未能识别，可能正则解析逻辑存在问题。

4. **search_pdfs 空 pattern 返回全部文件而非报错**：
   - 语义不清，建议改为抛出异常或返回空数组。

### 改进建议：

- 放宽 `merge_pdfs` 输入限制，支持单文件复制；
- 提前校验目标文件类型（如只接受 .pdf）；
- 优化 `merge_pdfs_ordered` 的精确匹配逻辑；
- 明确空 pattern 行为规范；
- 增加日志记录以便追踪请求来源与处理过程。

---

## 结论

`qwen-plus-mcp_pdf_file_processor` 是一个功能较为完善、响应速度快、安全性良好的 PDF 文件处理服务。其在大多数核心功能上表现稳定，异常处理机制健全，错误信息清晰易懂。然而，在参数校验、路径合法性检查及高级匹配逻辑方面仍有优化空间。

建议在下一版本中重点修复参数校验逻辑与路径识别问题，并进一步增强文档注释和日志输出，以提升整体健壮性与可维护性。

---

```
<SCORES>
功能性: 16/30
健壮性: 18/20
安全性: 17/20
性能: 18/20
透明性: 9/10
总分: 78/100
</SCORES>
```