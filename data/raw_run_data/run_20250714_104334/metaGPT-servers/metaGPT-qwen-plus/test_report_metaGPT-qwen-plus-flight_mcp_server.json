{
  "server_name": "flight_mcp_server",
  "parent_dir": "metaGPT-qwen-plus",
  "report_name": "metaGPT-qwen-plus-flight_mcp_server",
  "server_path": "workspace\\metaGPT-servers\\metaGPT-qwen-plus\\flight_mcp_server.py",
  "timestamp": "2025-07-14T10:43:37.699581",
  "tools": [
    {
      "name": "search_flights",
      "description": "\n    根据参数查询航班信息，支持单程、往返航班查询。\n\n    Args:\n        origin: 出发地机场代码（例如 'PEK' 表示北京首都国际机场）。\n        destination: 目的地机场代码（例如 'SHA' 表示上海虹桥国际机场）。\n        departure_date: 出发日期，格式为 'YYYY-MM-DD'。\n        return_date: 返回日期，格式为 'YYYY-MM-DD'，仅在往返查询时提供。\n        cabin_class: 舱位等级（可选值：economy, premium_economy, business, first），默认为 economy。\n        adults: 成人旅客数量，默认为 1。\n        children: 儿童旅客数量，默认为 0。\n        infants: 婴儿旅客数量，默认为 0。\n\n    Returns:\n        包含航班详细信息的JSON字符串，包括：\n        - 航班号\n        - 出发时间\n        - 到达时间\n        - 航空公司\n        - 价格详情（经济舱、商务舱等）\n        - 总飞行时间\n        - 中转信息（如有）\n\n    Raises:\n        ValueError: 如果输入参数不符合要求（如日期格式错误、无效的机场代码等）。\n        httpx.HTTPStatusError: 如果API请求失败。\n\n    示例:\n        单程查询:\n        search_flights(origin=\"PEK\", destination=\"SHA\", departure_date=\"2023-12-25\")\n        \n        往返查询:\n        search_flights(\n            origin=\"PEK\", \n            destination=\"SHA\", \n            departure_date=\"2023-12-25\", \n            return_date=\"2023-12-30\"\n        )\n    ",
      "args_schema": {
        "properties": {
          "origin": {
            "title": "Origin",
            "type": "string"
          },
          "destination": {
            "title": "Destination",
            "type": "string"
          },
          "departure_date": {
            "title": "Departure Date",
            "type": "string"
          },
          "return_date": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Return Date"
          },
          "cabin_class": {
            "default": "economy",
            "title": "Cabin Class",
            "type": "string"
          },
          "adults": {
            "default": 1,
            "title": "Adults",
            "type": "integer"
          },
          "children": {
            "default": 0,
            "title": "Children",
            "type": "integer"
          },
          "infants": {
            "default": 0,
            "title": "Infants",
            "type": "integer"
          }
        },
        "required": [
          "origin",
          "destination",
          "departure_date"
        ],
        "title": "search_flightsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_offer_details",
      "description": "\n    获取特定航班报价的详细信息。\n\n    Args:\n        offer_id: 航班报价唯一标识符（由 search_flights 或 search_multi_city 返回）。\n\n    Returns:\n        包含完整报价详情的JSON字符串，包括：\n        - 完整的行程信息\n        - 所有乘客类型的票价详情\n        - 税费明细\n        - 退改签政策\n        - 行李额度\n        - 座位选择选项\n        - 餐食选项\n\n    Raises:\n        ValueError: 如果 offer_id 格式无效。\n        httpx.HTTPStatusError: 如果API请求失败。\n\n    示例:\n        get_offer_details(offer_id=\"OFFER-20231225-PEK-SHA-CZ3104-ECONOMY\")\n    ",
      "args_schema": {
        "properties": {
          "offer_id": {
            "title": "Offer Id",
            "type": "string"
          }
        },
        "required": [
          "offer_id"
        ],
        "title": "get_offer_detailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_multi_city",
      "description": "\n    处理多城市航班查询，支持复杂的行程规划。\n\n    Args:\n        route_segments: 行程段列表，每个字典包含以下字段：\n            - origin: 出发地机场代码（例如 'PEK'）\n            - destination: 目的地机场代码（例如 'SHA'）\n            - departure_date: 出发日期，格式为 'YYYY-MM-DD'\n        cabin_class: 舱位等级（可选值：economy, premium_economy, business, first），默认为 economy。\n        adults: 成人旅客数量，默认为 1。\n        children: 儿童旅客数量，默认为 0。\n        infants: 婴儿旅客数量，默认为 0。\n\n    Returns:\n        包含多城市航班详细信息的JSON字符串，包括：\n        - 整个行程的航班组合\n        - 每个航段的详细信息\n        - 总价格及各航段价格分配\n        - 转机等待时间\n        - 航空公司联盟信息\n        - 共享航班信息\n\n    Raises:\n        ValueError: 如果输入参数不符合要求（如日期格式错误、无效的机场代码等）。\n        httpx.HTTPStatusError: 如果API请求失败。\n\n    示例:\n        search_multi_city(\n            route_segments=[\n                {\"origin\": \"PEK\", \"destination\": \"SHA\", \"departure_date\": \"2023-12-25\"},\n                {\"origin\": \"SHA\", \"destination\": \"CAN\", \"departure_date\": \"2023-12-28\"},\n                {\"origin\": \"CAN\", \"destination\": \"PEK\", \"departure_date\": \"2023-12-30\"}\n            ]\n        )\n    ",
      "args_schema": {
        "properties": {
          "route_segments": {
            "items": {
              "additionalProperties": {
                "anyOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "integer"
                  }
                ]
              },
              "type": "object"
            },
            "title": "Route Segments",
            "type": "array"
          },
          "cabin_class": {
            "default": "economy",
            "title": "Cabin Class",
            "type": "string"
          },
          "adults": {
            "default": 1,
            "title": "Adults",
            "type": "integer"
          },
          "children": {
            "default": 0,
            "title": "Children",
            "type": "integer"
          },
          "infants": {
            "default": 0,
            "title": "Infants",
            "type": "integer"
          }
        },
        "required": [
          "route_segments"
        ],
        "title": "search_multi_cityArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "search_flights": [
      {
        "case_name": "Basic One-way Flight Search",
        "purpose": "验证使用默认参数进行单程航班查询的基本功能是否正常",
        "args": {
          "origin": "PEK",
          "destination": "SHA",
          "departure_date": "2023-12-25"
        },
        "response": {
          "error": "ToolException: Error executing tool search_flights: "
        },
        "execution_time": 2.9432599544525146,
        "is_functional_test": true
      },
      {
        "case_name": "Round-trip Flight Search with Return Date",
        "purpose": "验证包含返回日期的往返航班查询功能",
        "args": {
          "origin": "PEK",
          "destination": "SHA",
          "departure_date": "2023-12-25",
          "return_date": "2023-12-30"
        },
        "response": {
          "error": "ToolException: Error executing tool search_flights: "
        },
        "execution_time": 2.014584541320801,
        "is_functional_test": true
      },
      {
        "case_name": "Flight Search with Business Class",
        "purpose": "验证指定商务舱位等级的航班查询功能",
        "args": {
          "origin": "PEK",
          "destination": "SHA",
          "departure_date": "2023-12-25",
          "cabin_class": "business"
        },
        "response": {
          "error": "ToolException: Error executing tool search_flights: "
        },
        "execution_time": 2.1126608848571777,
        "is_functional_test": true
      },
      {
        "case_name": "Flight Search with Multiple Passengers",
        "purpose": "验证包含成人、儿童和婴儿旅客数量的航班查询功能",
        "args": {
          "origin": "PEK",
          "destination": "SHA",
          "departure_date": "2023-12-25",
          "adults": 2,
          "children": 1,
          "infants": 1
        },
        "response": {
          "error": "ToolException: Error executing tool search_flights: "
        },
        "execution_time": 2.07586669921875,
        "is_functional_test": true
      },
      {
        "case_name": "Flight Search with Invalid Origin Airport Code",
        "purpose": "验证无效出发地机场代码的错误处理机制",
        "args": {
          "origin": "XXX",
          "destination": "SHA",
          "departure_date": "2023-12-25"
        },
        "response": {
          "error": "ToolException: Error executing tool search_flights: "
        },
        "execution_time": 2.050753355026245,
        "is_functional_test": false
      },
      {
        "case_name": "Flight Search with Past Departure Date",
        "purpose": "验证过去日期作为出发日期时的错误处理",
        "args": {
          "origin": "PEK",
          "destination": "SHA",
          "departure_date": "2020-01-01"
        },
        "response": {
          "error": "ToolException: Error executing tool search_flights: "
        },
        "execution_time": 2.1361610889434814,
        "is_functional_test": false
      },
      {
        "case_name": "Flight Search with Special Characters in Parameters",
        "purpose": "测试特殊字符在参数中的处理，确保无安全漏洞",
        "args": {
          "origin": "PEK",
          "destination": "SHA",
          "departure_date": "2023-12-25",
          "cabin_class": "<script>alert('xss')</script>"
        },
        "response": {
          "error": "ToolException: Error executing tool search_flights: 无效的舱位等级: '<script>alert('xss')</script>'。有效值: economy, premium_economy, business, first"
        },
        "execution_time": 0.009661674499511719,
        "is_functional_test": false
      },
      {
        "case_name": "Flight Search with Maximum Passenger Count",
        "purpose": "验证最大乘客数量限制下的边界条件处理",
        "args": {
          "origin": "PEK",
          "destination": "SHA",
          "departure_date": "2023-12-25",
          "adults": 9,
          "children": 9,
          "infants": 9
        },
        "response": {
          "error": "ToolException: Error executing tool search_flights: "
        },
        "execution_time": 2.0032448768615723,
        "is_functional_test": false
      }
    ],
    "get_offer_details": [
      {
        "case_name": "Basic Offer Details Retrieval",
        "purpose": "验证使用有效的 offer_id 能够成功获取航班报价的完整详细信息",
        "args": {
          "offer_id": "OFFER-20231225-PEK-SHA-CZ3104-ECONOMY"
        },
        "response": {
          "error": "ToolException: Error executing tool get_offer_details: "
        },
        "execution_time": 2.0030508041381836,
        "is_functional_test": true
      },
      {
        "case_name": "Offer Details with Invalid Format ID",
        "purpose": "验证格式不正确的 offer_id 是否抛出 ValueError 异常",
        "args": {
          "offer_id": "INVALID-OFFER-ID-FORMAT"
        },
        "response": {
          "error": "ToolException: Error executing tool get_offer_details: 无效的报价ID: 'INVALID-OFFER-ID-FORMAT'。必须符合指定格式。"
        },
        "execution_time": 0.0062983036041259766,
        "is_functional_test": false
      },
      {
        "case_name": "Offer Details for Nonexistent Offer",
        "purpose": "验证不存在的 offer_id 是否导致 API 返回错误状态码并正确处理",
        "args": {
          "offer_id": "OFFER-NOT-EXIST-20231225"
        },
        "response": {
          "error": "ToolException: Error executing tool get_offer_details: 无效的报价ID: 'OFFER-NOT-EXIST-20231225'。必须符合指定格式。"
        },
        "execution_time": 0.005002498626708984,
        "is_functional_test": false
      },
      {
        "case_name": "Offer Details with SQL Injection Attempt",
        "purpose": "测试是否安全地处理包含潜在SQL注入字符的 offer_id",
        "args": {
          "offer_id": "OFFER-20231225-PEK-SHA-CZ3104-ECONOMY'; DROP TABLE offers;--"
        },
        "response": {
          "error": "ToolException: Error executing tool get_offer_details: 无效的报价ID: 'OFFER-20231225-PEK-SHA-CZ3104-ECONOMY'; DROP TABLE offers;--'。必须符合指定格式。"
        },
        "execution_time": 0.007766246795654297,
        "is_functional_test": false
      },
      {
        "case_name": "Offer Details with XSS Attempt in ID",
        "purpose": "测试是否安全地处理包含潜在XSS攻击字符的 offer_id",
        "args": {
          "offer_id": "OFFER-20231225-PEK-SHA-CZ3104-<script>alert('xss')</script>"
        },
        "response": {
          "error": "ToolException: Error executing tool get_offer_details: 无效的报价ID: 'OFFER-20231225-PEK-SHA-CZ3104-<script>alert('xss')</script>'。必须符合指定格式。"
        },
        "execution_time": 0.00351715087890625,
        "is_functional_test": false
      },
      {
        "case_name": "Offer Details with Empty ID",
        "purpose": "验证空字符串作为 offer_id 时的参数校验机制",
        "args": {
          "offer_id": ""
        },
        "response": {
          "error": "ToolException: Error executing tool get_offer_details: 无效的报价ID: ''。必须符合指定格式。"
        },
        "execution_time": 0.010535001754760742,
        "is_functional_test": false
      },
      {
        "case_name": "Offer Details with Leading and Trailing Whitespace",
        "purpose": "验证带前后空格的 offer_id 是否被正确处理或拒绝",
        "args": {
          "offer_id": " OFFER-20231225-PEK-SHA-CZ3104-ECONOMY "
        },
        "response": {
          "error": "ToolException: Error executing tool get_offer_details: 无效的报价ID: ' OFFER-20231225-PEK-SHA-CZ3104-ECONOMY '。必须符合指定格式。"
        },
        "execution_time": 0.004997968673706055,
        "is_functional_test": false
      }
    ],
    "search_multi_city": [
      {
        "case_name": "Basic Multi-city Flight Search",
        "purpose": "验证使用默认参数进行多城市航班查询的基本功能是否正常",
        "args": {
          "route_segments": [
            {
              "origin": "PEK",
              "destination": "SHA",
              "departure_date": "2023-12-25"
            },
            {
              "origin": "SHA",
              "destination": "CAN",
              "departure_date": "2023-12-28"
            },
            {
              "origin": "CAN",
              "destination": "PEK",
              "departure_date": "2023-12-30"
            }
          ]
        },
        "response": {
          "error": "ToolException: Error executing tool search_multi_city: "
        },
        "execution_time": 1.9833476543426514,
        "is_functional_test": true
      },
      {
        "case_name": "Multi-city Flight Search with Business Class",
        "purpose": "验证指定商务舱位等级的多城市航班查询功能",
        "args": {
          "route_segments": [
            {
              "origin": "PEK",
              "destination": "SHA",
              "departure_date": "2023-12-25"
            },
            {
              "origin": "SHA",
              "destination": "CAN",
              "departure_date": "2023-12-28"
            }
          ],
          "cabin_class": "business"
        },
        "response": {
          "error": "ToolException: Error executing tool search_multi_city: "
        },
        "execution_time": 2.008708953857422,
        "is_functional_test": true
      },
      {
        "case_name": "Multi-city Flight Search with Multiple Passengers",
        "purpose": "验证包含成人、儿童和婴儿旅客数量的多城市航班查询功能",
        "args": {
          "route_segments": [
            {
              "origin": "PEK",
              "destination": "SHA",
              "departure_date": "2023-12-25"
            },
            {
              "origin": "SHA",
              "destination": "CAN",
              "departure_date": "2023-12-28"
            }
          ],
          "adults": 2,
          "children": 1,
          "infants": 1
        },
        "response": {
          "error": "ToolException: Error executing tool search_multi_city: "
        },
        "execution_time": 2.0013906955718994,
        "is_functional_test": true
      },
      {
        "case_name": "Multi-city Flight Search with Invalid Origin Airport Code",
        "purpose": "验证无效出发地机场代码的错误处理机制",
        "args": {
          "route_segments": [
            {
              "origin": "XXX",
              "destination": "SHA",
              "departure_date": "2023-12-25"
            },
            {
              "origin": "SHA",
              "destination": "CAN",
              "departure_date": "2023-12-28"
            }
          ]
        },
        "response": {
          "error": "ToolException: Error executing tool search_multi_city: "
        },
        "execution_time": 1.9888522624969482,
        "is_functional_test": false
      },
      {
        "case_name": "Multi-city Flight Search with Past Departure Date",
        "purpose": "验证过去日期作为出发日期时的错误处理",
        "args": {
          "route_segments": [
            {
              "origin": "PEK",
              "destination": "SHA",
              "departure_date": "2020-01-01"
            },
            {
              "origin": "SHA",
              "destination": "CAN",
              "departure_date": "2023-12-28"
            }
          ]
        },
        "response": {
          "error": "ToolException: Error executing tool search_multi_city: "
        },
        "execution_time": 2.0438356399536133,
        "is_functional_test": false
      },
      {
        "case_name": "Multi-city Flight Search with XSS Attempt in Cabin Class",
        "purpose": "测试特殊字符在舱位等级中的处理，确保无XSS安全漏洞",
        "args": {
          "route_segments": [
            {
              "origin": "PEK",
              "destination": "SHA",
              "departure_date": "2023-12-25"
            },
            {
              "origin": "SHA",
              "destination": "CAN",
              "departure_date": "2023-12-28"
            }
          ],
          "cabin_class": "<script>alert('xss')</script>"
        },
        "response": {
          "error": "ToolException: Error executing tool search_multi_city: 无效的舱位等级: '<script>alert('xss')</script>'。有效值: economy, premium_economy, business, first"
        },
        "execution_time": 0.004001140594482422,
        "is_functional_test": false
      },
      {
        "case_name": "Multi-city Flight Search with Maximum Passenger Count",
        "purpose": "验证最大乘客数量限制下的边界条件处理",
        "args": {
          "route_segments": [
            {
              "origin": "PEK",
              "destination": "SHA",
              "departure_date": "2023-12-25"
            },
            {
              "origin": "SHA",
              "destination": "CAN",
              "departure_date": "2023-12-28"
            }
          ],
          "adults": 9,
          "children": 9,
          "infants": 9
        },
        "response": {
          "error": "ToolException: Error executing tool search_multi_city: "
        },
        "execution_time": 1.9729242324829102,
        "is_functional_test": false
      },
      {
        "case_name": "Multi-city Flight Search with Empty Route Segments",
        "purpose": "验证空行程段列表的参数校验机制",
        "args": {
          "route_segments": []
        },
        "response": {
          "error": "ToolException: Error executing tool search_multi_city: 多城市查询至少需要两个行程段。"
        },
        "execution_time": 0.0035126209259033203,
        "is_functional_test": false
      }
    ]
  },
  "total_cases": 23
}