{
  "server_name": "outlook_mcp_server",
  "parent_dir": "metaGPT-qwen-plus",
  "report_name": "metaGPT-qwen-plus-outlook_mcp_server",
  "server_path": "workspace\\metaGPT-servers\\metaGPT-qwen-plus\\outlook_mcp_server.py",
  "timestamp": "2025-07-14T10:45:20.642198",
  "tools": [
    {
      "name": "list_folders",
      "description": "\n    列出所有可用的Outlook邮件文件夹。\n\n    Returns:\n        包含文件夹名称和路径的字典列表。\n    ",
      "args_schema": {
        "properties": {},
        "title": "list_foldersArguments",
        "type": "object"
      }
    },
    {
      "name": "list_recent_emails",
      "description": "\n    获取指定天数内最近的邮件标题列表。\n\n    Args:\n        days: 需要检索的过去天数，默认为7天。\n        folder_name: 指定的邮件文件夹名称，如果为空则使用默认收件箱。\n\n    Returns:\n        包含邮件主题、发件人和接收时间的字典列表。\n    ",
      "args_schema": {
        "properties": {
          "days": {
            "default": 7,
            "title": "Days",
            "type": "integer"
          },
          "folder_name": {
            "default": null,
            "title": "Folder Name",
            "type": "string"
          }
        },
        "title": "list_recent_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "search_emails",
      "description": "\n    在指定时间段和文件夹内按联系人或关键词搜索邮件。\n\n    Args:\n        query: 搜索查询字符串，可以是联系人或关键词。\n        folder_name: 指定的邮件文件夹名称，如果为空则使用默认收件箱。\n        start_date: 搜索的起始日期（格式：YYYY-MM-DD HH:MM）。\n        end_date: 搜索的结束日期（格式：YYYY-MM-DD HH:MM）。\n\n    Returns:\n        包含匹配邮件主题、发件人和接收时间的字典列表。\n    ",
      "args_schema": {
        "properties": {
          "query": {
            "title": "Query",
            "type": "string"
          },
          "folder_name": {
            "default": null,
            "title": "Folder Name",
            "type": "string"
          },
          "start_date": {
            "default": null,
            "title": "Start Date",
            "type": "string"
          },
          "end_date": {
            "default": null,
            "title": "End Date",
            "type": "string"
          }
        },
        "required": [
          "query"
        ],
        "title": "search_emailsArguments",
        "type": "object"
      }
    },
    {
      "name": "get_email_by_number",
      "description": "\n    获取指定编号的邮件详细信息。\n\n    Args:\n        email_id: 邮件的唯一标识符。\n\n    Returns:\n        包含邮件正文和附件信息的字典。\n    ",
      "args_schema": {
        "properties": {
          "email_id": {
            "title": "Email Id",
            "type": "integer"
          }
        },
        "required": [
          "email_id"
        ],
        "title": "get_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "reply_to_email_by_number",
      "description": "\n    对指定编号的邮件进行回复。\n\n    Args:\n        email_id: 邮件的唯一标识符。\n        reply_text: 回复邮件的内容。\n\n    Returns:\n        包含回复结果的状态消息。\n    ",
      "args_schema": {
        "properties": {
          "email_id": {
            "title": "Email Id",
            "type": "integer"
          },
          "reply_text": {
            "title": "Reply Text",
            "type": "string"
          }
        },
        "required": [
          "email_id",
          "reply_text"
        ],
        "title": "reply_to_email_by_numberArguments",
        "type": "object"
      }
    },
    {
      "name": "compose_email",
      "description": "\n    新建并发送一封新邮件。\n\n    Args:\n        subject: 邮件的主题。\n        body: 邮件正文内容。\n        to: 收件人邮箱地址。\n        cc: 抄送邮箱地址（可选）。\n\n    Returns:\n        包含发送结果的状态消息。\n    ",
      "args_schema": {
        "properties": {
          "subject": {
            "title": "Subject",
            "type": "string"
          },
          "body": {
            "title": "Body",
            "type": "string"
          },
          "to": {
            "title": "To",
            "type": "string"
          },
          "cc": {
            "default": null,
            "title": "Cc",
            "type": "string"
          }
        },
        "required": [
          "subject",
          "body",
          "to"
        ],
        "title": "compose_emailArguments",
        "type": "object"
      }
    }
  ],
  "test_results": {
    "list_folders": [
      {
        "case_name": "列出所有Outlook邮件文件夹的基本功能测试",
        "purpose": "验证list_folders工具在无参数情况下能成功列出所有可用的Outlook邮件文件夹。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.012034893035888672,
        "is_functional_test": true
      },
      {
        "case_name": "测试Outlook账户无可用文件夹情况",
        "purpose": "验证当Outlook账户中没有可用文件夹时，工具是否能正确返回空列表或合理响应。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.0128936767578125,
        "is_functional_test": false
      },
      {
        "case_name": "验证工具在Outlook未连接状态下的错误处理",
        "purpose": "模拟Outlook未连接或账户未配置的情况，确保工具能优雅地处理错误并返回明确信息。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.013268470764160156,
        "is_functional_test": false
      },
      {
        "case_name": "测试工具对特殊字符文件夹名的兼容性",
        "purpose": "验证工具是否能正确处理包含特殊字符（如中文、符号）的Outlook文件夹名称。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.013506412506103516,
        "is_functional_test": true
      },
      {
        "case_name": "权限不足时无法访问Outlook文件夹的安全测试",
        "purpose": "在受限用户权限下运行工具，确认其不会因权限问题导致系统异常或敏感信息泄露。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.01352238655090332,
        "is_functional_test": false
      },
      {
        "case_name": "验证工具在大规模文件夹结构下的性能表现",
        "purpose": "测试当Outlook中存在大量嵌套文件夹时，工具是否仍能稳定执行并正确返回结果。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.010506391525268555,
        "is_functional_test": true
      },
      {
        "case_name": "测试工具在非Windows环境下调用Outlook API的安全行为",
        "purpose": "验证工具在非支持平台（如Linux或macOS）上运行时是否会安全退出，不产生不可预测行为。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.012791872024536133,
        "is_functional_test": false
      },
      {
        "case_name": "验证工具在Outlook客户端关闭状态下是否自动启动并列出文件夹",
        "purpose": "确保工具具备自动连接Outlook服务的能力，并在客户端未启动时不影响核心功能执行。",
        "args": {},
        "response": {
          "result": "{\n  \"folders\": [\n    {\n      \"name\": \"1291980381@qq.com\",\n      \"path\": \"\\\\\\\\1291980381@qq.com\"\n    },\n    {\n      \"name\": \"zhihutangjiang@126.com\",\n      \"path\": \"\\\\\\\\zhihutangjiang@126.com\"\n    },\n    {\n      \"name\": \"outformcptest@outlook.com\",\n      \"path\": \"\\\\\\\\outformcptest@outlook.com\"\n    }\n  ]\n}"
        },
        "execution_time": 0.015285253524780273,
        "is_functional_test": true
      }
    ],
    "list_recent_emails": [
      {
        "case_name": "获取默认收件箱中最近7天的邮件标题",
        "purpose": "验证list_recent_emails工具在使用默认参数时能成功从默认收件箱中获取过去7天内的邮件标题列表。",
        "args": {
          "days": 7
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.027946949005126953,
        "is_functional_test": true
      },
      {
        "case_name": "指定文件夹获取最近5天的邮件标题",
        "purpose": "验证工具在指定文件夹和自定义天数（5天）下是否能正确检索邮件标题。",
        "args": {
          "days": 5,
          "folder_name": "zhihutangjiang@126.com"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.026126623153686523,
        "is_functional_test": true
      },
      {
        "case_name": "测试工具对特殊字符文件夹名的兼容性",
        "purpose": "验证工具是否能正确处理包含特殊字符的Outlook文件夹名称，如中文或符号。",
        "args": {
          "days": 3,
          "folder_name": "测试文件夹@特殊字符"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.04118824005126953,
        "is_functional_test": false
      },
      {
        "case_name": "输入无效天数时的错误处理",
        "purpose": "验证当用户提供负数或非整数值作为days参数时，工具是否能优雅地处理错误并返回合理提示。",
        "args": {
          "days": -3
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.03158259391784668,
        "is_functional_test": false
      },
      {
        "case_name": "访问不存在的邮件文件夹时的行为",
        "purpose": "验证当提供的folder_name不存在时，工具是否能正确处理并返回空列表或错误信息。",
        "args": {
          "days": 10,
          "folder_name": "nonexistent_folder"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.06239032745361328,
        "is_functional_test": false
      },
      {
        "case_name": "设置最大允许天数获取邮件标题",
        "purpose": "测试工具在边界值（例如9999天）下的行为，确保其不会因时间跨度太大而崩溃或超时。",
        "args": {
          "days": 9999
        },
        "response": {
          "result": "{\n  \"emails\": [\n    {\n      \"id\": 35,\n      \"subject\": \"Please sign in to your Outlook.com account\",\n      \"sender\": \"Outlook.com Team\",\n      \"received_time\": \"2025-06-30 17:04\"\n    }\n  ]\n}"
        },
        "execution_time": 7.156888008117676,
        "is_functional_test": true
      },
      {
        "case_name": "权限不足时无法访问指定邮件文件夹的安全测试",
        "purpose": "在受限用户权限下运行工具，确认其不会因权限问题导致系统异常或敏感信息泄露。",
        "args": {
          "days": 2,
          "folder_name": "outformcptest@outlook.com"
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.04205179214477539,
        "is_functional_test": false
      },
      {
        "case_name": "获取默认收件箱中仅一天的邮件标题",
        "purpose": "验证工具在最小有效天数（1天）下是否能正确获取邮件标题列表。",
        "args": {
          "days": 1
        },
        "response": {
          "result": "{\n  \"emails\": []\n}"
        },
        "execution_time": 0.0215914249420166,
        "is_functional_test": true
      }
    ],
    "search_emails": [
      {
        "case_name": "基本功能测试 - 按关键词搜索默认收件箱邮件",
        "purpose": "验证search_emails工具在使用默认参数（默认收件箱）时能正确按关键词搜索邮件。",
        "args": {
          "query": "test"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.008059978485107422,
        "is_functional_test": true
      },
      {
        "case_name": "基本功能测试 - 按联系人搜索指定文件夹邮件",
        "purpose": "验证工具能正确在指定文件夹中按联系人搜索邮件。",
        "args": {
          "query": "john.doe@example.com",
          "folder_name": "zhihutangjiang@126.com"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.017182588577270508,
        "is_functional_test": true
      },
      {
        "case_name": "基本功能测试 - 按关键词和时间段搜索邮件",
        "purpose": "验证工具能正确在默认收件箱中按关键词和时间范围搜索邮件。",
        "args": {
          "query": "urgent",
          "start_date": "2025-04-01 08:00",
          "end_date": "2025-04-30 18:00"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.009005308151245117,
        "is_functional_test": true
      },
      {
        "case_name": "基本功能测试 - 按联系人和时间段搜索指定文件夹邮件",
        "purpose": "验证工具能在指定文件夹中按联系人和时间范围进行搜索。",
        "args": {
          "query": "support@company.com",
          "folder_name": "outformcptest@outlook.com",
          "start_date": "2025-03-10 09:00",
          "end_date": "2025-03-20 17:00"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.016141176223754883,
        "is_functional_test": true
      },
      {
        "case_name": "安全性测试 - 在无权限情况下访问受保护的邮件文件夹",
        "purpose": "验证工具在用户没有访问权限的情况下是否不会泄露敏感信息或导致系统异常。",
        "args": {
          "query": "confidential",
          "folder_name": "restricted_folder"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.015031814575195312,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 使用无效的日期格式进行搜索",
        "purpose": "验证工具在输入非法日期格式时是否能优雅地处理错误并返回合理提示。",
        "args": {
          "query": "report",
          "start_date": "2025/01/01 08:00",
          "end_date": "2025-13-01 09:00"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.013806581497192383,
        "is_functional_test": false
      },
      {
        "case_name": "错误处理测试 - 搜索不存在的文件夹",
        "purpose": "验证当提供的folder_name不存在时，工具是否能正确处理并返回空列表或错误信息。",
        "args": {
          "query": "meeting",
          "folder_name": "nonexistent_folder"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.016117572784423828,
        "is_functional_test": false
      },
      {
        "case_name": "边界条件测试 - 使用最小时间范围进行搜索",
        "purpose": "验证工具在最小有效时间范围内（如1分钟）是否能正确执行搜索。",
        "args": {
          "query": "reminder",
          "start_date": "2025-05-01 12:00",
          "end_date": "2025-05-01 12:01"
        },
        "response": {
          "error": "ToolException: Error executing tool search_emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '条件无效。', None, 0, -2147352567), None)"
        },
        "execution_time": 0.011048555374145508,
        "is_functional_test": true
      }
    ],
    "get_email_by_number": [
      {
        "case_name": "获取已知邮件编号的详细信息",
        "purpose": "验证get_email_by_number工具在提供有效邮件ID时能成功返回该邮件的正文和附件信息。",
        "args": {
          "email_id": 35
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.006513833999633789,
        "is_functional_test": true
      },
      {
        "case_name": "尝试获取不存在的邮件ID信息",
        "purpose": "验证当提供的邮件ID不存在时，工具是否能优雅地处理错误并返回空结果或合理提示。",
        "args": {
          "email_id": 99999
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 99999"
        },
        "execution_time": 0.010058879852294922,
        "is_functional_test": false
      },
      {
        "case_name": "使用负数邮件ID进行参数边界测试",
        "purpose": "验证工具是否能正确处理非法邮件ID（如负数）并返回明确错误信息。",
        "args": {
          "email_id": -1
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: -1"
        },
        "execution_time": 0.010050773620605469,
        "is_functional_test": false
      },
      {
        "case_name": "使用零作为邮件ID进行边界值测试",
        "purpose": "测试工具对最小合法邮件ID（0）的处理行为，确保不会因无效ID导致崩溃或异常。",
        "args": {
          "email_id": 0
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 0"
        },
        "execution_time": 0.010542631149291992,
        "is_functional_test": false
      },
      {
        "case_name": "权限不足时访问邮件内容的安全性测试",
        "purpose": "在受限用户权限下运行工具，确认其不会因权限问题导致系统异常或敏感信息泄露。",
        "args": {
          "email_id": 35
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.011162519454956055,
        "is_functional_test": false
      },
      {
        "case_name": "验证工具在Outlook未连接状态下的错误处理",
        "purpose": "模拟Outlook未连接或账户未配置的情况，确保工具能优雅地处理错误并返回明确信息。",
        "args": {
          "email_id": 35
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.013564825057983398,
        "is_functional_test": false
      },
      {
        "case_name": "获取最大允许邮件ID的信息以测试边界条件",
        "purpose": "测试工具在最大可能邮件ID（例如9999999）下的行为，确保其不会因超大ID而崩溃或超时。",
        "args": {
          "email_id": 9999999
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 9999999"
        },
        "execution_time": 0.014074563980102539,
        "is_functional_test": false
      },
      {
        "case_name": "验证工具在非Windows环境下调用Outlook API的安全行为",
        "purpose": "验证工具在非支持平台（如Linux或macOS）上运行时是否会安全退出，不产生不可预测行为。",
        "args": {
          "email_id": 35
        },
        "response": {
          "error": "ToolException: Error executing tool get_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.014159679412841797,
        "is_functional_test": false
      }
    ],
    "reply_to_email_by_number": [
      {
        "case_name": "对有效邮件编号进行正常回复",
        "purpose": "验证reply_to_email_by_number工具在提供合法email_id和非空reply_text时能成功发送回复。",
        "args": {
          "email_id": 35,
          "reply_text": "感谢您的邮件，我会尽快处理。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.00801992416381836,
        "is_functional_test": true
      },
      {
        "case_name": "尝试回复不存在的邮件编号",
        "purpose": "验证当提供的email_id不存在时，工具是否能优雅地返回错误信息而非崩溃。",
        "args": {
          "email_id": 99999,
          "reply_text": "这封邮件不存在，无法回复。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 99999"
        },
        "execution_time": 0.012063264846801758,
        "is_functional_test": false
      },
      {
        "case_name": "使用空回复内容进行测试",
        "purpose": "验证当reply_text为空字符串时，工具是否能正确提示内容不能为空。",
        "args": {
          "email_id": 35,
          "reply_text": ""
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.01759171485900879,
        "is_functional_test": false
      },
      {
        "case_name": "使用特殊字符作为回复内容",
        "purpose": "验证工具是否支持包含特殊字符（如中文、符号）的回复文本。",
        "args": {
          "email_id": 35,
          "reply_text": "您好！这是一封测试邮件，包含特殊字符：@#￥%……&*（）——+。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.012038946151733398,
        "is_functional_test": true
      },
      {
        "case_name": "Outlook未连接状态下尝试回复邮件",
        "purpose": "模拟Outlook未启动或账户未配置的情况，确保工具能安全退出并返回明确错误信息。",
        "args": {
          "email_id": 35,
          "reply_text": "Outlook未连接，此为测试回复。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.019663572311401367,
        "is_functional_test": false
      },
      {
        "case_name": "权限不足时尝试回复邮件的安全测试",
        "purpose": "在受限用户权限下运行工具，确认其不会因权限问题导致系统异常或敏感操作。",
        "args": {
          "email_id": 35,
          "reply_text": "受限权限下的测试回复。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: 35"
        },
        "execution_time": 0.02060103416442871,
        "is_functional_test": false
      },
      {
        "case_name": "使用负数邮件ID进行非法输入测试",
        "purpose": "验证当用户提供负数作为email_id时，工具是否能正确拒绝请求并返回合理提示。",
        "args": {
          "email_id": -1,
          "reply_text": "这是负数邮件ID的非法测试回复。"
        },
        "response": {
          "error": "ToolException: Error executing tool reply_to_email_by_number: 无效的邮件ID: -1"
        },
        "execution_time": 0.012064933776855469,
        "is_functional_test": false
      }
    ],
    "compose_email": [
      {
        "case_name": "发送一封基本邮件",
        "purpose": "验证compose_email工具在提供所有必填参数的情况下能够成功发送邮件。",
        "args": {
          "subject": "测试邮件主题",
          "body": "这是测试邮件的正文内容。",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.013723373413085938,
        "is_functional_test": true
      },
      {
        "case_name": "发送带抄送的邮件",
        "purpose": "验证compose_email工具在提供to和cc参数时能够正确发送包含抄送的邮件。",
        "args": {
          "subject": "带抄送的测试邮件",
          "body": "这是一封包含抄送的测试邮件。",
          "to": "test@example.com",
          "cc": "cc@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.0049991607666015625,
        "is_functional_test": true
      },
      {
        "case_name": "发送空主题邮件",
        "purpose": "验证工具是否允许发送无主题邮件，或是否进行有效校验。",
        "args": {
          "subject": "",
          "body": "这是一封没有主题的邮件。",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.008955717086791992,
        "is_functional_test": false
      },
      {
        "case_name": "发送空正文邮件",
        "purpose": "验证工具是否允许发送无正文内容的邮件，或是否进行有效校验。",
        "args": {
          "subject": "空正文测试邮件",
          "body": "",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.011247873306274414,
        "is_functional_test": false
      },
      {
        "case_name": "发送至无效邮箱地址",
        "purpose": "验证工具在收件人邮箱格式不合法时能否优雅处理错误。",
        "args": {
          "subject": "无效邮箱测试邮件",
          "body": "这是一封发送给无效邮箱地址的测试邮件。",
          "to": "invalid-email"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.011037349700927734,
        "is_functional_test": false
      },
      {
        "case_name": "发送邮件时省略必填字段",
        "purpose": "验证工具在缺少必填参数（如subject）时是否能返回明确错误信息。",
        "args": {
          "body": "缺少主题字段的邮件。",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: 1 validation error for compose_emailArguments\nsubject\n  Field required [type=missing, input_value={'body': '缺少主题字...to': 'test@example.com'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing"
        },
        "execution_time": 0.005995035171508789,
        "is_functional_test": false
      },
      {
        "case_name": "发送含特殊字符的主题和正文邮件",
        "purpose": "验证工具是否支持包含中文、符号等特殊字符的邮件主题和正文。",
        "args": {
          "subject": "测试@!#%&*()_+{}[]邮件主题",
          "body": "这是一封含有特殊字符的邮件正文！@#￥%……&*（）——+【】{}",
          "to": "test@example.com"
        },
        "response": {
          "error": "ToolException: Error executing tool compose_email: <unknown>.CreateItem"
        },
        "execution_time": 0.005025148391723633,
        "is_functional_test": true
      }
    ]
  },
  "total_cases": 46
}