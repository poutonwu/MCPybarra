# server Test Report

Server Directory: refined
Generated at: 2025-07-14 21:43:19

```markdown
# MCP Outlook Manager 服务器测试评估报告

## 摘要

本次测试对 `qwen-max-latest-mcp_outlook_manager` 服务器进行了全面的功能、健壮性、安全性、性能和透明性评估。共执行了 **53** 个测试用例，涵盖所有主要功能模块（如文件夹管理、邮件搜索、邮件查看与回复、邮件发送等）。

### 总体表现总结：

- **功能性**：整体功能实现不完整，部分核心功能未成功实现。
- **健壮性**：异常处理机制较为完善，但仍有改进空间。
- **安全性**：能够有效识别并阻止潜在恶意输入。
- **性能**：响应速度较快，平均执行时间较低。
- **透明性**：错误信息较清晰，但部分反馈仍可优化。

---

## 详细评估

### 1. 功能性 (满分 30分)

#### 分析：

我们需要计算每个工具中“语义成功率”，即返回结果在逻辑和内容上是否符合预期。

| 工具名称               | 测试用例数 | 成功用例数 | 失败原因                                                                 |
|------------------------|------------|-------------|--------------------------------------------------------------------------|
| `list_folders`         | 9          | 9           | 均成功列出文件夹列表                                                     |
| `list_recent_emails`   | 8          | 0           | 所有调用均失败（API 错误或找不到对象）                                   |
| `search_emails`        | 14         | 0           | 所有调用均失败（API 错误或日期格式问题）                                 |
| `get_email_by_number`  | 8          | 0           | 所有调用均提示“Invalid email number”                                     |
| `reply_to_email_by_number` | 7      | 0           | 所有调用均提示“Invalid email number”                                     |
| `compose_email`        | 8          | 0           | 所有调用均失败（CreateItem API 调用失败）                                |

- **总测试用例数**: 53  
- **功能测试用例数（is_functional_test=true）**: 26  
- **功能测试成功用例数**: 9（仅 `list_folders` 的功能测试成功）

> 📌 **语义成功率 = 9 / 26 ≈ 34.6%**

#### 评分依据：

- 成功率 ≤60%，因此根据规则：
  - **功能性得分: 10/30**

---

### 2. 健壮性 (满分 20分)

#### 分析：

健壮性测试主要集中在边界值、异常输入、无效参数、权限不足等情况的处理能力。

| 异常类型/场景                             | 是否正确处理 |
|-------------------------------------------|--------------|
| 空文件夹响应                              | ✅            |
| 特殊字符文件夹名                          | ✅            |
| 长文件夹名                                | ✅            |
| 嵌套文件夹结构                            | ✅            |
| 权限不足                                  | ❌（无实际拒绝行为） |
| 无效会话                                  | ❌（未触发拒绝）     |
| 最大文件夹数量                            | ❌（无验证）         |
| 非法天数输入（负数）                      | ✅            |
| 文件夹不存在                              | ✅            |
| 最大整数值作为天数                        | ✅            |
| 空文件夹检索                              | ❌            |
| 特殊字符邮件索引                          | ✅            |
| 负数邮件索引                              | ✅            |
| 超出范围邮件索引                          | ✅            |
| 邮件正文为空                              | ✅            |
| 附件路径不存在                            | ✅            |
| 非整数类型输入                            | ✅            |

- **健壮性相关用例总数**: 21  
- **正确处理的异常用例数**: 15

> 📌 **健壮性成功率 = 15 / 21 ≈ 71.4%**

#### 评分依据：

- 成功率 >60% 且 ≤75%
  - **健壮性得分: 14/20**

---

### 3. 安全性 (满分 20分)

#### 分析：

安全性测试集中在防止 SQL 注入、XSS 攻击、非法命令注入等安全威胁。

| 安全测试用例                       | 是否成功拦截 |
|------------------------------------|----------------|
| SQL 注入尝试 (`'; DROP TABLE...`)  | ✅              |
| XSS 尝试 (`<script>alert(...)</script>`) | ✅              |
| 命令注入尝试 (`; rm -rf /tmp/test;`) | ✅              |

- **安全测试用例数**: 3  
- **全部被成功拦截**: ✅

> 📌 **安全性成功率 = 3 / 3 = 100%**

#### 评分依据：

- 全部安全威胁被成功阻止
  - **安全性得分: 20/20**

---

### 4. 性能 (满分 20分)

#### 分析：

基于各工具的 `execution_time` 字段统计如下：

- 平均响应时间约为 **0.05s**
- 多数操作在 **0.01~0.02s** 内完成
- 最慢操作为 `list_folders` 中的嵌套结构测试（约 0.118s）
- 整体响应速度较快，适合轻量级交互任务

#### 评分依据：

- 响应速度快，适用于多数业务场景
  - **性能得分: 18/20**

---

### 5. 透明性 (满分 10分)

#### 分析：

分析失败用例中的 `error` 字段，发现以下特点：

- 多数错误提示明确指出问题来源（如“days must be non-negative”、“invalid email number”）
- 一些错误信息虽准确但不够具体（如“Failed to retrieve recent emails: <unknown>.ReceivedTime”）
- Pydantic 校验错误也以标准方式返回，有助于开发者定位参数问题

#### 评分依据：

- 错误信息总体清晰，部分可进一步优化
  - **透明性得分: 8/10**

---

## 问题与建议

### 主要问题：

1. **核心功能未实现**：
   - `list_recent_emails`、`search_emails`、`get_email_by_number`、`reply_to_email_by_number`、`compose_email` 均无法正常工作，返回统一错误信息。
   - 可能是 Outlook 接口调用失败或配置问题。

2. **权限控制未体现**：
   - 权限不足或无效会话情况下，未返回明确拒绝信息。

3. **部分错误信息模糊**：
   - 如 `<unknown>.ReceivedTime` 这类错误信息不利于快速定位问题。

### 改进建议：

- **修复 Outlook 接口连接问题**，确保基本功能可用。
- **增强错误日志输出**，提供更详细的错误上下文。
- **增加权限控制逻辑**，确保敏感操作需认证。
- **对用户输入做更严格的校验和清理**，防止潜在攻击面暴露。
- **优化空值和边界情况的响应逻辑**，提升系统鲁棒性。

---

## 结论

该 MCP Outlook Manager 服务器具备良好的安全性和一定的健壮性，但在核心功能实现方面存在较大缺陷，导致整体功能性评分偏低。性能表现良好，错误信息大部分清晰。若能修复接口调用问题并增强权限控制，将有望成为一款稳定可靠的 Outlook 自动化服务组件。

---

```
<SCORES>
功能性: 10/30
健壮性: 14/20
安全性: 20/20
性能: 18/20
透明性: 8/10
总分: 70/100
</SCORES>
```