[
  {
    "step": {
      "step_id": "create_new_document",
      "tool_name": "create_document",
      "parameters": {},
      "description": "Happy path: Create a new document and get its handle."
    },
    "substituted_params": {},
    "result": {
      "status": "success",
      "result": "{\"document_handle\": \"doc001\"}"
    }
  },
  {
    "step": {
      "step_id": "add_paragraph_to_new_doc",
      "tool_name": "add_paragraph",
      "parameters": {
        "document_handle": "$outputs.create_new_document.document_handle",
        "text": "This is the main content of the document."
      },
      "description": "Dependent call: Add a paragraph to the newly created document."
    },
    "substituted_params": {
      "document_handle": "doc001",
      "text": "This is the main content of the document."
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Paragraph added\"}"
    }
  },
  {
    "step": {
      "step_id": "add_heading_to_new_doc",
      "tool_name": "add_heading",
      "parameters": {
        "document_handle": "$outputs.create_new_document.document_handle",
        "text": "Introduction",
        "level": 1
      },
      "description": "Dependent call: Add a heading to the document."
    },
    "substituted_params": {
      "document_handle": "doc001",
      "text": "Introduction",
      "level": 1
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Heading added\"}"
    }
  },
  {
    "step": {
      "step_id": "get_document_info_after_adding",
      "tool_name": "get_document_info",
      "parameters": {
        "document_handle": "$outputs.create_new_document.document_handle"
      },
      "description": "Dependent call: Check that paragraphs and headings were added correctly."
    },
    "substituted_params": {
      "document_handle": "doc001"
    },
    "result": {
      "status": "success",
      "result": "{\"paragraphs\": 2, \"tables\": 0}"
    }
  },
  {
    "step": {
      "step_id": "save_as_new_file",
      "tool_name": "save_as_document",
      "parameters": {
        "document_handle": "$outputs.create_new_document.document_handle",
        "file_path": "D:/devWorkspace/MCPServer-Generator/testSystem/output/test_document.docx"
      },
      "description": "Dependent call: Save the document to a specific file path."
    },
    "substituted_params": {
      "document_handle": "doc001",
      "file_path": "D:/devWorkspace/MCPServer-Generator/testSystem/output/test_document.docx"
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Document saved as new file\"}"
    }
  },
  {
    "step": {
      "step_id": "open_saved_document",
      "tool_name": "open_document",
      "parameters": {
        "file_path": "D:/devWorkspace/MCPServer-Generator/testSystem/output/test_document.docx"
      },
      "description": "Happy path: Open the previously saved document."
    },
    "substituted_params": {
      "file_path": "D:/devWorkspace/MCPServer-Generator/testSystem/output/test_document.docx"
    },
    "result": {
      "status": "success",
      "result": "{\"document_handle\": \"doc002\"}"
    }
  },
  {
    "step": {
      "step_id": "search_text_in_opened_doc",
      "tool_name": "search_text",
      "parameters": {
        "document_handle": "$outputs.open_saved_document.document_handle",
        "search_term": "content"
      },
      "description": "Dependent call: Search for text in the opened document."
    },
    "substituted_params": {
      "document_handle": "doc002",
      "search_term": "content"
    },
    "result": {
      "status": "success",
      "result": "[{\"paragraph_index\": 0, \"start_pos\": 17, \"end_pos\": 24}]"
    }
  },
  {
    "step": {
      "step_id": "find_and_replace_in_opened_doc",
      "tool_name": "find_and_replace",
      "parameters": {
        "document_handle": "$outputs.open_saved_document.document_handle",
        "search_term": "content",
        "replace_term": "updated content"
      },
      "description": "Dependent call: Replace text in the opened document."
    },
    "substituted_params": {
      "document_handle": "doc002",
      "search_term": "content",
      "replace_term": "updated content"
    },
    "result": {
      "status": "success",
      "result": "{\"replacements\": 1}"
    }
  },
  {
    "step": {
      "step_id": "save_opened_document",
      "tool_name": "save_document",
      "parameters": {
        "document_handle": "$outputs.open_saved_document.document_handle"
      },
      "description": "Dependent call: Save changes made to the opened document."
    },
    "substituted_params": {
      "document_handle": "doc002"
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Document saved successfully\"}"
    }
  },
  {
    "step": {
      "step_id": "create_copy_of_document",
      "tool_name": "create_document_copy",
      "parameters": {
        "document_handle": "$outputs.open_saved_document.document_handle"
      },
      "description": "Dependent call: Create a copy of the current document."
    },
    "substituted_params": {
      "document_handle": "doc002"
    },
    "result": {
      "status": "success",
      "result": "{\"new_document_handle\": \"doc003\"}"
    }
  },
  {
    "step": {
      "step_id": "add_table_to_copied_doc",
      "tool_name": "add_table",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle",
        "rows": 3,
        "cols": 2
      },
      "description": "Dependent call: Add a table to the copied document."
    },
    "substituted_params": {
      "document_handle": "doc003",
      "rows": 3,
      "cols": 2
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Table added\"}"
    }
  },
  {
    "step": {
      "step_id": "add_row_to_table",
      "tool_name": "add_table_row",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle",
        "table_index": 0,
        "row_data": [
          "Item A",
          "Value 1"
        ]
      },
      "description": "Dependent call: Add a row to the first table in the copied document."
    },
    "substituted_params": {
      "document_handle": "doc003",
      "table_index": 0,
      "row_data": [
        "Item A",
        "Value 1"
      ]
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Row added\"}"
    }
  },
  {
    "step": {
      "step_id": "edit_table_cell",
      "tool_name": "edit_table_cell",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle",
        "table_index": 0,
        "row_index": 0,
        "col_index": 0,
        "new_content": "Updated Item"
      },
      "description": "Dependent call: Edit a cell in the table."
    },
    "substituted_params": {
      "document_handle": "doc003",
      "table_index": 0,
      "row_index": 0,
      "col_index": 0,
      "new_content": "Updated Item"
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Cell edited\"}"
    }
  },
  {
    "step": {
      "step_id": "merge_table_cells",
      "tool_name": "merge_table_cells",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle",
        "table_index": 0,
        "start_row": 0,
        "start_col": 0,
        "end_row": 0,
        "end_col": 1
      },
      "description": "Dependent call: Merge cells in the table."
    },
    "substituted_params": {
      "document_handle": "doc003",
      "table_index": 0,
      "start_row": 0,
      "start_col": 0,
      "end_row": 0,
      "end_col": 1
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Cells merged\"}"
    }
  },
  {
    "step": {
      "step_id": "split_table_at_row",
      "tool_name": "split_table",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle",
        "table_index": 0,
        "row_index": 1
      },
      "description": "Dependent call: Split the table at a specific row."
    },
    "substituted_params": {
      "document_handle": "doc003",
      "table_index": 0,
      "row_index": 1
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"Unexpected error\", \"message\": \"Failed to split table: 'CT_Tbl' object has no attribute 'split'\"}"
    }
  },
  {
    "step": {
      "step_id": "set_page_margins",
      "tool_name": "set_page_margins",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle",
        "top": 1.0,
        "bottom": 1.0,
        "left": 1.0,
        "right": 1.0
      },
      "description": "Dependent call: Set standard page margins."
    },
    "substituted_params": {
      "document_handle": "doc003",
      "top": 1.0,
      "bottom": 1.0,
      "left": 1.0,
      "right": 1.0
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Margins set\"}"
    }
  },
  {
    "step": {
      "step_id": "delete_paragraph_by_index",
      "tool_name": "delete_paragraph",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle",
        "paragraph_index": 0
      },
      "description": "Dependent call: Delete a paragraph by index."
    },
    "substituted_params": {
      "document_handle": "doc003",
      "paragraph_index": 0
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Paragraph deleted\"}"
    }
  },
  {
    "step": {
      "step_id": "delete_text_from_doc",
      "tool_name": "delete_text",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle",
        "text_to_delete": "Introduction"
      },
      "description": "Dependent call: Delete specific text from the document."
    },
    "substituted_params": {
      "document_handle": "doc003",
      "text_to_delete": "Introduction"
    },
    "result": {
      "status": "success",
      "result": "{\"deletions\": 1}"
    }
  },
  {
    "step": {
      "step_id": "replace_section_by_heading",
      "tool_name": "replace_section",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle",
        "heading": "Updated Item",
        "new_content": "This section has been replaced with new content."
      },
      "description": "Dependent call: Replace a section based on its heading."
    },
    "substituted_params": {
      "document_handle": "doc003",
      "heading": "Updated Item",
      "new_content": "This section has been replaced with new content."
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"warning\", \"message\": \"Section not found\"}"
    }
  },
  {
    "step": {
      "step_id": "edit_section_by_keyword",
      "tool_name": "edit_section_by_keyword",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle",
        "keyword": "replaced",
        "new_content": "This section was edited using a keyword search."
      },
      "description": "Dependent call: Edit a section based on a keyword match."
    },
    "substituted_params": {
      "document_handle": "doc003",
      "keyword": "replaced",
      "new_content": "This section was edited using a keyword search."
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"warning\", \"message\": \"Keyword not found\"}"
    }
  },
  {
    "step": {
      "step_id": "add_page_break",
      "tool_name": "add_page_break",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle"
      },
      "description": "Dependent call: Add a page break to the document."
    },
    "substituted_params": {
      "document_handle": "doc003"
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Page break added\"}"
    }
  },
  {
    "step": {
      "step_id": "get_final_document_info",
      "tool_name": "get_document_info",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle"
      },
      "description": "Dependent call: Get final information about the document before saving."
    },
    "substituted_params": {
      "document_handle": "doc003"
    },
    "result": {
      "status": "success",
      "result": "{\"paragraphs\": 2, \"tables\": 1}"
    }
  },
  {
    "step": {
      "step_id": "save_modified_copy",
      "tool_name": "save_as_document",
      "parameters": {
        "document_handle": "$outputs.create_copy_of_document.new_document_handle",
        "file_path": "D:/devWorkspace/MCPServer-Generator/testSystem/output/modified_document.docx"
      },
      "description": "Dependent call: Save the modified copy of the document."
    },
    "substituted_params": {
      "document_handle": "doc003",
      "file_path": "D:/devWorkspace/MCPServer-Generator/testSystem/output/modified_document.docx"
    },
    "result": {
      "status": "success",
      "result": "{\"status\": \"success\", \"message\": \"Document saved as new file\"}"
    }
  },
  {
    "step": {
      "step_id": "test_invalid_document_handle",
      "tool_name": "get_document_info",
      "parameters": {
        "document_handle": "invalid-handle"
      },
      "description": "Edge case: Test with an invalid document handle."
    },
    "substituted_params": {
      "document_handle": "invalid-handle"
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"Unexpected error\", \"message\": \"Failed to get document info: Document handle invalid-handle not found\"}"
    }
  },
  {
    "step": {
      "step_id": "test_empty_search_term",
      "tool_name": "search_text",
      "parameters": {
        "document_handle": "$outputs.create_new_document.document_handle",
        "search_term": ""
      },
      "description": "Edge case: Test with an empty search term."
    },
    "substituted_params": {
      "document_handle": "doc001",
      "search_term": ""
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"Unexpected error\", \"message\": \"Failed to search text: Search term cannot be empty\"}"
    }
  },
  {
    "step": {
      "step_id": "test_invalid_table_index",
      "tool_name": "add_table_row",
      "parameters": {
        "document_handle": "$outputs.create_new_document.document_handle",
        "table_index": 999,
        "row_data": [
          "Test",
          "Data"
        ]
      },
      "description": "Edge case: Try to add a row to a non-existent table."
    },
    "substituted_params": {
      "document_handle": "doc001",
      "table_index": 999,
      "row_data": [
        "Test",
        "Data"
      ]
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"Unexpected error\", \"message\": \"Failed to add table row: Table index out of range (0--1)\"}"
    }
  }
]