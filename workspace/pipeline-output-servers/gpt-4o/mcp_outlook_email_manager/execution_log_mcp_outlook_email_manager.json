[
  {
    "step": {
      "step_id": "list_all_folders",
      "tool_name": "list_folders",
      "parameters": {},
      "description": "Happy path: List all available Outlook folders to verify basic functionality."
    },
    "substituted_params": {},
    "result": {
      "status": "success",
      "result": "[\"1291980381@qq.com\", \"zhihutangjiang@126.com\", \"outformcptest@outlook.com\"]"
    }
  },
  {
    "step": {
      "step_id": "list_recent_emails_inbox",
      "tool_name": "list_recent_emails",
      "parameters": {
        "days": 7
      },
      "description": "Happy path: Retrieve emails from the last 7 days in the Inbox folder (default)."
    },
    "substituted_params": {
      "days": 7
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"Folder 'Inbox' not found.\"}"
    }
  },
  {
    "step": {
      "step_id": "get_first_email_details",
      "tool_name": "get_email_by_number",
      "parameters": {
        "email_number": 0
      },
      "description": "Dependent call: Fetch detailed content of the first email from the cached list obtained in 'list_recent_emails_inbox'."
    },
    "substituted_params": {
      "email_number": 0
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"Invalid email number.\"}"
    }
  },
  {
    "step": {
      "step_id": "search_emails_by_sender",
      "tool_name": "search_emails",
      "parameters": {
        "start_date": "2023-01-01",
        "end_date": "2023-01-31",
        "folder_name": "Inbox",
        "filter_by": "john.doe@example.com"
      },
      "description": "Happy path: Search for emails from a specific sender within a given date range."
    },
    "substituted_params": {
      "start_date": "2023-01-01",
      "end_date": "2023-01-31",
      "folder_name": "Inbox",
      "filter_by": "john.doe@example.com"
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"Folder 'Inbox' not found.\"}"
    }
  },
  {
    "step": {
      "step_id": "reply_to_first_email",
      "tool_name": "reply_to_email_by_number",
      "parameters": {
        "email_number": 0,
        "reply_content": "Thank you for your message. I will get back to you shortly."
      },
      "description": "Sensitive action: Reply to the first email in the cached list with a sample response."
    },
    "substituted_params": {
      "email_number": 0,
      "reply_content": "Thank you for your message. I will get back to you shortly."
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"Invalid email number.\"}"
    }
  },
  {
    "step": {
      "step_id": "compose_new_email",
      "tool_name": "compose_email",
      "parameters": {
        "subject": "Test Email from MCP Server",
        "body": "This is a test email sent as part of an automated validation process.",
        "recipients": [
          "test.recipient@example.com"
        ],
        "cc": [
          "cc.recipient@example.com"
        ]
      },
      "description": "Sensitive action: Compose and send a new email with one recipient and one CC address."
    },
    "substituted_params": {
      "subject": "Test Email from MCP Server",
      "body": "This is a test email sent as part of an automated validation process.",
      "recipients": [
        "test.recipient@example.com"
      ],
      "cc": [
        "cc.recipient@example.com"
      ]
    },
    "result": {
      "status": "success",
      "result": "\"Email sent successfully\""
    }
  },
  {
    "step": {
      "step_id": "invalid_folder_name_test",
      "tool_name": "list_recent_emails",
      "parameters": {
        "days": 5,
        "folder_name": ""
      },
      "description": "Edge case: Test error handling when an invalid (empty) folder name is provided."
    },
    "substituted_params": {
      "days": 5,
      "folder_name": ""
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"Folder name must be a non-empty string.\"}"
    }
  },
  {
    "step": {
      "step_id": "invalid_email_number_test",
      "tool_name": "get_email_by_number",
      "parameters": {
        "email_number": -1
      },
      "description": "Edge case: Test error handling when an invalid email index is used."
    },
    "substituted_params": {
      "email_number": -1
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"Invalid email number.\"}"
    }
  },
  {
    "step": {
      "step_id": "search_with_invalid_dates",
      "tool_name": "search_emails",
      "parameters": {
        "start_date": "2024-01-01",
        "end_date": "2023-01-01",
        "folder_name": "Inbox",
        "filter_by": "example.com"
      },
      "description": "Edge case: Test behavior when end date is before start date."
    },
    "substituted_params": {
      "start_date": "2024-01-01",
      "end_date": "2023-01-01",
      "folder_name": "Inbox",
      "filter_by": "example.com"
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"Folder 'Inbox' not found.\"}"
    }
  },
  {
    "step": {
      "step_id": "compose_email_with_empty_recipients",
      "tool_name": "compose_email",
      "parameters": {
        "subject": "Invalid Recipient Test",
        "body": "This email should not be sent due to empty recipients.",
        "recipients": []
      },
      "description": "Edge case: Test error handling when no recipients are provided."
    },
    "substituted_params": {
      "subject": "Invalid Recipient Test",
      "body": "This email should not be sent due to empty recipients.",
      "recipients": []
    },
    "result": {
      "status": "error",
      "result": "{\"error\": \"(-2147352567, '\\u53d1\\u751f\\u610f\\u5916\\u3002', (4096, 'Microsoft Outlook', '\\u6211\\u4eec\\u9700\\u8981\\u77e5\\u9053\\u6b64\\u5185\\u5bb9\\u7684\\u6536\\u4ef6\\u4eba\\u3002\\u8bf7\\u786e\\u4fdd\\u81f3\\u5c11\\u8f93\\u5165\\u4e00\\u4e2a\\u540d\\u79f0\\u3002', None, 0, -2147467259), None)\"}"
    }
  }
]