[
  {
    "step": {
      "step_id": "list_all_folders",
      "tool_name": "list_folders",
      "parameters": {},
      "description": "Happy path: List all available Outlook folders to verify basic functionality."
    },
    "substituted_params": {},
    "result": {
      "status": "success",
      "result": "1291980381@qq.com, zhihutangjiang@126.com, outformcptest@outlook.com"
    }
  },
  {
    "step": {
      "step_id": "list_recent_emails_inbox",
      "tool_name": "list_recent_emails",
      "parameters": {
        "days": 7
      },
      "description": "Happy path: Retrieve recent emails from the Inbox within the last 7 days to test caching and listing."
    },
    "substituted_params": {
      "days": 7
    },
    "result": {
      "status": "error",
      "result": "Error executing tool list_recent_emails: Failed to list recent emails: can't compare offset-naive and offset-aware datetimes"
    }
  },
  {
    "step": {
      "step_id": "search_emails_by_keyword",
      "tool_name": "search_emails",
      "parameters": {
        "query": "meeting"
      },
      "description": "Happy path: Search for emails containing 'meeting' in subject or sender to verify search capability."
    },
    "substituted_params": {
      "query": "meeting"
    },
    "result": {
      "status": "success",
      "result": "No output returned."
    }
  },
  {
    "step": {
      "step_id": "search_emails_with_date_range",
      "tool_name": "search_emails",
      "parameters": {
        "query": "project",
        "start_date": "2024-01-01",
        "end_date": "2025-12-31"
      },
      "description": "Dependent call: Search for 'project' emails within a specific date range to test filtering."
    },
    "substituted_params": {
      "query": "project",
      "start_date": "2024-01-01",
      "end_date": "2025-12-31"
    },
    "result": {
      "status": "error",
      "result": "Error executing tool search_emails: Failed to search emails: can't compare offset-naive and offset-aware datetimes"
    }
  },
  {
    "step": {
      "step_id": "get_first_email_details",
      "tool_name": "get_email_by_number",
      "parameters": {
        "email_number": 0
      },
      "description": "Dependent call: Retrieve full details of the first email from the previously listed emails to test cache access."
    },
    "substituted_params": {
      "email_number": 0
    },
    "result": {
      "status": "error",
      "result": "Error executing tool get_email_by_number: Failed to get email by number: Invalid email number"
    }
  },
  {
    "step": {
      "step_id": "reply_to_first_email",
      "tool_name": "reply_to_email_by_number",
      "parameters": {
        "email_number": 0,
        "reply_text": "This is an automated reply. I've received your message and will get back to you shortly."
      },
      "description": "Sensitive action: Test replying to the first email in the list with a canned response."
    },
    "substituted_params": {
      "email_number": 0,
      "reply_text": "This is an automated reply. I've received your message and will get back to you shortly."
    },
    "result": {
      "status": "error",
      "result": "Error executing tool reply_to_email_by_number: Failed to reply to email: Invalid email number"
    }
  },
  {
    "step": {
      "step_id": "compose_new_email",
      "tool_name": "compose_email",
      "parameters": {
        "subject": "Test Email from MCP Server",
        "body": "This is a test email sent via the MCP server integration.",
        "recipients": [
          "test@example.com"
        ]
      },
      "description": "Sensitive action: Send a new email to validate compose and send functionality."
    },
    "substituted_params": {
      "subject": "Test Email from MCP Server",
      "body": "This is a test email sent via the MCP server integration.",
      "recipients": [
        "test@example.com"
      ]
    },
    "result": {
      "status": "success",
      "result": "Email sent successfully"
    }
  },
  {
    "step": {
      "step_id": "list_nonexistent_folder_emails",
      "tool_name": "list_recent_emails",
      "parameters": {
        "days": 7,
        "folder_name": "NonExistentFolder"
      },
      "description": "Edge case: Attempt to list emails from a non-existent folder to test error handling."
    },
    "substituted_params": {
      "days": 7,
      "folder_name": "NonExistentFolder"
    },
    "result": {
      "status": "error",
      "result": "Error executing tool list_recent_emails: Failed to list recent emails: (-2147352567, '发生意外。', (4096, 'Microsoft Outlook', '尝试的操作失败。找不到某个对象。', None, 0, -2147221233), None)"
    }
  },
  {
    "step": {
      "step_id": "search_empty_query",
      "tool_name": "search_emails",
      "parameters": {
        "query": ""
      },
      "description": "Edge case: Test search with empty query to ensure validation works correctly."
    },
    "substituted_params": {
      "query": ""
    },
    "result": {
      "status": "error",
      "result": "Error executing tool search_emails: Failed to search emails: Query cannot be empty"
    }
  },
  {
    "step": {
      "step_id": "get_invalid_email_index",
      "tool_name": "get_email_by_number",
      "parameters": {
        "email_number": -1
      },
      "description": "Edge case: Attempt to retrieve an email with an invalid index to test bounds checking."
    },
    "substituted_params": {
      "email_number": -1
    },
    "result": {
      "status": "error",
      "result": "Error executing tool get_email_by_number: Failed to get email by number: Invalid email number"
    }
  }
]